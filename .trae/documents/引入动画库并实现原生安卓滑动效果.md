## 依赖库
- 安装 `framer-motion` 用于页面/弹层转场与弹性动画
- 保持 `react-router-dom v6` 作为后续路由管理（当前不改路由结构）
- 不引入模拟数据；仅使用现有接口与状态

## 动画参数与工具
- 新增 `src/user/animations.ts`，封装通用 spring 参数：
  - `androidSlideRight`: `{ type: 'spring', stiffness: 480, damping: 32 }`，右侧抽屉进出场
  - `androidBottomSheet`: `{ type: 'spring', stiffness: 300, damping: 24 }`，底部弹性滑动
  - `fade`: `{ duration: 0.18 }`
- 手势关闭：底部弹层支持 `drag='y'`，`dragElastic={0.15}`，拖拽结束大于阈值（如 120px）则关闭

## 设置面板（右侧滑出）
- 文件：`src/user/components/ChatDetail.tsx`
- 结构：使用 `AnimatePresence` + `motion.div` 包裹现有设置面板与遮罩
- 效果：
  - 抽屉：`initial={{ x: '100%' }}`、`animate={{ x: 0 }}`、`exit={{ x: '100%' }}`、`transition={androidSlideRight}`
  - 遮罩：淡入淡出 `opacity` 动画 + 点击关闭
- 保留安全区 `env(safe-area-inset-top)` 与当前布局

## 角色选择（底部滑出）
- 文件：`src/user/components/UserRoleSelectorSheet.tsx`
- 集成 `AnimatePresence` 与 `motion.div`：
  - Sheet：`initial={{ y: '100%' }}`、`animate={{ y: 0 }}`、`exit={{ y: '100%' }}`、`transition={androidBottomSheet}`
  - 加 `drag='y'` 支持拖拽关闭，弹性与阻尼模拟原生安卓
  - 叠层：保持 z-index 高于聊天设置抽屉
- 打开逻辑：仍从“我的角色设置”触发；加载列表后显示

## 添加角色页面（底部覆盖）
- 文件：`src/user/components/UserCharacterSettings.tsx`
- 从角色选择页点击“添加”时：
  - 保持角色选择页可见（底部层级）；上方再弹出一个新的 bottom sheet 进行创建
  - 动画同 `androidBottomSheet`，进场覆盖；完成后 `exit` 下滑并关闭创建页
- 完成保存后：下滑关闭创建页；角色选择页仍在底部，若需关闭则跟随用户操作

## 关闭行为与交互
- 角色完成：执行保存，触发 `onBack` 前增加 `exit` 动画（下滑），完成后真正关闭组件
- 抽屉/底部弹层与遮罩均支持点击关闭与拖拽关闭

## 代码改动范围
- 新增动画工具文件 `src/user/animations.ts`
- 修改 `ChatDetail.tsx`：引入 `AnimatePresence`/`motion`，替换设置面板与遮罩渲染
- 修改 `UserRoleSelectorSheet.tsx`：引入动画与拖拽手势
- 修改 `UserCharacterSettings.tsx`：引入动画，并从底部覆盖显示

## 验证
- 本地运行开发服务器，进入聊天页：
  - 点击设置：右侧抽屉以弹簧动画滑出；关闭时弹性右滑
  - 点击“我的角色设置”：底部弹性滑出；拖拽到一定位置关闭
  - 点击“添加角色”：在其上方再滑出添加页；点击完成后添加页下滑退出
- 跨设备检查：iOS/Android 安全区适配与滚动无闪烁

确认后我将安装依赖并按以上方案实施、联调与验证。