import{j as e,r as s}from"./index-DiMvcmcb.js";import{T as Q,u as V,e as L,m as q}from"./AdminDashboard-D62DCIkd.js";import{S as w}from"./save-DC2LZN-i.js";import{C as F}from"./circle-question-mark-C7ouqtkr.js";import"./createLucideIcon-CiU7U1is.js";const N=({value:d,onChange:p})=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",min:"0",max:"2",step:"0.05",value:d,onChange:n=>p(n.target.value),className:"dream-input w-24 px-2 py-3 rounded-xl text-sm font-bold text-center"}),e.jsxs("div",{className:"relative group",children:[e.jsx(F,{size:18,className:"text-pink-400 cursor-help"}),e.jsx("div",{className:"absolute bottom-full mb-2 left-1/2 -translate-x-1/2 w-48 p-3 bg-white/90 backdrop-blur-sm border border-pink-100 text-pink-900 text-xs rounded-xl shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50 pointer-events-none text-center",children:"温度：高数值输出随机，低数值输出集中。"})]})]}),G=()=>{const[d,p]=s.useState([]),[n,v]=s.useState(""),[a,u]=s.useState(!1),h=s.useRef(null),[c,_]=s.useState(""),[r,f]=s.useState(!1),b=s.useRef(null),[m,C]=s.useState(""),[o,g]=s.useState(!1),j=s.useRef(null),[S,T]=s.useState(.1),[$,I]=s.useState(.1),[M,z]=s.useState(.1),[R,A]=s.useState(null),{showToast:x}=V(),y=t=>{const l=d.find(B=>B.model_id===t);return l?l.model_name||l.model_id:"-- 请选择 --"},E=async()=>{try{const t=await q.list();p(t.items||[])}catch{x("模型列表加载失败","error")}};s.useEffect(()=>{E(),(async()=>{try{const t=await L.get();v(t.selected_model),_(t.selected_chat_model),C(t.selected_story_model),T(Number(t.model_temperature||.1)),I(Number(t.chat_temperature||.1)),z(Number(t.story_temperature||.1)),A(t.default_template_id||null)}catch{x("加载设置失败","error")}})()},[]),s.useEffect(()=>{const t=l=>{a&&h.current&&!h.current.contains(l.target)&&u(!1),r&&b.current&&!b.current.contains(l.target)&&f(!1),o&&j.current&&!j.current.contains(l.target)&&g(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[a,r,o]);const i=[...d].sort((t,l)=>(t.model_name||t.model_id).localeCompare(l.model_name||l.model_id)),O=y(n),D=y(c),P=y(m),k=async()=>{try{await L.save({selected_model:n,selected_chat_model:c,selected_story_model:m,model_temperature:Number(S),chat_temperature:Number($),story_temperature:Number(M),default_template_id:R}),x("设置已保存")}catch{x("保存失败","error")}};return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-cute text-pink-900 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-yellow-400 rounded-full inline-block"}),"模型设置"]}),e.jsx("p",{className:"text-gray-400 text-xs mt-1 ml-4",children:"配置全局模型与温度参数"})]})}),e.jsxs("div",{className:"solid-card p-8 rounded-3xl",children:[e.jsxs("h3",{className:"font-cute text-lg text-pink-900 flex items-center gap-2 mb-4",children:[e.jsx("span",{className:"w-1.5 h-4 bg-yellow-400 rounded-full"}),"模型配置"]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-pink-800 mb-2",children:"角色提示词AI模型"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative w-full max-w-md",ref:h,children:[e.jsxs("button",{onClick:()=>u(!a),className:`dream-input w-full px-4 py-3 rounded-xl text-sm text-left font-bold transition-all bg-white flex justify-between items-center ${a?"border-pink-500 ring-4 ring-pink-100/50":""}`,children:[e.jsx("span",{className:`${n?"text-gray-700":"text-gray-400 font-normal"}`,children:O}),e.jsx("div",{className:`text-pink-400 transition-transform ${a?"rotate-180":""}`,children:"▼"})]}),a&&e.jsx("ul",{className:"absolute top-full mt-1 w-full bg-white border border-pink-200 rounded-xl shadow-xl max-h-48 overflow-y-auto z-50",children:i.length===0?e.jsx("li",{className:"px-4 py-3 text-sm text-gray-400",children:"暂无模型，请先添加"}):i.map(t=>e.jsx("li",{onClick:()=>{v(t.model_id),u(!1)},className:`px-4 py-3 text-sm text-gray-700 hover:bg-pink-50 cursor-pointer transition-colors ${n===t.model_id?"bg-pink-100 font-bold text-pink-700":""}`,children:t.model_name||t.model_id},t.id))})]}),e.jsx(N,{value:S,onChange:T}),e.jsxs("button",{onClick:k,className:"px-6 py-3 rounded-xl bg-gradient-to-r from-pink-500 to-pink-600 text-white font-bold text-sm shadow-lg shadow-pink-200 hover:bg-pink-700 transition-all flex items-center gap-2",children:[e.jsx(w,{size:16})," 确认"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-pink-800 mb-2",children:"角色聊天AI模型"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative w-full max-w-md",ref:b,children:[e.jsxs("button",{onClick:()=>f(!r),className:`dream-input w-full px-4 py-3 rounded-xl text-sm text-left font-bold transition-all bg-white flex justify-between items-center ${r?"border-pink-500 ring-4 ring-pink-100/50":""}`,children:[e.jsx("span",{className:`${c?"text-gray-700":"text-gray-400 font-normal"}`,children:D}),e.jsx("div",{className:`text-pink-400 transition-transform ${r?"rotate-180":""}`,children:"▼"})]}),r&&e.jsx("ul",{className:"absolute top-full mt-1 w-full bg-white border border-pink-200 rounded-xl shadow-xl max-h-48 overflow-y-auto z-50",children:i.length===0?e.jsx("li",{className:"px-4 py-3 text-sm text-gray-400",children:"暂无模型，请先添加"}):i.map(t=>e.jsx("li",{onClick:()=>{_(t.model_id),f(!1)},className:`px-4 py-3 text-sm text-gray-700 hover:bg-pink-50 cursor-pointer transition-colors ${c===t.model_id?"bg-pink-100 font-bold text-pink-700":""}`,children:t.model_name||t.model_id},t.id))})]}),e.jsx(N,{value:$,onChange:I}),e.jsxs("button",{onClick:k,className:"px-6 py-3 rounded-xl bg-gradient-to-r from-pink-500 to-pink-600 text-white font-bold text-sm shadow-lg shadow-pink-200 hover:bg-pink-700 transition-all flex items-center gap-2",children:[e.jsx(w,{size:16})," 确认"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-pink-800 mb-2",children:"故事生成AI模型"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative w-full max-w-md",ref:j,children:[e.jsxs("button",{onClick:()=>g(!o),className:`dream-input w-full px-4 py-3 rounded-xl text-sm text-left font-bold transition-all bg-white flex justify-between items-center ${o?"border-pink-500 ring-4 ring-pink-100/50":""}`,children:[e.jsx("span",{className:`${m?"text-gray-700":"text-gray-400 font-normal"}`,children:P}),e.jsx("div",{className:`text-pink-400 transition-transform ${o?"rotate-180":""}`,children:"▼"})]}),o&&e.jsx("ul",{className:"absolute top-full mt-1 w-full bg-white border border-pink-200 rounded-xl shadow-xl max-h-48 overflow-y-auto z-50",children:i.length===0?e.jsx("li",{className:"px-4 py-3 text-sm text-gray-400",children:"暂无模型，请先添加"}):i.map(t=>e.jsx("li",{onClick:()=>{C(t.model_id),g(!1)},className:`px-4 py-3 text-sm text-gray-700 hover:bg-pink-50 cursor-pointer transition-colors ${m===t.model_id?"bg-pink-100 font-bold text-pink-700":""}`,children:t.model_name||t.model_id},t.id))})]}),e.jsx(N,{value:M,onChange:z}),e.jsxs("button",{onClick:k,className:"px-6 py-3 rounded-xl bg-gradient-to-r from-pink-500 to-pink-600 text-white font-bold text-sm shadow-lg shadow-pink-200 hover:bg-pink-700 transition-all flex items-center gap-2",children:[e.jsx(w,{size:16})," 确认"]})]})]})]})]})]})},X=()=>e.jsx(Q,{children:e.jsx(G,{})});export{X as default};
//# sourceMappingURL=ModelSettingsView-CQr3tNG5.js.map
