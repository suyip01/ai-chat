{"version":3,"file":"AdminAccountsView-CyLZFtb9.js","sources":["../../admin/settings/AdminAccountsView.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { ToastProvider, useToast } from '../Toast.jsx';\nimport { adminsAPI } from '../api.js';\nimport { Plus, X } from 'lucide-react';\n\nconst Content = () => {\n  const { showToast } = useToast();\n  const [admins, setAdmins] = useState([]);\n  const [view, setView] = useState('list');\n  const [newAdmin, setNewAdmin] = useState({ username: '', email: '', password: '' });\n  const [pwdTarget, setPwdTarget] = useState(null);\n  const [newPwd, setNewPwd] = useState('');\n\n  const reload = async () => {\n    try { const rows = await adminsAPI.list(); setAdmins(rows); }\n    catch { showToast('加载失败', 'error'); }\n  };\n  useEffect(() => { reload(); }, []);\n\n  const handleAdd = async () => {\n    if (!newAdmin.username || !newAdmin.password) { showToast('请填写必填项', 'error'); return; }\n    try {\n      const { id } = await adminsAPI.create(newAdmin);\n      setAdmins(prev => [...prev, { id, username: newAdmin.username, email: newAdmin.email || '', isActive: 1 }]);\n      setView('list');\n      setNewAdmin({ username: '', email: '', password: '' });\n      showToast('管理员添加成功');\n    } catch { showToast('添加失败', 'error'); }\n  };\n\n  const handleDisable = async (id, next) => {\n    try {\n      await adminsAPI.update(id, { isActive: next });\n      setAdmins(prev => prev.map(a => a.id === id ? { ...a, isActive: next } : a));\n      showToast(next ? '已启用' : '已禁用');\n    } catch { showToast('更新失败', 'error'); }\n  };\n\n  const handleDelete = async (id) => {\n    try { await adminsAPI.remove(id); setAdmins(prev => prev.filter(a => a.id !== id)); showToast('删除成功'); }\n    catch { showToast('删除失败', 'error'); }\n  };\n\n  const handleChangePwd = async () => {\n    if (!newPwd) { showToast('请输入新密码', 'error'); return; }\n    try { await adminsAPI.changePassword(pwdTarget.id, newPwd); setPwdTarget(null); setNewPwd(''); showToast('密码已更新'); }\n    catch { showToast('更新失败', 'error'); }\n  };\n\n  if (view === 'create') {\n    return (\n      <div className=\"animate-fade-in pb-10\">\n        <div className=\"flex items-center gap-4 mb-6\">\n          <button onClick={() => setView('list')} className=\"px-5 py-2.5 rounded-xl bg-white text-gray-600 font-bold text-sm shadow-sm hover:bg-gray-50\">返回</button>\n          <div>\n            <h2 className=\"text-2xl font-cute text-pink-900\">添加管理员</h2>\n            <p className=\"text-gray-400 text-xs\">创建新的后台管理员账号</p>\n          </div>\n          <div className=\"ml-auto flex gap-3\">\n            <button onClick={() => setView('list')} className=\"px-6 py-2.5 rounded-xl bg-white text-gray-500 font-bold text-sm shadow-sm hover:bg-gray-50\">取消</button>\n            <button onClick={handleAdd} className=\"px-6 py-2.5 rounded-xl bg-gradient-to-r from-pink-500 to-pink-600 text-white font-bold text-sm shadow-lg shadow-pink-200 flex items-center gap-2\"><Plus size={16} /> 创建管理员</button>\n          </div>\n        </div>\n        <div className=\"solid-card p-8 rounded-3xl space-y-6 max-w-2xl mx-auto\">\n          <h3 className=\"font-cute text-lg text-pink-900 flex items-center gap-2 mb-2\"><span className=\"w-1.5 h-4 bg-yellow-400 rounded-full\"></span> 管理员信息</h3>\n          <div>\n            <label className=\"block text-xs font-bold text-pink-800 mb-2\">用户名</label>\n            <input type=\"text\" value={newAdmin.username} onChange={e => setNewAdmin({ ...newAdmin, username: e.target.value })} className=\"dream-input w-full px-4 py-2.5 rounded-xl text-sm\" />\n          </div>\n          <div>\n            <label className=\"block text-xs font-bold text-pink-800 mb-2\">邮箱</label>\n            <input type=\"email\" value={newAdmin.email} onChange={e => setNewAdmin({ ...newAdmin, email: e.target.value })} className=\"dream-input w-full px-4 py-2.5 rounded-xl text-sm\" />\n          </div>\n          <div>\n            <label className=\"block text-xs font-bold text-pink-800 mb-2\">初始密码</label>\n            <input type=\"password\" value={newAdmin.password} onChange={e => setNewAdmin({ ...newAdmin, password: e.target.value })} className=\"dream-input w-full px-4 py-2.5 rounded-xl text-sm\" />\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6 animate-fade-in\">\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h2 className=\"text-2xl font-cute text-pink-900 flex items-center gap-2\"><span className=\"w-1.5 h-6 bg-yellow-400 rounded-full inline-block\"></span>管理员账号</h2>\n          <p className=\"text-gray-400 text-xs mt-1 ml-4\">管理后台管理员列表、禁用与密码修改</p>\n        </div>\n        <button onClick={() => setView('create')} className=\"bg-pink-500 text-white px-4 py-2 rounded-xl font-bold shadow-lg shadow-pink-200 hover:bg-pink-600 transition-colors flex items-center gap-2 text-xs\"><Plus size={14} /> 添加管理员</button>\n      </div>\n\n      <div className=\"glass-card rounded-2xl overflow-hidden border border-pink-100\">\n        <table className=\"w-full text-left border-collapse\">\n          <thead className=\"bg-pink-100 text-pink-900 font-cute text-sm\">\n            <tr>\n              <th className=\"p-3 pl-6 w-20\">头像</th>\n              <th className=\"p-3 w-20\">ID</th>\n              <th className=\"p-3\">用户名</th>\n              <th className=\"p-3\">昵称</th>\n              <th className=\"p-3\">邮箱</th>\n              <th className=\"p-3\">状态</th>\n              <th className=\"p-3 text-right pr-6\">操作</th>\n            </tr>\n          </thead>\n          <tbody className=\"text-sm divide-y divide-pink-100\">\n            {admins.map(a => (\n              <tr key={a.id} className=\"hover:bg-pink-50/30 transition-colors\">\n                <td className=\"p-3 pl-6\"><img src={a.avatar || '/uploads/avatars/default_admin.jpg'} alt={a.username} className=\"w-8 h-8 rounded-full object-cover shadow-sm\" /></td>\n                <td className=\"p-3 text-gray-500 font-mono\">{a.id.toString().padStart(4, '0')}</td>\n                <td className=\"p-3 font-bold text-pink-700\">{a.username}</td>\n                <td className=\"p-3 text-gray-700\">{a.nickname || '-'}</td>\n                <td className=\"p-3 text-gray-600\">{a.email || '-'}</td>\n                <td className=\"p-3\">{a.isActive === 1 ? '启用' : '禁用'}</td>\n                <td className=\"p-3 text-right pr-6\">\n                  <div className=\"flex items-center gap-2 justify-end\">\n                    <button onClick={() => setPwdTarget(a)} className=\"px-3 py-1 rounded bg-white border border-gray-200 text-gray-600 text-xs hover:bg-gray-50\">改密</button>\n                    <button onClick={() => handleDisable(a.id, a.isActive === 1 ? 0 : 1)} className={`px-3 py-1 rounded text-xs font-bold ${a.isActive === 1 ? 'bg-yellow-100 text-yellow-700' : 'bg-green-100 text-green-700'}`}>{a.isActive === 1 ? '禁用' : '启用'}</button>\n                    <button onClick={() => handleDelete(a.id)} className=\"px-3 py-1 rounded bg-red-500 text-white text-xs hover:bg-red-600\">删除</button>\n                  </div>\n                </td>\n              </tr>\n            ))}\n            {admins.length === 0 && (\n              <tr>\n                <td colSpan=\"5\" className=\"p-8 text-center text-gray-400 text-sm\">暂无管理员</td>\n              </tr>\n            )}\n          </tbody>\n        </table>\n      </div>\n\n      {pwdTarget && (\n        <>\n          <div className=\"fixed inset-0 bg-black/30 z-50\" onClick={() => setPwdTarget(null)}></div>\n          <div className=\"fixed top-0 right-0 bottom-0 left-0 z-50 flex items-center justify-center p-4\">\n            <div className=\"bg-white rounded-3xl border border-pink-100 p-6 w-full max-w-md shadow-2xl\">\n              <div className=\"flex justify-between items-center mb-6\">\n                <h3 className=\"font-cute text-lg text-pink-900\">修改密码</h3>\n                <button onClick={() => setPwdTarget(null)} className=\"text-gray-400 hover:text-gray-600 transition-colors\"><X size={20} /></button>\n              </div>\n              <div className=\"space-y-4\">\n                <div>\n                  <label className=\"block text-xs font-bold text-pink-800 mb-1.5\">新密码</label>\n                  <input type=\"password\" value={newPwd} onChange={e => setNewPwd(e.target.value)} className=\"dream-input w-full px-4 py-2.5 rounded-xl text-sm\" />\n                </div>\n              </div>\n              <div className=\"flex justify-end gap-3 mt-8\">\n                <button onClick={() => setPwdTarget(null)} className=\"px-5 py-2.5 rounded-xl bg-gray-50 text-gray-600 font-bold text-sm hover:bg-gray-100 transition-colors\">取消</button>\n                <button onClick={handleChangePwd} className=\"px-6 py-2.5 rounded-xl bg-pink-500 text-white font-bold text-sm shadow-lg shadow-pink-200 hover:bg-pink-600 transition-all\">确认修改</button>\n              </div>\n            </div>\n          </div>\n        </>\n      )}\n    </div>\n  );\n};\n\nconst AdminAccountsView = () => (\n  <ToastProvider>\n    <Content />\n  </ToastProvider>\n);\n\nexport default AdminAccountsView;\n"],"names":["Content","showToast","useToast","admins","setAdmins","useState","view","setView","newAdmin","setNewAdmin","pwdTarget","setPwdTarget","newPwd","setNewPwd","reload","rows","adminsAPI","useEffect","handleAdd","id","prev","handleDisable","next","a","handleDelete","handleChangePwd","jsxs","jsx","Plus","e","Fragment","X","AdminAccountsView","ToastProvider"],"mappings":"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"}