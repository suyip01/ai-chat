import{r as i,j as e}from"./index-DiMvcmcb.js";import{u as b,S as k,B as c}from"./AdminDashboard-D62DCIkd.js";import{L as j}from"./log-out-9e2S_i2i.js";import"./createLucideIcon-CiU7U1is.js";const _=({onLogin:m})=>{const[n,d]=i.useState(""),[a,p]=i.useState(""),{showToast:r}=b(),o=async()=>{try{const x=(await(await fetch(`${c}/crypto/public-key`)).text()).replace(/-----BEGIN PUBLIC KEY-----/,"").replace(/-----END PUBLIC KEY-----/,"").replace(/\s+/g,""),h=Uint8Array.from(atob(x),y=>y.charCodeAt(0)),u=await window.crypto.subtle.importKey("spki",h.buffer,{name:"RSA-OAEP",hash:"SHA-256"},!1,["encrypt"]),f=await window.crypto.subtle.encrypt({name:"RSA-OAEP"},u,new TextEncoder().encode(a)),w=btoa(String.fromCharCode(...new Uint8Array(f))),l=await fetch(`${c}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,password_encrypted:w})});if(!l.ok){r("登录失败","error");return}const t=await l.json();t!=null&&t.access_token&&localStorage.setItem("admin_access_token",t.access_token),t!=null&&t.refresh_token&&localStorage.setItem("admin_refresh_token",t.refresh_token),localStorage.setItem("admin_username",n),m()}catch{r("登录失败","error")}};return e.jsxs("div",{className:"min-h-screen flex items-center justify-center relative overflow-hidden",onKeyDown:s=>{s.key==="Enter"&&o()},children:[e.jsx("div",{className:"ambient-bg"}),e.jsxs("div",{className:"glass-card p-10 rounded-3xl w-full max-w-md shadow-2xl transform transition-all hover:scale-[1.01]",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-pink-100 text-pink-600 mb-4 shadow-inner",children:e.jsx(k,{size:32})}),e.jsx("h1",{className:"text-3xl font-cute text-pink-900 mb-2",children:"YumeCrush"}),e.jsx("p",{className:"text-pink-400 text-sm",children:"运营管理平台"})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-pink-800 mb-2 ml-1",children:"管理员账号"}),e.jsx("input",{type:"text",placeholder:"请输入管理员账号",value:n,onChange:s=>d(s.target.value),className:"dream-input w-full px-4 py-3 rounded-2xl"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-pink-800 mb-2 ml-1",children:"密码"}),e.jsx("input",{type:"password",placeholder:"••••••••",value:a,onChange:s=>p(s.target.value),className:"dream-input w-full px-4 py-3 rounded-2xl"})]}),e.jsxs("button",{onClick:o,className:"w-full bg-gradient-to-r from-pink-500 to-pink-600 hover:from-pink-600 hover:to-pink-700 text-white font-bold py-3.5 rounded-2xl shadow-lg shadow-pink-200 transition-all transform active:scale-95 flex items-center justify-center gap-2",children:[e.jsx(j,{size:18,className:"rotate-180"})," 登录后台"]})]})]})]})};export{_ as default};
//# sourceMappingURL=LoginPage-Cwx44NTI.js.map
