const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/http-DqgzyhP5.js","assets/index-CNUsM2zR.js","assets/index-Bx06oPYS.css","assets/x-CTp4qmlj.js"])))=>i.map(i=>d[i]);
import{r as m,j as i,_ as re}from"./index-CNUsM2zR.js";import{c as ae,P as It,U as Cs,X as Ct,d as Lt,f as xa,e as Di,S as ga,b as kt,C as ya,a as Pt,T as va,I as ba,L as fn}from"./x-CTp4qmlj.js";/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wa=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Ft=ae("arrow-left",wa);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ja=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Na=ae("arrow-right",ja);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sa=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],Vi=ae("camera",Sa);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ta=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Ri=ae("check",Ta);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ca=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],ks=ae("chevron-up",Ca);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ka=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Pa=ae("circle-alert",ka);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aa=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],_a=ae("ellipsis-vertical",Aa);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ea=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Ma=ae("eye-off",Ea);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Da=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Va=ae("eye",Da);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ra=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],Ia=ae("globe",Ra);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const La=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],Ii=ae("heart",La);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fa=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],Oa=ae("house",Fa);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ba=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],$a=ae("lock",Ba);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const za=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Ua=ae("mail",za);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ha=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],Ps=ae("message-circle",Ha);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ka=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],Wa=ae("message-square",Ka);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ga=[["path",{d:"M5 12h14",key:"1ays0h"}]],Ya=ae("minus",Ga);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xa=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Li=ae("pen",Xa);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qa=[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z",key:"1nkz8b"}]],Ja=ae("pin",qa),As=m.createContext({});function _s(e){const t=m.useRef(null);return t.current===null&&(t.current=e()),t.current}const Ot=m.createContext(null),Es=m.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class Za extends m.Component{getSnapshotBeforeUpdate(t){const s=this.props.childRef.current;if(s&&t.isPresent&&!this.props.isPresent){const n=this.props.sizeRef.current;n.height=s.offsetHeight||0,n.width=s.offsetWidth||0,n.top=s.offsetTop,n.left=s.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function Qa({children:e,isPresent:t}){const s=m.useId(),n=m.useRef(null),r=m.useRef({width:0,height:0,top:0,left:0}),{nonce:o}=m.useContext(Es);return m.useInsertionEffect(()=>{const{width:a,height:l,top:c,left:d}=r.current;if(t||!n.current||!a||!l)return;n.current.dataset.motionPopId=s;const u=document.createElement("style");return o&&(u.nonce=o),document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${l}px !important;
            top: ${c}px !important;
            left: ${d}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[t]),i.jsx(Za,{isPresent:t,childRef:n,sizeRef:r,children:m.cloneElement(e,{ref:n})})}const eo=({children:e,initial:t,isPresent:s,onExitComplete:n,custom:r,presenceAffectsLayout:o,mode:a})=>{const l=_s(to),c=m.useId(),d=m.useCallback(h=>{l.set(h,!0);for(const f of l.values())if(!f)return;n&&n()},[l,n]),u=m.useMemo(()=>({id:c,initial:t,isPresent:s,custom:r,onExitComplete:d,register:h=>(l.set(h,!1),()=>l.delete(h))}),o?[Math.random(),d]:[s,d]);return m.useMemo(()=>{l.forEach((h,f)=>l.set(f,!1))},[s]),m.useEffect(()=>{!s&&!l.size&&n&&n()},[s]),a==="popLayout"&&(e=i.jsx(Qa,{isPresent:s,children:e})),i.jsx(Ot.Provider,{value:u,children:e})};function to(){return new Map}function Fi(e=!0){const t=m.useContext(Ot);if(t===null)return[!0,null];const{isPresent:s,onExitComplete:n,register:r}=t,o=m.useId();m.useEffect(()=>{e&&r(o)},[e]);const a=m.useCallback(()=>e&&n&&n(o),[o,n,e]);return!s&&n?[!1,a]:[!0]}const vt=e=>e.key||"";function mn(e){const t=[];return m.Children.forEach(e,s=>{m.isValidElement(s)&&t.push(s)}),t}const Ms=typeof window<"u",Oi=Ms?m.useLayoutEffect:m.useEffect,Ge=({children:e,custom:t,initial:s=!0,onExitComplete:n,presenceAffectsLayout:r=!0,mode:o="sync",propagate:a=!1})=>{const[l,c]=Fi(a),d=m.useMemo(()=>mn(e),[e]),u=a&&!l?[]:d.map(vt),h=m.useRef(!0),f=m.useRef(d),p=_s(()=>new Map),[b,y]=m.useState(d),[T,j]=m.useState(d);Oi(()=>{h.current=!1,f.current=d;for(let w=0;w<T.length;w++){const x=vt(T[w]);u.includes(x)?p.delete(x):p.get(x)!==!0&&p.set(x,!1)}},[T,u.length,u.join("-")]);const g=[];if(d!==b){let w=[...d];for(let x=0;x<T.length;x++){const P=T[x],M=vt(P);u.includes(M)||(w.splice(x,0,P),g.push(P))}o==="wait"&&g.length&&(w=g),j(mn(w)),y(d);return}const{forceRender:v}=m.useContext(As);return i.jsx(i.Fragment,{children:T.map(w=>{const x=vt(w),P=a&&!l?!1:d===T||u.includes(x),M=()=>{if(p.has(x))p.set(x,!0);else return;let S=!0;p.forEach(L=>{L||(S=!1)}),S&&(v==null||v(),j(f.current),a&&(c==null||c()),n&&n())};return i.jsx(eo,{isPresent:P,initial:!h.current||s?void 0:!1,custom:P?void 0:t,presenceAffectsLayout:r,mode:o,onExitComplete:P?void 0:M,children:w},x)})})},pe=e=>e;let Bi=pe;function Ds(e){let t;return()=>(t===void 0&&(t=e()),t)}const Ye=(e,t,s)=>{const n=t-e;return n===0?1:(s-e)/n},Ce=e=>e*1e3,ke=e=>e/1e3,so={useManualTiming:!1};function no(e){let t=new Set,s=new Set,n=!1,r=!1;const o=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function l(d){o.has(d)&&(c.schedule(d),e()),d(a)}const c={schedule:(d,u=!1,h=!1)=>{const p=h&&n?t:s;return u&&o.add(d),p.has(d)||p.add(d),d},cancel:d=>{s.delete(d),o.delete(d)},process:d=>{if(a=d,n){r=!0;return}n=!0,[t,s]=[s,t],t.forEach(l),t.clear(),n=!1,r&&(r=!1,c.process(d))}};return c}const bt=["read","resolveKeyframes","update","preRender","render","postRender"],io=40;function $i(e,t){let s=!1,n=!0;const r={delta:0,timestamp:0,isProcessing:!1},o=()=>s=!0,a=bt.reduce((j,g)=>(j[g]=no(o),j),{}),{read:l,resolveKeyframes:c,update:d,preRender:u,render:h,postRender:f}=a,p=()=>{const j=performance.now();s=!1,r.delta=n?1e3/60:Math.max(Math.min(j-r.timestamp,io),1),r.timestamp=j,r.isProcessing=!0,l.process(r),c.process(r),d.process(r),u.process(r),h.process(r),f.process(r),r.isProcessing=!1,s&&t&&(n=!1,e(p))},b=()=>{s=!0,n=!0,r.isProcessing||e(p)};return{schedule:bt.reduce((j,g)=>{const v=a[g];return j[g]=(w,x=!1,P=!1)=>(s||b(),v.schedule(w,x,P)),j},{}),cancel:j=>{for(let g=0;g<bt.length;g++)a[bt[g]].cancel(j)},state:r,steps:a}}const{schedule:J,cancel:Ee,state:le,steps:Yt}=$i(typeof requestAnimationFrame<"u"?requestAnimationFrame:pe,!0),zi=m.createContext({strict:!1}),pn={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Xe={};for(const e in pn)Xe[e]={isEnabled:t=>pn[e].some(s=>!!t[s])};function ro(e){for(const t in e)Xe[t]={...Xe[t],...e[t]}}const ao=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function At(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||ao.has(e)}let Ui=e=>!At(e);function oo(e){e&&(Ui=t=>t.startsWith("on")?!At(t):e(t))}try{oo(require("@emotion/is-prop-valid").default)}catch{}function lo(e,t,s){const n={};for(const r in e)r==="values"&&typeof e.values=="object"||(Ui(r)||s===!0&&At(r)||!t&&!At(r)||e.draggable&&r.startsWith("onDrag"))&&(n[r]=e[r]);return n}function co(e){if(typeof Proxy>"u")return e;const t=new Map,s=(...n)=>e(...n);return new Proxy(s,{get:(n,r)=>r==="create"?e:(t.has(r)||t.set(r,e(r)),t.get(r))})}const Bt=m.createContext({});function ct(e){return typeof e=="string"||Array.isArray(e)}function $t(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const Vs=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Rs=["initial",...Vs];function zt(e){return $t(e.animate)||Rs.some(t=>ct(e[t]))}function Hi(e){return!!(zt(e)||e.variants)}function uo(e,t){if(zt(e)){const{initial:s,animate:n}=e;return{initial:s===!1||ct(s)?s:void 0,animate:ct(n)?n:void 0}}return e.inherit!==!1?t:{}}function ho(e){const{initial:t,animate:s}=uo(e,m.useContext(Bt));return m.useMemo(()=>({initial:t,animate:s}),[xn(t),xn(s)])}function xn(e){return Array.isArray(e)?e.join(" "):e}const fo=Symbol.for("motionComponentSymbol");function ze(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function mo(e,t,s){return m.useCallback(n=>{n&&e.onMount&&e.onMount(n),t&&(n?t.mount(n):t.unmount()),s&&(typeof s=="function"?s(n):ze(s)&&(s.current=n))},[t])}const Is=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),po="framerAppearId",Ki="data-"+Is(po),{schedule:Ls}=$i(queueMicrotask,!1),Wi=m.createContext({});function xo(e,t,s,n,r){var o,a;const{visualElement:l}=m.useContext(Bt),c=m.useContext(zi),d=m.useContext(Ot),u=m.useContext(Es).reducedMotion,h=m.useRef(null);n=n||c.renderer,!h.current&&n&&(h.current=n(e,{visualState:t,parent:l,props:s,presenceContext:d,blockInitialAnimation:d?d.initial===!1:!1,reducedMotionConfig:u}));const f=h.current,p=m.useContext(Wi);f&&!f.projection&&r&&(f.type==="html"||f.type==="svg")&&go(h.current,s,r,p);const b=m.useRef(!1);m.useInsertionEffect(()=>{f&&b.current&&f.update(s,d)});const y=s[Ki],T=m.useRef(!!y&&!(!((o=window.MotionHandoffIsComplete)===null||o===void 0)&&o.call(window,y))&&((a=window.MotionHasOptimisedAnimation)===null||a===void 0?void 0:a.call(window,y)));return Oi(()=>{f&&(b.current=!0,window.MotionIsMounted=!0,f.updateFeatures(),Ls.render(f.render),T.current&&f.animationState&&f.animationState.animateChanges())}),m.useEffect(()=>{f&&(!T.current&&f.animationState&&f.animationState.animateChanges(),T.current&&(queueMicrotask(()=>{var j;(j=window.MotionHandoffMarkAsComplete)===null||j===void 0||j.call(window,y)}),T.current=!1))}),f}function go(e,t,s,n){const{layoutId:r,layout:o,drag:a,dragConstraints:l,layoutScroll:c,layoutRoot:d}=t;e.projection=new s(e.latestValues,t["data-framer-portal-id"]?void 0:Gi(e.parent)),e.projection.setOptions({layoutId:r,layout:o,alwaysMeasureLayout:!!a||l&&ze(l),visualElement:e,animationType:typeof o=="string"?o:"both",initialPromotionConfig:n,layoutScroll:c,layoutRoot:d})}function Gi(e){if(e)return e.options.allowProjection!==!1?e.projection:Gi(e.parent)}function yo({preloadedFeatures:e,createVisualElement:t,useRender:s,useVisualState:n,Component:r}){var o,a;e&&ro(e);function l(d,u){let h;const f={...m.useContext(Es),...d,layoutId:vo(d)},{isStatic:p}=f,b=ho(d),y=n(d,p);if(!p&&Ms){bo();const T=wo(f);h=T.MeasureLayout,b.visualElement=xo(r,y,f,t,T.ProjectionNode)}return i.jsxs(Bt.Provider,{value:b,children:[h&&b.visualElement?i.jsx(h,{visualElement:b.visualElement,...f}):null,s(r,d,mo(y,b.visualElement,u),y,p,b.visualElement)]})}l.displayName=`motion.${typeof r=="string"?r:`create(${(a=(o=r.displayName)!==null&&o!==void 0?o:r.name)!==null&&a!==void 0?a:""})`}`;const c=m.forwardRef(l);return c[fo]=r,c}function vo({layoutId:e}){const t=m.useContext(As).id;return t&&e!==void 0?t+"-"+e:e}function bo(e,t){m.useContext(zi).strict}function wo(e){const{drag:t,layout:s}=Xe;if(!t&&!s)return{};const n={...t,...s};return{MeasureLayout:t!=null&&t.isEnabled(e)||s!=null&&s.isEnabled(e)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}const jo=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Fs(e){return typeof e!="string"||e.includes("-")?!1:!!(jo.indexOf(e)>-1||/[A-Z]/u.test(e))}function gn(e){const t=[{},{}];return e==null||e.values.forEach((s,n)=>{t[0][n]=s.get(),t[1][n]=s.getVelocity()}),t}function Os(e,t,s,n){if(typeof t=="function"){const[r,o]=gn(n);t=t(s!==void 0?s:e.custom,r,o)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[r,o]=gn(n);t=t(s!==void 0?s:e.custom,r,o)}return t}const ls=e=>Array.isArray(e),No=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),So=e=>ls(e)?e[e.length-1]||0:e,ue=e=>!!(e&&e.getVelocity);function Nt(e){const t=ue(e)?e.get():e;return No(t)?t.toValue():t}function To({scrapeMotionValuesFromProps:e,createRenderState:t,onUpdate:s},n,r,o){const a={latestValues:Co(n,r,o,e),renderState:t()};return s&&(a.onMount=l=>s({props:n,current:l,...a}),a.onUpdate=l=>s(l)),a}const Yi=e=>(t,s)=>{const n=m.useContext(Bt),r=m.useContext(Ot),o=()=>To(e,t,n,r);return s?o():_s(o)};function Co(e,t,s,n){const r={},o=n(e,{});for(const f in o)r[f]=Nt(o[f]);let{initial:a,animate:l}=e;const c=zt(e),d=Hi(e);t&&d&&!c&&e.inherit!==!1&&(a===void 0&&(a=t.initial),l===void 0&&(l=t.animate));let u=s?s.initial===!1:!1;u=u||a===!1;const h=u?l:a;if(h&&typeof h!="boolean"&&!$t(h)){const f=Array.isArray(h)?h:[h];for(let p=0;p<f.length;p++){const b=Os(e,f[p]);if(b){const{transitionEnd:y,transition:T,...j}=b;for(const g in j){let v=j[g];if(Array.isArray(v)){const w=u?v.length-1:0;v=v[w]}v!==null&&(r[g]=v)}for(const g in y)r[g]=y[g]}}}return r}const Je=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Be=new Set(Je),Xi=e=>t=>typeof t=="string"&&t.startsWith(e),qi=Xi("--"),ko=Xi("var(--"),Bs=e=>ko(e)?Po.test(e.split("/*")[0].trim()):!1,Po=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Ji=(e,t)=>t&&typeof e=="number"?t.transform(e):e,Pe=(e,t,s)=>s>t?t:s<e?e:s,Ze={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},dt={...Ze,transform:e=>Pe(0,1,e)},wt={...Ze,default:1},mt=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),_e=mt("deg"),Ne=mt("%"),I=mt("px"),Ao=mt("vh"),_o=mt("vw"),yn={...Ne,parse:e=>Ne.parse(e)/100,transform:e=>Ne.transform(e*100)},Eo={borderWidth:I,borderTopWidth:I,borderRightWidth:I,borderBottomWidth:I,borderLeftWidth:I,borderRadius:I,radius:I,borderTopLeftRadius:I,borderTopRightRadius:I,borderBottomRightRadius:I,borderBottomLeftRadius:I,width:I,maxWidth:I,height:I,maxHeight:I,top:I,right:I,bottom:I,left:I,padding:I,paddingTop:I,paddingRight:I,paddingBottom:I,paddingLeft:I,margin:I,marginTop:I,marginRight:I,marginBottom:I,marginLeft:I,backgroundPositionX:I,backgroundPositionY:I},Mo={rotate:_e,rotateX:_e,rotateY:_e,rotateZ:_e,scale:wt,scaleX:wt,scaleY:wt,scaleZ:wt,skew:_e,skewX:_e,skewY:_e,distance:I,translateX:I,translateY:I,translateZ:I,x:I,y:I,z:I,perspective:I,transformPerspective:I,opacity:dt,originX:yn,originY:yn,originZ:I},vn={...Ze,transform:Math.round},$s={...Eo,...Mo,zIndex:vn,size:I,fillOpacity:dt,strokeOpacity:dt,numOctaves:vn},Do={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Vo=Je.length;function Ro(e,t,s){let n="",r=!0;for(let o=0;o<Vo;o++){const a=Je[o],l=e[a];if(l===void 0)continue;let c=!0;if(typeof l=="number"?c=l===(a.startsWith("scale")?1:0):c=parseFloat(l)===0,!c||s){const d=Ji(l,$s[a]);if(!c){r=!1;const u=Do[a]||a;n+=`${u}(${d}) `}s&&(t[a]=d)}}return n=n.trim(),s?n=s(t,r?"":n):r&&(n="none"),n}function zs(e,t,s){const{style:n,vars:r,transformOrigin:o}=e;let a=!1,l=!1;for(const c in t){const d=t[c];if(Be.has(c)){a=!0;continue}else if(qi(c)){r[c]=d;continue}else{const u=Ji(d,$s[c]);c.startsWith("origin")?(l=!0,o[c]=u):n[c]=u}}if(t.transform||(a||s?n.transform=Ro(t,e.transform,s):n.transform&&(n.transform="none")),l){const{originX:c="50%",originY:d="50%",originZ:u=0}=o;n.transformOrigin=`${c} ${d} ${u}`}}const Io={offset:"stroke-dashoffset",array:"stroke-dasharray"},Lo={offset:"strokeDashoffset",array:"strokeDasharray"};function Fo(e,t,s=1,n=0,r=!0){e.pathLength=1;const o=r?Io:Lo;e[o.offset]=I.transform(-n);const a=I.transform(t),l=I.transform(s);e[o.array]=`${a} ${l}`}function bn(e,t,s){return typeof e=="string"?e:I.transform(t+s*e)}function Oo(e,t,s){const n=bn(t,e.x,e.width),r=bn(s,e.y,e.height);return`${n} ${r}`}function Us(e,{attrX:t,attrY:s,attrScale:n,originX:r,originY:o,pathLength:a,pathSpacing:l=1,pathOffset:c=0,...d},u,h){if(zs(e,d,h),u){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:f,style:p,dimensions:b}=e;f.transform&&(b&&(p.transform=f.transform),delete f.transform),b&&(r!==void 0||o!==void 0||p.transform)&&(p.transformOrigin=Oo(b,r!==void 0?r:.5,o!==void 0?o:.5)),t!==void 0&&(f.x=t),s!==void 0&&(f.y=s),n!==void 0&&(f.scale=n),a!==void 0&&Fo(f,a,l,c,!1)}const Hs=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),Zi=()=>({...Hs(),attrs:{}}),Ks=e=>typeof e=="string"&&e.toLowerCase()==="svg";function Qi(e,{style:t,vars:s},n,r){Object.assign(e.style,t,r&&r.getProjectionStyles(n));for(const o in s)e.style.setProperty(o,s[o])}const er=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function tr(e,t,s,n){Qi(e,t,void 0,n);for(const r in t.attrs)e.setAttribute(er.has(r)?r:Is(r),t.attrs[r])}const _t={};function Bo(e){Object.assign(_t,e)}function sr(e,{layout:t,layoutId:s}){return Be.has(e)||e.startsWith("origin")||(t||s!==void 0)&&(!!_t[e]||e==="opacity")}function Ws(e,t,s){var n;const{style:r}=e,o={};for(const a in r)(ue(r[a])||t.style&&ue(t.style[a])||sr(a,e)||((n=s==null?void 0:s.getValue(a))===null||n===void 0?void 0:n.liveStyle)!==void 0)&&(o[a]=r[a]);return o}function nr(e,t,s){const n=Ws(e,t,s);for(const r in e)if(ue(e[r])||ue(t[r])){const o=Je.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;n[o]=e[r]}return n}function $o(e,t){try{t.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{t.dimensions={x:0,y:0,width:0,height:0}}}const wn=["x","y","width","height","cx","cy","r"],zo={useVisualState:Yi({scrapeMotionValuesFromProps:nr,createRenderState:Zi,onUpdate:({props:e,prevProps:t,current:s,renderState:n,latestValues:r})=>{if(!s)return;let o=!!e.drag;if(!o){for(const l in r)if(Be.has(l)){o=!0;break}}if(!o)return;let a=!t;if(t)for(let l=0;l<wn.length;l++){const c=wn[l];e[c]!==t[c]&&(a=!0)}a&&J.read(()=>{$o(s,n),J.render(()=>{Us(n,r,Ks(s.tagName),e.transformTemplate),tr(s,n)})})}})},Uo={useVisualState:Yi({scrapeMotionValuesFromProps:Ws,createRenderState:Hs})};function ir(e,t,s){for(const n in t)!ue(t[n])&&!sr(n,s)&&(e[n]=t[n])}function Ho({transformTemplate:e},t){return m.useMemo(()=>{const s=Hs();return zs(s,t,e),Object.assign({},s.vars,s.style)},[t])}function Ko(e,t){const s=e.style||{},n={};return ir(n,s,e),Object.assign(n,Ho(e,t)),n}function Wo(e,t){const s={},n=Ko(e,t);return e.drag&&e.dragListener!==!1&&(s.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(s.tabIndex=0),s.style=n,s}function Go(e,t,s,n){const r=m.useMemo(()=>{const o=Zi();return Us(o,t,Ks(n),e.transformTemplate),{...o.attrs,style:{...o.style}}},[t]);if(e.style){const o={};ir(o,e.style,e),r.style={...o,...r.style}}return r}function Yo(e=!1){return(s,n,r,{latestValues:o},a)=>{const c=(Fs(s)?Go:Wo)(n,o,a,s),d=lo(n,typeof s=="string",e),u=s!==m.Fragment?{...d,...c,ref:r}:{},{children:h}=n,f=m.useMemo(()=>ue(h)?h.get():h,[h]);return m.createElement(s,{...u,children:f})}}function Xo(e,t){return function(n,{forwardMotionProps:r}={forwardMotionProps:!1}){const a={...Fs(n)?zo:Uo,preloadedFeatures:e,useRender:Yo(r),createVisualElement:t,Component:n};return yo(a)}}function rr(e,t){if(!Array.isArray(t))return!1;const s=t.length;if(s!==e.length)return!1;for(let n=0;n<s;n++)if(t[n]!==e[n])return!1;return!0}function Ut(e,t,s){const n=e.getProps();return Os(n,t,s!==void 0?s:n.custom,e)}const qo=Ds(()=>window.ScrollTimeline!==void 0);class Jo{constructor(t){this.stop=()=>this.runAll("stop"),this.animations=t.filter(Boolean)}get finished(){return Promise.all(this.animations.map(t=>"finished"in t?t.finished:t))}getAll(t){return this.animations[0][t]}setAll(t,s){for(let n=0;n<this.animations.length;n++)this.animations[n][t]=s}attachTimeline(t,s){const n=this.animations.map(r=>{if(qo()&&r.attachTimeline)return r.attachTimeline(t);if(typeof s=="function")return s(r)});return()=>{n.forEach((r,o)=>{r&&r(),this.animations[o].stop()})}}get time(){return this.getAll("time")}set time(t){this.setAll("time",t)}get speed(){return this.getAll("speed")}set speed(t){this.setAll("speed",t)}get startTime(){return this.getAll("startTime")}get duration(){let t=0;for(let s=0;s<this.animations.length;s++)t=Math.max(t,this.animations[s].duration);return t}runAll(t){this.animations.forEach(s=>s[t]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class Zo extends Jo{then(t,s){return Promise.all(this.animations).then(t).catch(s)}}function Gs(e,t){return e?e[t]||e.default||e:void 0}const cs=2e4;function ar(e){let t=0;const s=50;let n=e.next(t);for(;!n.done&&t<cs;)t+=s,n=e.next(t);return t>=cs?1/0:t}function Ys(e){return typeof e=="function"}function jn(e,t){e.timeline=t,e.onfinish=null}const Xs=e=>Array.isArray(e)&&typeof e[0]=="number",Qo={linearEasing:void 0};function el(e,t){const s=Ds(e);return()=>{var n;return(n=Qo[t])!==null&&n!==void 0?n:s()}}const Et=el(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),or=(e,t,s=10)=>{let n="";const r=Math.max(Math.round(t/s),2);for(let o=0;o<r;o++)n+=e(Ye(0,r-1,o))+", ";return`linear(${n.substring(0,n.length-2)})`};function lr(e){return!!(typeof e=="function"&&Et()||!e||typeof e=="string"&&(e in ds||Et())||Xs(e)||Array.isArray(e)&&e.every(lr))}const tt=([e,t,s,n])=>`cubic-bezier(${e}, ${t}, ${s}, ${n})`,ds={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:tt([0,.65,.55,1]),circOut:tt([.55,0,1,.45]),backIn:tt([.31,.01,.66,-.59]),backOut:tt([.33,1.53,.69,.99])};function cr(e,t){if(e)return typeof e=="function"&&Et()?or(e,t):Xs(e)?tt(e):Array.isArray(e)?e.map(s=>cr(s,t)||ds.easeOut):ds[e]}const we={x:!1,y:!1};function dr(){return we.x||we.y}function tl(e,t,s){var n;if(e instanceof Element)return[e];if(typeof e=="string"){let r=document;const o=(n=void 0)!==null&&n!==void 0?n:r.querySelectorAll(e);return o?Array.from(o):[]}return Array.from(e)}function ur(e,t){const s=tl(e),n=new AbortController,r={passive:!0,...t,signal:n.signal};return[s,r,()=>n.abort()]}function Nn(e){return t=>{t.pointerType==="touch"||dr()||e(t)}}function sl(e,t,s={}){const[n,r,o]=ur(e,s),a=Nn(l=>{const{target:c}=l,d=t(l);if(typeof d!="function"||!c)return;const u=Nn(h=>{d(h),c.removeEventListener("pointerleave",u)});c.addEventListener("pointerleave",u,r)});return n.forEach(l=>{l.addEventListener("pointerenter",a,r)}),o}const hr=(e,t)=>t?e===t?!0:hr(e,t.parentElement):!1,qs=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,nl=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function il(e){return nl.has(e.tagName)||e.tabIndex!==-1}const st=new WeakSet;function Sn(e){return t=>{t.key==="Enter"&&e(t)}}function Xt(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const rl=(e,t)=>{const s=e.currentTarget;if(!s)return;const n=Sn(()=>{if(st.has(s))return;Xt(s,"down");const r=Sn(()=>{Xt(s,"up")}),o=()=>Xt(s,"cancel");s.addEventListener("keyup",r,t),s.addEventListener("blur",o,t)});s.addEventListener("keydown",n,t),s.addEventListener("blur",()=>s.removeEventListener("keydown",n),t)};function Tn(e){return qs(e)&&!dr()}function al(e,t,s={}){const[n,r,o]=ur(e,s),a=l=>{const c=l.currentTarget;if(!Tn(l)||st.has(c))return;st.add(c);const d=t(l),u=(p,b)=>{window.removeEventListener("pointerup",h),window.removeEventListener("pointercancel",f),!(!Tn(p)||!st.has(c))&&(st.delete(c),typeof d=="function"&&d(p,{success:b}))},h=p=>{u(p,s.useGlobalTarget||hr(c,p.target))},f=p=>{u(p,!1)};window.addEventListener("pointerup",h,r),window.addEventListener("pointercancel",f,r)};return n.forEach(l=>{!il(l)&&l.getAttribute("tabindex")===null&&(l.tabIndex=0),(s.useGlobalTarget?window:l).addEventListener("pointerdown",a,r),l.addEventListener("focus",d=>rl(d,r),r)}),o}function ol(e){return e==="x"||e==="y"?we[e]?null:(we[e]=!0,()=>{we[e]=!1}):we.x||we.y?null:(we.x=we.y=!0,()=>{we.x=we.y=!1})}const fr=new Set(["width","height","top","left","right","bottom",...Je]);let St;function ll(){St=void 0}const Se={now:()=>(St===void 0&&Se.set(le.isProcessing||so.useManualTiming?le.timestamp:performance.now()),St),set:e=>{St=e,queueMicrotask(ll)}};function Js(e,t){e.indexOf(t)===-1&&e.push(t)}function Zs(e,t){const s=e.indexOf(t);s>-1&&e.splice(s,1)}class Qs{constructor(){this.subscriptions=[]}add(t){return Js(this.subscriptions,t),()=>Zs(this.subscriptions,t)}notify(t,s,n){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](t,s,n);else for(let o=0;o<r;o++){const a=this.subscriptions[o];a&&a(t,s,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function mr(e,t){return t?e*(1e3/t):0}const Cn=30,cl=e=>!isNaN(parseFloat(e));class dl{constructor(t,s={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(n,r=!0)=>{const o=Se.now();this.updatedAt!==o&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(t),this.owner=s.owner}setCurrent(t){this.current=t,this.updatedAt=Se.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=cl(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,s){this.events[t]||(this.events[t]=new Qs);const n=this.events[t].add(s);return t==="change"?()=>{n(),J.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,s){this.passiveEffect=t,this.stopPassiveEffect=s}set(t,s=!0){!s||!this.passiveEffect?this.updateAndNotify(t,s):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,s,n){this.set(s),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-n}jump(t,s=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,s&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=Se.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>Cn)return 0;const s=Math.min(this.updatedAt-this.prevUpdatedAt,Cn);return mr(parseFloat(this.current)-parseFloat(this.prevFrameValue),s)}start(t){return this.stop(),new Promise(s=>{this.hasAnimated=!0,this.animation=t(s),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function ut(e,t){return new dl(e,t)}function ul(e,t,s){e.hasValue(t)?e.getValue(t).set(s):e.addValue(t,ut(s))}function hl(e,t){const s=Ut(e,t);let{transitionEnd:n={},transition:r={},...o}=s||{};o={...o,...n};for(const a in o){const l=So(o[a]);ul(e,a,l)}}function fl(e){return!!(ue(e)&&e.add)}function us(e,t){const s=e.getValue("willChange");if(fl(s))return s.add(t)}function pr(e){return e.props[Ki]}const xr=(e,t,s)=>(((1-3*s+3*t)*e+(3*s-6*t))*e+3*t)*e,ml=1e-7,pl=12;function xl(e,t,s,n,r){let o,a,l=0;do a=t+(s-t)/2,o=xr(a,n,r)-e,o>0?s=a:t=a;while(Math.abs(o)>ml&&++l<pl);return a}function pt(e,t,s,n){if(e===t&&s===n)return pe;const r=o=>xl(o,0,1,e,s);return o=>o===0||o===1?o:xr(r(o),t,n)}const gr=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,yr=e=>t=>1-e(1-t),vr=pt(.33,1.53,.69,.99),en=yr(vr),br=gr(en),wr=e=>(e*=2)<1?.5*en(e):.5*(2-Math.pow(2,-10*(e-1))),tn=e=>1-Math.sin(Math.acos(e)),jr=yr(tn),Nr=gr(tn),Sr=e=>/^0[^.\s]+$/u.test(e);function gl(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||Sr(e):!0}const it=e=>Math.round(e*1e5)/1e5,sn=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function yl(e){return e==null}const vl=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,nn=(e,t)=>s=>!!(typeof s=="string"&&vl.test(s)&&s.startsWith(e)||t&&!yl(s)&&Object.prototype.hasOwnProperty.call(s,t)),Tr=(e,t,s)=>n=>{if(typeof n!="string")return n;const[r,o,a,l]=n.match(sn);return{[e]:parseFloat(r),[t]:parseFloat(o),[s]:parseFloat(a),alpha:l!==void 0?parseFloat(l):1}},bl=e=>Pe(0,255,e),qt={...Ze,transform:e=>Math.round(bl(e))},Le={test:nn("rgb","red"),parse:Tr("red","green","blue"),transform:({red:e,green:t,blue:s,alpha:n=1})=>"rgba("+qt.transform(e)+", "+qt.transform(t)+", "+qt.transform(s)+", "+it(dt.transform(n))+")"};function wl(e){let t="",s="",n="",r="";return e.length>5?(t=e.substring(1,3),s=e.substring(3,5),n=e.substring(5,7),r=e.substring(7,9)):(t=e.substring(1,2),s=e.substring(2,3),n=e.substring(3,4),r=e.substring(4,5),t+=t,s+=s,n+=n,r+=r),{red:parseInt(t,16),green:parseInt(s,16),blue:parseInt(n,16),alpha:r?parseInt(r,16)/255:1}}const hs={test:nn("#"),parse:wl,transform:Le.transform},Ue={test:nn("hsl","hue"),parse:Tr("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:s,alpha:n=1})=>"hsla("+Math.round(e)+", "+Ne.transform(it(t))+", "+Ne.transform(it(s))+", "+it(dt.transform(n))+")"},de={test:e=>Le.test(e)||hs.test(e)||Ue.test(e),parse:e=>Le.test(e)?Le.parse(e):Ue.test(e)?Ue.parse(e):hs.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Le.transform(e):Ue.transform(e)},jl=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Nl(e){var t,s;return isNaN(e)&&typeof e=="string"&&(((t=e.match(sn))===null||t===void 0?void 0:t.length)||0)+(((s=e.match(jl))===null||s===void 0?void 0:s.length)||0)>0}const Cr="number",kr="color",Sl="var",Tl="var(",kn="${}",Cl=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function ht(e){const t=e.toString(),s=[],n={color:[],number:[],var:[]},r=[];let o=0;const l=t.replace(Cl,c=>(de.test(c)?(n.color.push(o),r.push(kr),s.push(de.parse(c))):c.startsWith(Tl)?(n.var.push(o),r.push(Sl),s.push(c)):(n.number.push(o),r.push(Cr),s.push(parseFloat(c))),++o,kn)).split(kn);return{values:s,split:l,indexes:n,types:r}}function Pr(e){return ht(e).values}function Ar(e){const{split:t,types:s}=ht(e),n=t.length;return r=>{let o="";for(let a=0;a<n;a++)if(o+=t[a],r[a]!==void 0){const l=s[a];l===Cr?o+=it(r[a]):l===kr?o+=de.transform(r[a]):o+=r[a]}return o}}const kl=e=>typeof e=="number"?0:e;function Pl(e){const t=Pr(e);return Ar(e)(t.map(kl))}const Me={test:Nl,parse:Pr,createTransformer:Ar,getAnimatableNone:Pl},Al=new Set(["brightness","contrast","saturate","opacity"]);function _l(e){const[t,s]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=s.match(sn)||[];if(!n)return e;const r=s.replace(n,"");let o=Al.has(t)?1:0;return n!==s&&(o*=100),t+"("+o+r+")"}const El=/\b([a-z-]*)\(.*?\)/gu,fs={...Me,getAnimatableNone:e=>{const t=e.match(El);return t?t.map(_l).join(" "):e}},Ml={...$s,color:de,backgroundColor:de,outlineColor:de,fill:de,stroke:de,borderColor:de,borderTopColor:de,borderRightColor:de,borderBottomColor:de,borderLeftColor:de,filter:fs,WebkitFilter:fs},rn=e=>Ml[e];function _r(e,t){let s=rn(e);return s!==fs&&(s=Me),s.getAnimatableNone?s.getAnimatableNone(t):void 0}const Dl=new Set(["auto","none","0"]);function Vl(e,t,s){let n=0,r;for(;n<e.length&&!r;){const o=e[n];typeof o=="string"&&!Dl.has(o)&&ht(o).values.length&&(r=e[n]),n++}if(r&&s)for(const o of t)e[o]=_r(s,r)}const Pn=e=>e===Ze||e===I,An=(e,t)=>parseFloat(e.split(", ")[t]),_n=(e,t)=>(s,{transform:n})=>{if(n==="none"||!n)return 0;const r=n.match(/^matrix3d\((.+)\)$/u);if(r)return An(r[1],t);{const o=n.match(/^matrix\((.+)\)$/u);return o?An(o[1],e):0}},Rl=new Set(["x","y","z"]),Il=Je.filter(e=>!Rl.has(e));function Ll(e){const t=[];return Il.forEach(s=>{const n=e.getValue(s);n!==void 0&&(t.push([s,n.get()]),n.set(s.startsWith("scale")?1:0))}),t}const qe={width:({x:e},{paddingLeft:t="0",paddingRight:s="0"})=>e.max-e.min-parseFloat(t)-parseFloat(s),height:({y:e},{paddingTop:t="0",paddingBottom:s="0"})=>e.max-e.min-parseFloat(t)-parseFloat(s),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:_n(4,13),y:_n(5,14)};qe.translateX=qe.x;qe.translateY=qe.y;const Oe=new Set;let ms=!1,ps=!1;function Er(){if(ps){const e=Array.from(Oe).filter(n=>n.needsMeasurement),t=new Set(e.map(n=>n.element)),s=new Map;t.forEach(n=>{const r=Ll(n);r.length&&(s.set(n,r),n.render())}),e.forEach(n=>n.measureInitialState()),t.forEach(n=>{n.render();const r=s.get(n);r&&r.forEach(([o,a])=>{var l;(l=n.getValue(o))===null||l===void 0||l.set(a)})}),e.forEach(n=>n.measureEndState()),e.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}ps=!1,ms=!1,Oe.forEach(e=>e.complete()),Oe.clear()}function Mr(){Oe.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(ps=!0)})}function Fl(){Mr(),Er()}class an{constructor(t,s,n,r,o,a=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...t],this.onComplete=s,this.name=n,this.motionValue=r,this.element=o,this.isAsync=a}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Oe.add(this),ms||(ms=!0,J.read(Mr),J.resolveKeyframes(Er))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:s,element:n,motionValue:r}=this;for(let o=0;o<t.length;o++)if(t[o]===null)if(o===0){const a=r==null?void 0:r.get(),l=t[t.length-1];if(a!==void 0)t[0]=a;else if(n&&s){const c=n.readValue(s,l);c!=null&&(t[0]=c)}t[0]===void 0&&(t[0]=l),r&&a===void 0&&r.set(t[0])}else t[o]=t[o-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),Oe.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Oe.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const Dr=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),Ol=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Bl(e){const t=Ol.exec(e);if(!t)return[,];const[,s,n,r]=t;return[`--${s??n}`,r]}function Vr(e,t,s=1){const[n,r]=Bl(e);if(!n)return;const o=window.getComputedStyle(t).getPropertyValue(n);if(o){const a=o.trim();return Dr(a)?parseFloat(a):a}return Bs(r)?Vr(r,t,s+1):r}const Rr=e=>t=>t.test(e),$l={test:e=>e==="auto",parse:e=>e},Ir=[Ze,I,Ne,_e,_o,Ao,$l],En=e=>Ir.find(Rr(e));class Lr extends an{constructor(t,s,n,r,o){super(t,s,n,r,o,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:s,name:n}=this;if(!s||!s.current)return;super.readKeyframes();for(let c=0;c<t.length;c++){let d=t[c];if(typeof d=="string"&&(d=d.trim(),Bs(d))){const u=Vr(d,s.current);u!==void 0&&(t[c]=u),c===t.length-1&&(this.finalKeyframe=d)}}if(this.resolveNoneKeyframes(),!fr.has(n)||t.length!==2)return;const[r,o]=t,a=En(r),l=En(o);if(a!==l)if(Pn(a)&&Pn(l))for(let c=0;c<t.length;c++){const d=t[c];typeof d=="string"&&(t[c]=parseFloat(d))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:s}=this,n=[];for(let r=0;r<t.length;r++)gl(t[r])&&n.push(r);n.length&&Vl(t,n,s)}measureInitialState(){const{element:t,unresolvedKeyframes:s,name:n}=this;if(!t||!t.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=qe[n](t.measureViewportBox(),window.getComputedStyle(t.current)),s[0]=this.measuredOrigin;const r=s[s.length-1];r!==void 0&&t.getValue(n,r).jump(r,!1)}measureEndState(){var t;const{element:s,name:n,unresolvedKeyframes:r}=this;if(!s||!s.current)return;const o=s.getValue(n);o&&o.jump(this.measuredOrigin,!1);const a=r.length-1,l=r[a];r[a]=qe[n](s.measureViewportBox(),window.getComputedStyle(s.current)),l!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=l),!((t=this.removedTransforms)===null||t===void 0)&&t.length&&this.removedTransforms.forEach(([c,d])=>{s.getValue(c).set(d)}),this.resolveNoneKeyframes()}}const Mn=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Me.test(e)||e==="0")&&!e.startsWith("url("));function zl(e){const t=e[0];if(e.length===1)return!0;for(let s=0;s<e.length;s++)if(e[s]!==t)return!0}function Ul(e,t,s,n){const r=e[0];if(r===null)return!1;if(t==="display"||t==="visibility")return!0;const o=e[e.length-1],a=Mn(r,t),l=Mn(o,t);return!a||!l?!1:zl(e)||(s==="spring"||Ys(s))&&n}const Hl=e=>e!==null;function Ht(e,{repeat:t,repeatType:s="loop"},n){const r=e.filter(Hl),o=t&&s!=="loop"&&t%2===1?0:r.length-1;return!o||n===void 0?r[o]:n}const Kl=40;class Fr{constructor({autoplay:t=!0,delay:s=0,type:n="keyframes",repeat:r=0,repeatDelay:o=0,repeatType:a="loop",...l}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Se.now(),this.options={autoplay:t,delay:s,type:n,repeat:r,repeatDelay:o,repeatType:a,...l},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>Kl?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&Fl(),this._resolved}onKeyframesResolved(t,s){this.resolvedAt=Se.now(),this.hasAttemptedResolve=!0;const{name:n,type:r,velocity:o,delay:a,onComplete:l,onUpdate:c,isGenerator:d}=this.options;if(!d&&!Ul(t,n,r,o))if(a)this.options.duration=0;else{c&&c(Ht(t,this.options,s)),l&&l(),this.resolveFinishedPromise();return}const u=this.initPlayback(t,s);u!==!1&&(this._resolved={keyframes:t,finalKeyframe:s,...u},this.onPostResolved())}onPostResolved(){}then(t,s){return this.currentFinishedPromise.then(t,s)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(t=>{this.resolveFinishedPromise=t})}}const Q=(e,t,s)=>e+(t-e)*s;function Jt(e,t,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?e+(t-e)*6*s:s<1/2?t:s<2/3?e+(t-e)*(2/3-s)*6:e}function Wl({hue:e,saturation:t,lightness:s,alpha:n}){e/=360,t/=100,s/=100;let r=0,o=0,a=0;if(!t)r=o=a=s;else{const l=s<.5?s*(1+t):s+t-s*t,c=2*s-l;r=Jt(c,l,e+1/3),o=Jt(c,l,e),a=Jt(c,l,e-1/3)}return{red:Math.round(r*255),green:Math.round(o*255),blue:Math.round(a*255),alpha:n}}function Mt(e,t){return s=>s>0?t:e}const Zt=(e,t,s)=>{const n=e*e,r=s*(t*t-n)+n;return r<0?0:Math.sqrt(r)},Gl=[hs,Le,Ue],Yl=e=>Gl.find(t=>t.test(e));function Dn(e){const t=Yl(e);if(!t)return!1;let s=t.parse(e);return t===Ue&&(s=Wl(s)),s}const Vn=(e,t)=>{const s=Dn(e),n=Dn(t);if(!s||!n)return Mt(e,t);const r={...s};return o=>(r.red=Zt(s.red,n.red,o),r.green=Zt(s.green,n.green,o),r.blue=Zt(s.blue,n.blue,o),r.alpha=Q(s.alpha,n.alpha,o),Le.transform(r))},Xl=(e,t)=>s=>t(e(s)),xt=(...e)=>e.reduce(Xl),xs=new Set(["none","hidden"]);function ql(e,t){return xs.has(e)?s=>s<=0?e:t:s=>s>=1?t:e}function Jl(e,t){return s=>Q(e,t,s)}function on(e){return typeof e=="number"?Jl:typeof e=="string"?Bs(e)?Mt:de.test(e)?Vn:ec:Array.isArray(e)?Or:typeof e=="object"?de.test(e)?Vn:Zl:Mt}function Or(e,t){const s=[...e],n=s.length,r=e.map((o,a)=>on(o)(o,t[a]));return o=>{for(let a=0;a<n;a++)s[a]=r[a](o);return s}}function Zl(e,t){const s={...e,...t},n={};for(const r in s)e[r]!==void 0&&t[r]!==void 0&&(n[r]=on(e[r])(e[r],t[r]));return r=>{for(const o in n)s[o]=n[o](r);return s}}function Ql(e,t){var s;const n=[],r={color:0,var:0,number:0};for(let o=0;o<t.values.length;o++){const a=t.types[o],l=e.indexes[a][r[a]],c=(s=e.values[l])!==null&&s!==void 0?s:0;n[o]=c,r[a]++}return n}const ec=(e,t)=>{const s=Me.createTransformer(t),n=ht(e),r=ht(t);return n.indexes.var.length===r.indexes.var.length&&n.indexes.color.length===r.indexes.color.length&&n.indexes.number.length>=r.indexes.number.length?xs.has(e)&&!r.values.length||xs.has(t)&&!n.values.length?ql(e,t):xt(Or(Ql(n,r),r.values),s):Mt(e,t)};function Br(e,t,s){return typeof e=="number"&&typeof t=="number"&&typeof s=="number"?Q(e,t,s):on(e)(e,t)}const tc=5;function $r(e,t,s){const n=Math.max(t-tc,0);return mr(s-e(n),t-n)}const ee={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Qt=.001;function sc({duration:e=ee.duration,bounce:t=ee.bounce,velocity:s=ee.velocity,mass:n=ee.mass}){let r,o,a=1-t;a=Pe(ee.minDamping,ee.maxDamping,a),e=Pe(ee.minDuration,ee.maxDuration,ke(e)),a<1?(r=d=>{const u=d*a,h=u*e,f=u-s,p=gs(d,a),b=Math.exp(-h);return Qt-f/p*b},o=d=>{const h=d*a*e,f=h*s+s,p=Math.pow(a,2)*Math.pow(d,2)*e,b=Math.exp(-h),y=gs(Math.pow(d,2),a);return(-r(d)+Qt>0?-1:1)*((f-p)*b)/y}):(r=d=>{const u=Math.exp(-d*e),h=(d-s)*e+1;return-Qt+u*h},o=d=>{const u=Math.exp(-d*e),h=(s-d)*(e*e);return u*h});const l=5/e,c=ic(r,o,l);if(e=Ce(e),isNaN(c))return{stiffness:ee.stiffness,damping:ee.damping,duration:e};{const d=Math.pow(c,2)*n;return{stiffness:d,damping:a*2*Math.sqrt(n*d),duration:e}}}const nc=12;function ic(e,t,s){let n=s;for(let r=1;r<nc;r++)n=n-e(n)/t(n);return n}function gs(e,t){return e*Math.sqrt(1-t*t)}const rc=["duration","bounce"],ac=["stiffness","damping","mass"];function Rn(e,t){return t.some(s=>e[s]!==void 0)}function oc(e){let t={velocity:ee.velocity,stiffness:ee.stiffness,damping:ee.damping,mass:ee.mass,isResolvedFromDuration:!1,...e};if(!Rn(e,ac)&&Rn(e,rc))if(e.visualDuration){const s=e.visualDuration,n=2*Math.PI/(s*1.2),r=n*n,o=2*Pe(.05,1,1-(e.bounce||0))*Math.sqrt(r);t={...t,mass:ee.mass,stiffness:r,damping:o}}else{const s=sc(e);t={...t,...s,mass:ee.mass},t.isResolvedFromDuration=!0}return t}function zr(e=ee.visualDuration,t=ee.bounce){const s=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:n,restDelta:r}=s;const o=s.keyframes[0],a=s.keyframes[s.keyframes.length-1],l={done:!1,value:o},{stiffness:c,damping:d,mass:u,duration:h,velocity:f,isResolvedFromDuration:p}=oc({...s,velocity:-ke(s.velocity||0)}),b=f||0,y=d/(2*Math.sqrt(c*u)),T=a-o,j=ke(Math.sqrt(c/u)),g=Math.abs(T)<5;n||(n=g?ee.restSpeed.granular:ee.restSpeed.default),r||(r=g?ee.restDelta.granular:ee.restDelta.default);let v;if(y<1){const x=gs(j,y);v=P=>{const M=Math.exp(-y*j*P);return a-M*((b+y*j*T)/x*Math.sin(x*P)+T*Math.cos(x*P))}}else if(y===1)v=x=>a-Math.exp(-j*x)*(T+(b+j*T)*x);else{const x=j*Math.sqrt(y*y-1);v=P=>{const M=Math.exp(-y*j*P),S=Math.min(x*P,300);return a-M*((b+y*j*T)*Math.sinh(S)+x*T*Math.cosh(S))/x}}const w={calculatedDuration:p&&h||null,next:x=>{const P=v(x);if(p)l.done=x>=h;else{let M=0;y<1&&(M=x===0?Ce(b):$r(v,x,P));const S=Math.abs(M)<=n,L=Math.abs(a-P)<=r;l.done=S&&L}return l.value=l.done?a:P,l},toString:()=>{const x=Math.min(ar(w),cs),P=or(M=>w.next(x*M).value,x,30);return x+"ms "+P}};return w}function In({keyframes:e,velocity:t=0,power:s=.8,timeConstant:n=325,bounceDamping:r=10,bounceStiffness:o=500,modifyTarget:a,min:l,max:c,restDelta:d=.5,restSpeed:u}){const h=e[0],f={done:!1,value:h},p=S=>l!==void 0&&S<l||c!==void 0&&S>c,b=S=>l===void 0?c:c===void 0||Math.abs(l-S)<Math.abs(c-S)?l:c;let y=s*t;const T=h+y,j=a===void 0?T:a(T);j!==T&&(y=j-h);const g=S=>-y*Math.exp(-S/n),v=S=>j+g(S),w=S=>{const L=g(S),O=v(S);f.done=Math.abs(L)<=d,f.value=f.done?j:O};let x,P;const M=S=>{p(f.value)&&(x=S,P=zr({keyframes:[f.value,b(f.value)],velocity:$r(v,S,f.value),damping:r,stiffness:o,restDelta:d,restSpeed:u}))};return M(0),{calculatedDuration:null,next:S=>{let L=!1;return!P&&x===void 0&&(L=!0,w(S),M(S)),x!==void 0&&S>=x?P.next(S-x):(!L&&w(S),f)}}}const lc=pt(.42,0,1,1),cc=pt(0,0,.58,1),Ur=pt(.42,0,.58,1),dc=e=>Array.isArray(e)&&typeof e[0]!="number",uc={linear:pe,easeIn:lc,easeInOut:Ur,easeOut:cc,circIn:tn,circInOut:Nr,circOut:jr,backIn:en,backInOut:br,backOut:vr,anticipate:wr},Ln=e=>{if(Xs(e)){Bi(e.length===4);const[t,s,n,r]=e;return pt(t,s,n,r)}else if(typeof e=="string")return uc[e];return e};function hc(e,t,s){const n=[],r=s||Br,o=e.length-1;for(let a=0;a<o;a++){let l=r(e[a],e[a+1]);if(t){const c=Array.isArray(t)?t[a]||pe:t;l=xt(c,l)}n.push(l)}return n}function fc(e,t,{clamp:s=!0,ease:n,mixer:r}={}){const o=e.length;if(Bi(o===t.length),o===1)return()=>t[0];if(o===2&&t[0]===t[1])return()=>t[1];const a=e[0]===e[1];e[0]>e[o-1]&&(e=[...e].reverse(),t=[...t].reverse());const l=hc(t,n,r),c=l.length,d=u=>{if(a&&u<e[0])return t[0];let h=0;if(c>1)for(;h<e.length-2&&!(u<e[h+1]);h++);const f=Ye(e[h],e[h+1],u);return l[h](f)};return s?u=>d(Pe(e[0],e[o-1],u)):d}function mc(e,t){const s=e[e.length-1];for(let n=1;n<=t;n++){const r=Ye(0,t,n);e.push(Q(s,1,r))}}function pc(e){const t=[0];return mc(t,e.length-1),t}function xc(e,t){return e.map(s=>s*t)}function gc(e,t){return e.map(()=>t||Ur).splice(0,e.length-1)}function Dt({duration:e=300,keyframes:t,times:s,ease:n="easeInOut"}){const r=dc(n)?n.map(Ln):Ln(n),o={done:!1,value:t[0]},a=xc(s&&s.length===t.length?s:pc(t),e),l=fc(a,t,{ease:Array.isArray(r)?r:gc(t,r)});return{calculatedDuration:e,next:c=>(o.value=l(c),o.done=c>=e,o)}}const yc=e=>{const t=({timestamp:s})=>e(s);return{start:()=>J.update(t,!0),stop:()=>Ee(t),now:()=>le.isProcessing?le.timestamp:Se.now()}},vc={decay:In,inertia:In,tween:Dt,keyframes:Dt,spring:zr},bc=e=>e/100;class ln extends Fr{constructor(t){super(t),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:c}=this.options;c&&c()};const{name:s,motionValue:n,element:r,keyframes:o}=this.options,a=(r==null?void 0:r.KeyframeResolver)||an,l=(c,d)=>this.onKeyframesResolved(c,d);this.resolver=new a(o,l,s,n,r),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(t){const{type:s="keyframes",repeat:n=0,repeatDelay:r=0,repeatType:o,velocity:a=0}=this.options,l=Ys(s)?s:vc[s]||Dt;let c,d;l!==Dt&&typeof t[0]!="number"&&(c=xt(bc,Br(t[0],t[1])),t=[0,100]);const u=l({...this.options,keyframes:t});o==="mirror"&&(d=l({...this.options,keyframes:[...t].reverse(),velocity:-a})),u.calculatedDuration===null&&(u.calculatedDuration=ar(u));const{calculatedDuration:h}=u,f=h+r,p=f*(n+1)-r;return{generator:u,mirroredGenerator:d,mapPercentToKeyframes:c,calculatedDuration:h,resolvedDuration:f,totalDuration:p}}onPostResolved(){const{autoplay:t=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!t?this.pause():this.state=this.pendingPlayState}tick(t,s=!1){const{resolved:n}=this;if(!n){const{keyframes:S}=this.options;return{done:!0,value:S[S.length-1]}}const{finalKeyframe:r,generator:o,mirroredGenerator:a,mapPercentToKeyframes:l,keyframes:c,calculatedDuration:d,totalDuration:u,resolvedDuration:h}=n;if(this.startTime===null)return o.next(0);const{delay:f,repeat:p,repeatType:b,repeatDelay:y,onUpdate:T}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-u/this.speed,this.startTime)),s?this.currentTime=t:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(t-this.startTime)*this.speed;const j=this.currentTime-f*(this.speed>=0?1:-1),g=this.speed>=0?j<0:j>u;this.currentTime=Math.max(j,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=u);let v=this.currentTime,w=o;if(p){const S=Math.min(this.currentTime,u)/h;let L=Math.floor(S),O=S%1;!O&&S>=1&&(O=1),O===1&&L--,L=Math.min(L,p+1),!!(L%2)&&(b==="reverse"?(O=1-O,y&&(O-=y/h)):b==="mirror"&&(w=a)),v=Pe(0,1,O)*h}const x=g?{done:!1,value:c[0]}:w.next(v);l&&(x.value=l(x.value));let{done:P}=x;!g&&d!==null&&(P=this.speed>=0?this.currentTime>=u:this.currentTime<=0);const M=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&P);return M&&r!==void 0&&(x.value=Ht(c,this.options,r)),T&&T(x.value),M&&this.finish(),x}get duration(){const{resolved:t}=this;return t?ke(t.calculatedDuration):0}get time(){return ke(this.currentTime)}set time(t){t=Ce(t),this.currentTime=t,this.holdTime!==null||this.speed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.speed)}get speed(){return this.playbackSpeed}set speed(t){const s=this.playbackSpeed!==t;this.playbackSpeed=t,s&&(this.time=ke(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:t=yc,onPlay:s,startTime:n}=this.options;this.driver||(this.driver=t(o=>this.tick(o))),s&&s();const r=this.driver.now();this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=r):this.startTime=n??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var t;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(t=this.currentTime)!==null&&t!==void 0?t:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:t}=this.options;t&&t()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}}const wc=new Set(["opacity","clipPath","filter","transform"]);function jc(e,t,s,{delay:n=0,duration:r=300,repeat:o=0,repeatType:a="loop",ease:l="easeInOut",times:c}={}){const d={[t]:s};c&&(d.offset=c);const u=cr(l,r);return Array.isArray(u)&&(d.easing=u),e.animate(d,{delay:n,duration:r,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:o+1,direction:a==="reverse"?"alternate":"normal"})}const Nc=Ds(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Vt=10,Sc=2e4;function Tc(e){return Ys(e.type)||e.type==="spring"||!lr(e.ease)}function Cc(e,t){const s=new ln({...t,keyframes:e,repeat:0,delay:0,isGenerator:!0});let n={done:!1,value:e[0]};const r=[];let o=0;for(;!n.done&&o<Sc;)n=s.sample(o),r.push(n.value),o+=Vt;return{times:void 0,keyframes:r,duration:o-Vt,ease:"linear"}}const Hr={anticipate:wr,backInOut:br,circInOut:Nr};function kc(e){return e in Hr}class Fn extends Fr{constructor(t){super(t);const{name:s,motionValue:n,element:r,keyframes:o}=this.options;this.resolver=new Lr(o,(a,l)=>this.onKeyframesResolved(a,l),s,n,r),this.resolver.scheduleResolve()}initPlayback(t,s){let{duration:n=300,times:r,ease:o,type:a,motionValue:l,name:c,startTime:d}=this.options;if(!l.owner||!l.owner.current)return!1;if(typeof o=="string"&&Et()&&kc(o)&&(o=Hr[o]),Tc(this.options)){const{onComplete:h,onUpdate:f,motionValue:p,element:b,...y}=this.options,T=Cc(t,y);t=T.keyframes,t.length===1&&(t[1]=t[0]),n=T.duration,r=T.times,o=T.ease,a="keyframes"}const u=jc(l.owner.current,c,t,{...this.options,duration:n,times:r,ease:o});return u.startTime=d??this.calcStartTime(),this.pendingTimeline?(jn(u,this.pendingTimeline),this.pendingTimeline=void 0):u.onfinish=()=>{const{onComplete:h}=this.options;l.set(Ht(t,this.options,s)),h&&h(),this.cancel(),this.resolveFinishedPromise()},{animation:u,duration:n,times:r,type:a,ease:o,keyframes:t}}get duration(){const{resolved:t}=this;if(!t)return 0;const{duration:s}=t;return ke(s)}get time(){const{resolved:t}=this;if(!t)return 0;const{animation:s}=t;return ke(s.currentTime||0)}set time(t){const{resolved:s}=this;if(!s)return;const{animation:n}=s;n.currentTime=Ce(t)}get speed(){const{resolved:t}=this;if(!t)return 1;const{animation:s}=t;return s.playbackRate}set speed(t){const{resolved:s}=this;if(!s)return;const{animation:n}=s;n.playbackRate=t}get state(){const{resolved:t}=this;if(!t)return"idle";const{animation:s}=t;return s.playState}get startTime(){const{resolved:t}=this;if(!t)return null;const{animation:s}=t;return s.startTime}attachTimeline(t){if(!this._resolved)this.pendingTimeline=t;else{const{resolved:s}=this;if(!s)return pe;const{animation:n}=s;jn(n,t)}return pe}play(){if(this.isStopped)return;const{resolved:t}=this;if(!t)return;const{animation:s}=t;s.playState==="finished"&&this.updateFinishedPromise(),s.play()}pause(){const{resolved:t}=this;if(!t)return;const{animation:s}=t;s.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:t}=this;if(!t)return;const{animation:s,keyframes:n,duration:r,type:o,ease:a,times:l}=t;if(s.playState==="idle"||s.playState==="finished")return;if(this.time){const{motionValue:d,onUpdate:u,onComplete:h,element:f,...p}=this.options,b=new ln({...p,keyframes:n,duration:r,type:o,ease:a,times:l,isGenerator:!0}),y=Ce(this.time);d.setWithVelocity(b.sample(y-Vt).value,b.sample(y).value,Vt)}const{onStop:c}=this.options;c&&c(),this.cancel()}complete(){const{resolved:t}=this;t&&t.animation.finish()}cancel(){const{resolved:t}=this;t&&t.animation.cancel()}static supports(t){const{motionValue:s,name:n,repeatDelay:r,repeatType:o,damping:a,type:l}=t;if(!s||!s.owner||!(s.owner.current instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:d}=s.owner.getProps();return Nc()&&n&&wc.has(n)&&!c&&!d&&!r&&o!=="mirror"&&a!==0&&l!=="inertia"}}const Pc={type:"spring",stiffness:500,damping:25,restSpeed:10},Ac=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),_c={type:"keyframes",duration:.8},Ec={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Mc=(e,{keyframes:t})=>t.length>2?_c:Be.has(e)?e.startsWith("scale")?Ac(t[1]):Pc:Ec;function Dc({when:e,delay:t,delayChildren:s,staggerChildren:n,staggerDirection:r,repeat:o,repeatType:a,repeatDelay:l,from:c,elapsed:d,...u}){return!!Object.keys(u).length}const cn=(e,t,s,n={},r,o)=>a=>{const l=Gs(n,e)||{},c=l.delay||n.delay||0;let{elapsed:d=0}=n;d=d-Ce(c);let u={keyframes:Array.isArray(s)?s:[null,s],ease:"easeOut",velocity:t.getVelocity(),...l,delay:-d,onUpdate:f=>{t.set(f),l.onUpdate&&l.onUpdate(f)},onComplete:()=>{a(),l.onComplete&&l.onComplete()},name:e,motionValue:t,element:o?void 0:r};Dc(l)||(u={...u,...Mc(e,u)}),u.duration&&(u.duration=Ce(u.duration)),u.repeatDelay&&(u.repeatDelay=Ce(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let h=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(u.duration=0,u.delay===0&&(h=!0)),h&&!o&&t.get()!==void 0){const f=Ht(u.keyframes,l);if(f!==void 0)return J.update(()=>{u.onUpdate(f),u.onComplete()}),new Zo([])}return!o&&Fn.supports(u)?new Fn(u):new ln(u)};function Vc({protectedKeys:e,needsAnimating:t},s){const n=e.hasOwnProperty(s)&&t[s]!==!0;return t[s]=!1,n}function Kr(e,t,{delay:s=0,transitionOverride:n,type:r}={}){var o;let{transition:a=e.getDefaultTransition(),transitionEnd:l,...c}=t;n&&(a=n);const d=[],u=r&&e.animationState&&e.animationState.getState()[r];for(const h in c){const f=e.getValue(h,(o=e.latestValues[h])!==null&&o!==void 0?o:null),p=c[h];if(p===void 0||u&&Vc(u,h))continue;const b={delay:s,...Gs(a||{},h)};let y=!1;if(window.MotionHandoffAnimation){const j=pr(e);if(j){const g=window.MotionHandoffAnimation(j,h,J);g!==null&&(b.startTime=g,y=!0)}}us(e,h),f.start(cn(h,f,p,e.shouldReduceMotion&&fr.has(h)?{type:!1}:b,e,y));const T=f.animation;T&&d.push(T)}return l&&Promise.all(d).then(()=>{J.update(()=>{l&&hl(e,l)})}),d}function ys(e,t,s={}){var n;const r=Ut(e,t,s.type==="exit"?(n=e.presenceContext)===null||n===void 0?void 0:n.custom:void 0);let{transition:o=e.getDefaultTransition()||{}}=r||{};s.transitionOverride&&(o=s.transitionOverride);const a=r?()=>Promise.all(Kr(e,r,s)):()=>Promise.resolve(),l=e.variantChildren&&e.variantChildren.size?(d=0)=>{const{delayChildren:u=0,staggerChildren:h,staggerDirection:f}=o;return Rc(e,t,u+d,h,f,s)}:()=>Promise.resolve(),{when:c}=o;if(c){const[d,u]=c==="beforeChildren"?[a,l]:[l,a];return d().then(()=>u())}else return Promise.all([a(),l(s.delay)])}function Rc(e,t,s=0,n=0,r=1,o){const a=[],l=(e.variantChildren.size-1)*n,c=r===1?(d=0)=>d*n:(d=0)=>l-d*n;return Array.from(e.variantChildren).sort(Ic).forEach((d,u)=>{d.notify("AnimationStart",t),a.push(ys(d,t,{...o,delay:s+c(u)}).then(()=>d.notify("AnimationComplete",t)))}),Promise.all(a)}function Ic(e,t){return e.sortNodePosition(t)}function Lc(e,t,s={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const r=t.map(o=>ys(e,o,s));n=Promise.all(r)}else if(typeof t=="string")n=ys(e,t,s);else{const r=typeof t=="function"?Ut(e,t,s.custom):t;n=Promise.all(Kr(e,r,s))}return n.then(()=>{e.notify("AnimationComplete",t)})}const Fc=Rs.length;function Wr(e){if(!e)return;if(!e.isControllingVariants){const s=e.parent?Wr(e.parent)||{}:{};return e.props.initial!==void 0&&(s.initial=e.props.initial),s}const t={};for(let s=0;s<Fc;s++){const n=Rs[s],r=e.props[n];(ct(r)||r===!1)&&(t[n]=r)}return t}const Oc=[...Vs].reverse(),Bc=Vs.length;function $c(e){return t=>Promise.all(t.map(({animation:s,options:n})=>Lc(e,s,n)))}function zc(e){let t=$c(e),s=On(),n=!0;const r=c=>(d,u)=>{var h;const f=Ut(e,u,c==="exit"?(h=e.presenceContext)===null||h===void 0?void 0:h.custom:void 0);if(f){const{transition:p,transitionEnd:b,...y}=f;d={...d,...y,...b}}return d};function o(c){t=c(e)}function a(c){const{props:d}=e,u=Wr(e.parent)||{},h=[],f=new Set;let p={},b=1/0;for(let T=0;T<Bc;T++){const j=Oc[T],g=s[j],v=d[j]!==void 0?d[j]:u[j],w=ct(v),x=j===c?g.isActive:null;x===!1&&(b=T);let P=v===u[j]&&v!==d[j]&&w;if(P&&n&&e.manuallyAnimateOnMount&&(P=!1),g.protectedKeys={...p},!g.isActive&&x===null||!v&&!g.prevProp||$t(v)||typeof v=="boolean")continue;const M=Uc(g.prevProp,v);let S=M||j===c&&g.isActive&&!P&&w||T>b&&w,L=!1;const O=Array.isArray(v)?v:[v];let D=O.reduce(r(j),{});x===!1&&(D={});const{prevResolvedValues:B={}}=g,X={...B,...D},ne=U=>{S=!0,f.has(U)&&(L=!0,f.delete(U)),g.needsAnimating[U]=!0;const te=e.getValue(U);te&&(te.liveStyle=!1)};for(const U in X){const te=D[U],ge=B[U];if(p.hasOwnProperty(U))continue;let je=!1;ls(te)&&ls(ge)?je=!rr(te,ge):je=te!==ge,je?te!=null?ne(U):f.add(U):te!==void 0&&f.has(U)?ne(U):g.protectedKeys[U]=!0}g.prevProp=v,g.prevResolvedValues=D,g.isActive&&(p={...p,...D}),n&&e.blockInitialAnimation&&(S=!1),S&&(!(P&&M)||L)&&h.push(...O.map(U=>({animation:U,options:{type:j}})))}if(f.size){const T={};f.forEach(j=>{const g=e.getBaseTarget(j),v=e.getValue(j);v&&(v.liveStyle=!0),T[j]=g??null}),h.push({animation:T})}let y=!!h.length;return n&&(d.initial===!1||d.initial===d.animate)&&!e.manuallyAnimateOnMount&&(y=!1),n=!1,y?t(h):Promise.resolve()}function l(c,d){var u;if(s[c].isActive===d)return Promise.resolve();(u=e.variantChildren)===null||u===void 0||u.forEach(f=>{var p;return(p=f.animationState)===null||p===void 0?void 0:p.setActive(c,d)}),s[c].isActive=d;const h=a(c);for(const f in s)s[f].protectedKeys={};return h}return{animateChanges:a,setActive:l,setAnimateFunction:o,getState:()=>s,reset:()=>{s=On(),n=!0}}}function Uc(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!rr(t,e):!1}function Ve(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function On(){return{animate:Ve(!0),whileInView:Ve(),whileHover:Ve(),whileTap:Ve(),whileDrag:Ve(),whileFocus:Ve(),exit:Ve()}}class De{constructor(t){this.isMounted=!1,this.node=t}update(){}}class Hc extends De{constructor(t){super(t),t.animationState||(t.animationState=zc(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();$t(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:s}=this.node.prevProps||{};t!==s&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)===null||t===void 0||t.call(this)}}let Kc=0;class Wc extends De{constructor(){super(...arguments),this.id=Kc++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:s}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===n)return;const r=this.node.animationState.setActive("exit",!t);s&&!t&&r.then(()=>s(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const Gc={animation:{Feature:Hc},exit:{Feature:Wc}};function ft(e,t,s,n={passive:!0}){return e.addEventListener(t,s,n),()=>e.removeEventListener(t,s)}function gt(e){return{point:{x:e.pageX,y:e.pageY}}}const Yc=e=>t=>qs(t)&&e(t,gt(t));function rt(e,t,s,n){return ft(e,t,Yc(s),n)}const Bn=(e,t)=>Math.abs(e-t);function Xc(e,t){const s=Bn(e.x,t.x),n=Bn(e.y,t.y);return Math.sqrt(s**2+n**2)}class Gr{constructor(t,s,{transformPagePoint:n,contextWindow:r,dragSnapToOrigin:o=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=ts(this.lastMoveEventInfo,this.history),f=this.startEvent!==null,p=Xc(h.offset,{x:0,y:0})>=3;if(!f&&!p)return;const{point:b}=h,{timestamp:y}=le;this.history.push({...b,timestamp:y});const{onStart:T,onMove:j}=this.handlers;f||(T&&T(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),j&&j(this.lastMoveEvent,h)},this.handlePointerMove=(h,f)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=es(f,this.transformPagePoint),J.update(this.updatePoint,!0)},this.handlePointerUp=(h,f)=>{this.end();const{onEnd:p,onSessionEnd:b,resumeAnimation:y}=this.handlers;if(this.dragSnapToOrigin&&y&&y(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const T=ts(h.type==="pointercancel"?this.lastMoveEventInfo:es(f,this.transformPagePoint),this.history);this.startEvent&&p&&p(h,T),b&&b(h,T)},!qs(t))return;this.dragSnapToOrigin=o,this.handlers=s,this.transformPagePoint=n,this.contextWindow=r||window;const a=gt(t),l=es(a,this.transformPagePoint),{point:c}=l,{timestamp:d}=le;this.history=[{...c,timestamp:d}];const{onSessionStart:u}=s;u&&u(t,ts(l,this.history)),this.removeListeners=xt(rt(this.contextWindow,"pointermove",this.handlePointerMove),rt(this.contextWindow,"pointerup",this.handlePointerUp),rt(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Ee(this.updatePoint)}}function es(e,t){return t?{point:t(e.point)}:e}function $n(e,t){return{x:e.x-t.x,y:e.y-t.y}}function ts({point:e},t){return{point:e,delta:$n(e,Yr(t)),offset:$n(e,qc(t)),velocity:Jc(t,.1)}}function qc(e){return e[0]}function Yr(e){return e[e.length-1]}function Jc(e,t){if(e.length<2)return{x:0,y:0};let s=e.length-1,n=null;const r=Yr(e);for(;s>=0&&(n=e[s],!(r.timestamp-n.timestamp>Ce(t)));)s--;if(!n)return{x:0,y:0};const o=ke(r.timestamp-n.timestamp);if(o===0)return{x:0,y:0};const a={x:(r.x-n.x)/o,y:(r.y-n.y)/o};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}const Xr=1e-4,Zc=1-Xr,Qc=1+Xr,qr=.01,ed=0-qr,td=0+qr;function xe(e){return e.max-e.min}function sd(e,t,s){return Math.abs(e-t)<=s}function zn(e,t,s,n=.5){e.origin=n,e.originPoint=Q(t.min,t.max,e.origin),e.scale=xe(s)/xe(t),e.translate=Q(s.min,s.max,e.origin)-e.originPoint,(e.scale>=Zc&&e.scale<=Qc||isNaN(e.scale))&&(e.scale=1),(e.translate>=ed&&e.translate<=td||isNaN(e.translate))&&(e.translate=0)}function at(e,t,s,n){zn(e.x,t.x,s.x,n?n.originX:void 0),zn(e.y,t.y,s.y,n?n.originY:void 0)}function Un(e,t,s){e.min=s.min+t.min,e.max=e.min+xe(t)}function nd(e,t,s){Un(e.x,t.x,s.x),Un(e.y,t.y,s.y)}function Hn(e,t,s){e.min=t.min-s.min,e.max=e.min+xe(t)}function ot(e,t,s){Hn(e.x,t.x,s.x),Hn(e.y,t.y,s.y)}function id(e,{min:t,max:s},n){return t!==void 0&&e<t?e=n?Q(t,e,n.min):Math.max(e,t):s!==void 0&&e>s&&(e=n?Q(s,e,n.max):Math.min(e,s)),e}function Kn(e,t,s){return{min:t!==void 0?e.min+t:void 0,max:s!==void 0?e.max+s-(e.max-e.min):void 0}}function rd(e,{top:t,left:s,bottom:n,right:r}){return{x:Kn(e.x,s,r),y:Kn(e.y,t,n)}}function Wn(e,t){let s=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([s,n]=[n,s]),{min:s,max:n}}function ad(e,t){return{x:Wn(e.x,t.x),y:Wn(e.y,t.y)}}function od(e,t){let s=.5;const n=xe(e),r=xe(t);return r>n?s=Ye(t.min,t.max-n,e.min):n>r&&(s=Ye(e.min,e.max-r,t.min)),Pe(0,1,s)}function ld(e,t){const s={};return t.min!==void 0&&(s.min=t.min-e.min),t.max!==void 0&&(s.max=t.max-e.min),s}const vs=.35;function cd(e=vs){return e===!1?e=0:e===!0&&(e=vs),{x:Gn(e,"left","right"),y:Gn(e,"top","bottom")}}function Gn(e,t,s){return{min:Yn(e,t),max:Yn(e,s)}}function Yn(e,t){return typeof e=="number"?e:e[t]||0}const Xn=()=>({translate:0,scale:1,origin:0,originPoint:0}),He=()=>({x:Xn(),y:Xn()}),qn=()=>({min:0,max:0}),se=()=>({x:qn(),y:qn()});function ve(e){return[e("x"),e("y")]}function Jr({top:e,left:t,right:s,bottom:n}){return{x:{min:t,max:s},y:{min:e,max:n}}}function dd({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function ud(e,t){if(!t)return e;const s=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:s.y,left:s.x,bottom:n.y,right:n.x}}function ss(e){return e===void 0||e===1}function bs({scale:e,scaleX:t,scaleY:s}){return!ss(e)||!ss(t)||!ss(s)}function Re(e){return bs(e)||Zr(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function Zr(e){return Jn(e.x)||Jn(e.y)}function Jn(e){return e&&e!=="0%"}function Rt(e,t,s){const n=e-s,r=t*n;return s+r}function Zn(e,t,s,n,r){return r!==void 0&&(e=Rt(e,r,n)),Rt(e,s,n)+t}function ws(e,t=0,s=1,n,r){e.min=Zn(e.min,t,s,n,r),e.max=Zn(e.max,t,s,n,r)}function Qr(e,{x:t,y:s}){ws(e.x,t.translate,t.scale,t.originPoint),ws(e.y,s.translate,s.scale,s.originPoint)}const Qn=.999999999999,ei=1.0000000000001;function hd(e,t,s,n=!1){const r=s.length;if(!r)return;t.x=t.y=1;let o,a;for(let l=0;l<r;l++){o=s[l],a=o.projectionDelta;const{visualElement:c}=o.options;c&&c.props.style&&c.props.style.display==="contents"||(n&&o.options.layoutScroll&&o.scroll&&o!==o.root&&We(e,{x:-o.scroll.offset.x,y:-o.scroll.offset.y}),a&&(t.x*=a.x.scale,t.y*=a.y.scale,Qr(e,a)),n&&Re(o.latestValues)&&We(e,o.latestValues))}t.x<ei&&t.x>Qn&&(t.x=1),t.y<ei&&t.y>Qn&&(t.y=1)}function Ke(e,t){e.min=e.min+t,e.max=e.max+t}function ti(e,t,s,n,r=.5){const o=Q(e.min,e.max,r);ws(e,t,s,o,n)}function We(e,t){ti(e.x,t.x,t.scaleX,t.scale,t.originX),ti(e.y,t.y,t.scaleY,t.scale,t.originY)}function ea(e,t){return Jr(ud(e.getBoundingClientRect(),t))}function fd(e,t,s){const n=ea(e,s),{scroll:r}=t;return r&&(Ke(n.x,r.offset.x),Ke(n.y,r.offset.y)),n}const ta=({current:e})=>e?e.ownerDocument.defaultView:null,md=new WeakMap;class pd{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=se(),this.visualElement=t}start(t,{snapToCursor:s=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const r=u=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),s&&this.snapToCursor(gt(u).point)},o=(u,h)=>{const{drag:f,dragPropagation:p,onDragStart:b}=this.getProps();if(f&&!p&&(this.openDragLock&&this.openDragLock(),this.openDragLock=ol(f),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),ve(T=>{let j=this.getAxisMotionValue(T).get()||0;if(Ne.test(j)){const{projection:g}=this.visualElement;if(g&&g.layout){const v=g.layout.layoutBox[T];v&&(j=xe(v)*(parseFloat(j)/100))}}this.originPoint[T]=j}),b&&J.postRender(()=>b(u,h)),us(this.visualElement,"transform");const{animationState:y}=this.visualElement;y&&y.setActive("whileDrag",!0)},a=(u,h)=>{const{dragPropagation:f,dragDirectionLock:p,onDirectionLock:b,onDrag:y}=this.getProps();if(!f&&!this.openDragLock)return;const{offset:T}=h;if(p&&this.currentDirection===null){this.currentDirection=xd(T),this.currentDirection!==null&&b&&b(this.currentDirection);return}this.updateAxis("x",h.point,T),this.updateAxis("y",h.point,T),this.visualElement.render(),y&&y(u,h)},l=(u,h)=>this.stop(u,h),c=()=>ve(u=>{var h;return this.getAnimationState(u)==="paused"&&((h=this.getAxisMotionValue(u).animation)===null||h===void 0?void 0:h.play())}),{dragSnapToOrigin:d}=this.getProps();this.panSession=new Gr(t,{onSessionStart:r,onStart:o,onMove:a,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,contextWindow:ta(this.visualElement)})}stop(t,s){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:r}=s;this.startAnimation(r);const{onDragEnd:o}=this.getProps();o&&J.postRender(()=>o(t,s))}cancel(){this.isDragging=!1;const{projection:t,animationState:s}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),s&&s.setActive("whileDrag",!1)}updateAxis(t,s,n){const{drag:r}=this.getProps();if(!n||!jt(t,r,this.currentDirection))return;const o=this.getAxisMotionValue(t);let a=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(a=id(a,this.constraints[t],this.elastic[t])),o.set(a)}resolveConstraints(){var t;const{dragConstraints:s,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,o=this.constraints;s&&ze(s)?this.constraints||(this.constraints=this.resolveRefConstraints()):s&&r?this.constraints=rd(r.layoutBox,s):this.constraints=!1,this.elastic=cd(n),o!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&ve(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=ld(r.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:s}=this.getProps();if(!t||!ze(t))return!1;const n=t.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const o=fd(n,r.root,this.visualElement.getTransformPagePoint());let a=ad(r.layout.layoutBox,o);if(s){const l=s(dd(a));this.hasMutatedConstraints=!!l,l&&(a=Jr(l))}return a}startAnimation(t){const{drag:s,dragMomentum:n,dragElastic:r,dragTransition:o,dragSnapToOrigin:a,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},d=ve(u=>{if(!jt(u,s,this.currentDirection))return;let h=c&&c[u]||{};a&&(h={min:0,max:0});const f=r?200:1e6,p=r?40:1e7,b={type:"inertia",velocity:n?t[u]:0,bounceStiffness:f,bounceDamping:p,timeConstant:750,restDelta:1,restSpeed:10,...o,...h};return this.startAxisValueAnimation(u,b)});return Promise.all(d).then(l)}startAxisValueAnimation(t,s){const n=this.getAxisMotionValue(t);return us(this.visualElement,t),n.start(cn(t,n,0,s,this.visualElement,!1))}stopAnimation(){ve(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){ve(t=>{var s;return(s=this.getAxisMotionValue(t).animation)===null||s===void 0?void 0:s.pause()})}getAnimationState(t){var s;return(s=this.getAxisMotionValue(t).animation)===null||s===void 0?void 0:s.state}getAxisMotionValue(t){const s=`_drag${t.toUpperCase()}`,n=this.visualElement.getProps(),r=n[s];return r||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){ve(s=>{const{drag:n}=this.getProps();if(!jt(s,n,this.currentDirection))return;const{projection:r}=this.visualElement,o=this.getAxisMotionValue(s);if(r&&r.layout){const{min:a,max:l}=r.layout.layoutBox[s];o.set(t[s]-Q(a,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:s}=this.getProps(),{projection:n}=this.visualElement;if(!ze(s)||!n||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};ve(a=>{const l=this.getAxisMotionValue(a);if(l&&this.constraints!==!1){const c=l.get();r[a]=od({min:c,max:c},this.constraints[a])}});const{transformTemplate:o}=this.visualElement.getProps();this.visualElement.current.style.transform=o?o({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),ve(a=>{if(!jt(a,t,null))return;const l=this.getAxisMotionValue(a),{min:c,max:d}=this.constraints[a];l.set(Q(c,d,r[a]))})}addListeners(){if(!this.visualElement.current)return;md.set(this.visualElement,this);const t=this.visualElement.current,s=rt(t,"pointerdown",c=>{const{drag:d,dragListener:u=!0}=this.getProps();d&&u&&this.start(c)}),n=()=>{const{dragConstraints:c}=this.getProps();ze(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,o=r.addEventListener("measure",n);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),J.read(n);const a=ft(window,"resize",()=>this.scalePositionWithinConstraints()),l=r.addEventListener("didUpdate",(({delta:c,hasLayoutChanged:d})=>{this.isDragging&&d&&(ve(u=>{const h=this.getAxisMotionValue(u);h&&(this.originPoint[u]+=c[u].translate,h.set(h.get()+c[u].translate))}),this.visualElement.render())}));return()=>{a(),s(),o(),l&&l()}}getProps(){const t=this.visualElement.getProps(),{drag:s=!1,dragDirectionLock:n=!1,dragPropagation:r=!1,dragConstraints:o=!1,dragElastic:a=vs,dragMomentum:l=!0}=t;return{...t,drag:s,dragDirectionLock:n,dragPropagation:r,dragConstraints:o,dragElastic:a,dragMomentum:l}}}function jt(e,t,s){return(t===!0||t===e)&&(s===null||s===e)}function xd(e,t=10){let s=null;return Math.abs(e.y)>t?s="y":Math.abs(e.x)>t&&(s="x"),s}class gd extends De{constructor(t){super(t),this.removeGroupControls=pe,this.removeListeners=pe,this.controls=new pd(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||pe}unmount(){this.removeGroupControls(),this.removeListeners()}}const si=e=>(t,s)=>{e&&J.postRender(()=>e(t,s))};class yd extends De{constructor(){super(...arguments),this.removePointerDownListener=pe}onPointerDown(t){this.session=new Gr(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:ta(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:s,onPan:n,onPanEnd:r}=this.node.getProps();return{onSessionStart:si(t),onStart:si(s),onMove:n,onEnd:(o,a)=>{delete this.session,r&&J.postRender(()=>r(o,a))}}}mount(){this.removePointerDownListener=rt(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Tt={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function ni(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const et={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(I.test(e))e=parseFloat(e);else return e;const s=ni(e,t.target.x),n=ni(e,t.target.y);return`${s}% ${n}%`}},vd={correct:(e,{treeScale:t,projectionDelta:s})=>{const n=e,r=Me.parse(e);if(r.length>5)return n;const o=Me.createTransformer(e),a=typeof r[0]!="number"?1:0,l=s.x.scale*t.x,c=s.y.scale*t.y;r[0+a]/=l,r[1+a]/=c;const d=Q(l,c,.5);return typeof r[2+a]=="number"&&(r[2+a]/=d),typeof r[3+a]=="number"&&(r[3+a]/=d),o(r)}};class bd extends m.Component{componentDidMount(){const{visualElement:t,layoutGroup:s,switchLayoutGroup:n,layoutId:r}=this.props,{projection:o}=t;Bo(wd),o&&(s.group&&s.group.add(o),n&&n.register&&r&&n.register(o),o.root.didUpdate(),o.addEventListener("animationComplete",()=>{this.safeToRemove()}),o.setOptions({...o.options,onExitComplete:()=>this.safeToRemove()})),Tt.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:s,visualElement:n,drag:r,isPresent:o}=this.props,a=n.projection;return a&&(a.isPresent=o,r||t.layoutDependency!==s||s===void 0?a.willUpdate():this.safeToRemove(),t.isPresent!==o&&(o?a.promote():a.relegate()||J.postRender(()=>{const l=a.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),Ls.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:s,switchLayoutGroup:n}=this.props,{projection:r}=t;r&&(r.scheduleCheckAfterUnmount(),s&&s.group&&s.group.remove(r),n&&n.deregister&&n.deregister(r))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function sa(e){const[t,s]=Fi(),n=m.useContext(As);return i.jsx(bd,{...e,layoutGroup:n,switchLayoutGroup:m.useContext(Wi),isPresent:t,safeToRemove:s})}const wd={borderRadius:{...et,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:et,borderTopRightRadius:et,borderBottomLeftRadius:et,borderBottomRightRadius:et,boxShadow:vd};function jd(e,t,s){const n=ue(e)?e:ut(e);return n.start(cn("",n,t,s)),n.animation}function Nd(e){return e instanceof SVGElement&&e.tagName!=="svg"}const Sd=(e,t)=>e.depth-t.depth;class Td{constructor(){this.children=[],this.isDirty=!1}add(t){Js(this.children,t),this.isDirty=!0}remove(t){Zs(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(Sd),this.isDirty=!1,this.children.forEach(t)}}function Cd(e,t){const s=Se.now(),n=({timestamp:r})=>{const o=r-s;o>=t&&(Ee(n),e(o-t))};return J.read(n,!0),()=>Ee(n)}const na=["TopLeft","TopRight","BottomLeft","BottomRight"],kd=na.length,ii=e=>typeof e=="string"?parseFloat(e):e,ri=e=>typeof e=="number"||I.test(e);function Pd(e,t,s,n,r,o){r?(e.opacity=Q(0,s.opacity!==void 0?s.opacity:1,Ad(n)),e.opacityExit=Q(t.opacity!==void 0?t.opacity:1,0,_d(n))):o&&(e.opacity=Q(t.opacity!==void 0?t.opacity:1,s.opacity!==void 0?s.opacity:1,n));for(let a=0;a<kd;a++){const l=`border${na[a]}Radius`;let c=ai(t,l),d=ai(s,l);if(c===void 0&&d===void 0)continue;c||(c=0),d||(d=0),c===0||d===0||ri(c)===ri(d)?(e[l]=Math.max(Q(ii(c),ii(d),n),0),(Ne.test(d)||Ne.test(c))&&(e[l]+="%")):e[l]=d}(t.rotate||s.rotate)&&(e.rotate=Q(t.rotate||0,s.rotate||0,n))}function ai(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const Ad=ia(0,.5,jr),_d=ia(.5,.95,pe);function ia(e,t,s){return n=>n<e?0:n>t?1:s(Ye(e,t,n))}function oi(e,t){e.min=t.min,e.max=t.max}function ye(e,t){oi(e.x,t.x),oi(e.y,t.y)}function li(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function ci(e,t,s,n,r){return e-=t,e=Rt(e,1/s,n),r!==void 0&&(e=Rt(e,1/r,n)),e}function Ed(e,t=0,s=1,n=.5,r,o=e,a=e){if(Ne.test(t)&&(t=parseFloat(t),t=Q(a.min,a.max,t/100)-a.min),typeof t!="number")return;let l=Q(o.min,o.max,n);e===o&&(l-=t),e.min=ci(e.min,t,s,l,r),e.max=ci(e.max,t,s,l,r)}function di(e,t,[s,n,r],o,a){Ed(e,t[s],t[n],t[r],t.scale,o,a)}const Md=["x","scaleX","originX"],Dd=["y","scaleY","originY"];function ui(e,t,s,n){di(e.x,t,Md,s?s.x:void 0,n?n.x:void 0),di(e.y,t,Dd,s?s.y:void 0,n?n.y:void 0)}function hi(e){return e.translate===0&&e.scale===1}function ra(e){return hi(e.x)&&hi(e.y)}function fi(e,t){return e.min===t.min&&e.max===t.max}function Vd(e,t){return fi(e.x,t.x)&&fi(e.y,t.y)}function mi(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function aa(e,t){return mi(e.x,t.x)&&mi(e.y,t.y)}function pi(e){return xe(e.x)/xe(e.y)}function xi(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class Rd{constructor(){this.members=[]}add(t){Js(this.members,t),t.scheduleRender()}remove(t){if(Zs(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const s=this.members[this.members.length-1];s&&this.promote(s)}}relegate(t){const s=this.members.findIndex(r=>t===r);if(s===0)return!1;let n;for(let r=s;r>=0;r--){const o=this.members[r];if(o.isPresent!==!1){n=o;break}}return n?(this.promote(n),!0):!1}promote(t,s){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,s&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:r}=t.options;r===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:s,resumingFrom:n}=t;s.onExitComplete&&s.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Id(e,t,s){let n="";const r=e.x.translate/t.x,o=e.y.translate/t.y,a=(s==null?void 0:s.z)||0;if((r||o||a)&&(n=`translate3d(${r}px, ${o}px, ${a}px) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),s){const{transformPerspective:d,rotate:u,rotateX:h,rotateY:f,skewX:p,skewY:b}=s;d&&(n=`perspective(${d}px) ${n}`),u&&(n+=`rotate(${u}deg) `),h&&(n+=`rotateX(${h}deg) `),f&&(n+=`rotateY(${f}deg) `),p&&(n+=`skewX(${p}deg) `),b&&(n+=`skewY(${b}deg) `)}const l=e.x.scale*t.x,c=e.y.scale*t.y;return(l!==1||c!==1)&&(n+=`scale(${l}, ${c})`),n||"none"}const Ie={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},nt=typeof window<"u"&&window.MotionDebug!==void 0,ns=["","X","Y","Z"],Ld={visibility:"hidden"},gi=1e3;let Fd=0;function is(e,t,s,n){const{latestValues:r}=t;r[e]&&(s[e]=r[e],t.setStaticValue(e,0),n&&(n[e]=0))}function oa(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const s=pr(t);if(window.MotionHasOptimisedAnimation(s,"transform")){const{layout:r,layoutId:o}=e.options;window.MotionCancelOptimisedAnimation(s,"transform",J,!(r||o))}const{parent:n}=e;n&&!n.hasCheckedOptimisedAppear&&oa(n)}function la({attachResizeListener:e,defaultParent:t,measureScroll:s,checkIsScrollRoot:n,resetTransform:r}){return class{constructor(a={},l=t==null?void 0:t()){this.id=Fd++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,nt&&(Ie.totalNodes=Ie.resolvedTargetDeltas=Ie.recalculatedProjection=0),this.nodes.forEach($d),this.nodes.forEach(Wd),this.nodes.forEach(Gd),this.nodes.forEach(zd),nt&&window.MotionDebug.record(Ie)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new Td)}addEventListener(a,l){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new Qs),this.eventHandlers.get(a).add(l)}notifyListeners(a,...l){const c=this.eventHandlers.get(a);c&&c.notify(...l)}hasListeners(a){return this.eventHandlers.has(a)}mount(a,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=Nd(a),this.instance=a;const{layoutId:c,layout:d,visualElement:u}=this.options;if(u&&!u.current&&u.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(d||c)&&(this.isLayoutDirty=!0),e){let h;const f=()=>this.root.updateBlockedByResize=!1;e(a,()=>{this.root.updateBlockedByResize=!0,h&&h(),h=Cd(f,250),Tt.hasAnimatedSinceResize&&(Tt.hasAnimatedSinceResize=!1,this.nodes.forEach(vi))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&u&&(c||d)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:f,hasRelativeTargetChanged:p,layout:b})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const y=this.options.transition||u.getDefaultTransition()||Zd,{onLayoutAnimationStart:T,onLayoutAnimationComplete:j}=u.getProps(),g=!this.targetLayout||!aa(this.targetLayout,b)||p,v=!f&&p;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||v||f&&(g||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(h,v);const w={...Gs(y,"layout"),onPlay:T,onComplete:j};(u.shouldReduceMotion||this.options.layoutRoot)&&(w.delay=0,w.type=!1),this.startAnimation(w)}else f||vi(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=b})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Ee(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Yd),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&oa(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const h=this.path[u];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(yi);return}this.isUpdating||this.nodes.forEach(Hd),this.isUpdating=!1,this.nodes.forEach(Kd),this.nodes.forEach(Od),this.nodes.forEach(Bd),this.clearAllSnapshots();const l=Se.now();le.delta=Pe(0,1e3/60,l-le.timestamp),le.timestamp=l,le.isProcessing=!0,Yt.update.process(le),Yt.preRender.process(le),Yt.render.process(le),le.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Ls.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Ud),this.sharedNodes.forEach(Xd)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,J.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){J.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=se(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(l=!1),l){const c=n(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:c,offset:s(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!r)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!ra(this.projectionDelta),c=this.getTransformTemplate(),d=c?c(this.latestValues,""):void 0,u=d!==this.prevTransformTemplateValue;a&&(l||Re(this.latestValues)||u)&&(r(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return a&&(c=this.removeTransform(c)),Qd(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){var a;const{visualElement:l}=this.options;if(!l)return se();const c=l.measureViewportBox();if(!(((a=this.scroll)===null||a===void 0?void 0:a.wasRoot)||this.path.some(eu))){const{scroll:u}=this.root;u&&(Ke(c.x,u.offset.x),Ke(c.y,u.offset.y))}return c}removeElementScroll(a){var l;const c=se();if(ye(c,a),!((l=this.scroll)===null||l===void 0)&&l.wasRoot)return c;for(let d=0;d<this.path.length;d++){const u=this.path[d],{scroll:h,options:f}=u;u!==this.root&&h&&f.layoutScroll&&(h.wasRoot&&ye(c,a),Ke(c.x,h.offset.x),Ke(c.y,h.offset.y))}return c}applyTransform(a,l=!1){const c=se();ye(c,a);for(let d=0;d<this.path.length;d++){const u=this.path[d];!l&&u.options.layoutScroll&&u.scroll&&u!==u.root&&We(c,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),Re(u.latestValues)&&We(c,u.latestValues)}return Re(this.latestValues)&&We(c,this.latestValues),c}removeTransform(a){const l=se();ye(l,a);for(let c=0;c<this.path.length;c++){const d=this.path[c];if(!d.instance||!Re(d.latestValues))continue;bs(d.latestValues)&&d.updateSnapshot();const u=se(),h=d.measurePageBox();ye(u,h),ui(l,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,u)}return Re(this.latestValues)&&ui(l,this.latestValues),l}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==le.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var l;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const d=!!this.resumingFrom||this!==c;if(!(a||d&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:h,layoutId:f}=this.options;if(!(!this.layout||!(h||f))){if(this.resolvedRelativeTargetAt=le.timestamp,!this.targetDelta&&!this.relativeTarget){const p=this.getClosestProjectingParent();p&&p.layout&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=se(),this.relativeTargetOrigin=se(),ot(this.relativeTargetOrigin,this.layout.layoutBox,p.layout.layoutBox),ye(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=se(),this.targetWithTransforms=se()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),nd(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):ye(this.target,this.layout.layoutBox),Qr(this.target,this.targetDelta)):ye(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const p=this.getClosestProjectingParent();p&&!!p.resumingFrom==!!this.resumingFrom&&!p.options.layoutScroll&&p.target&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=se(),this.relativeTargetOrigin=se(),ot(this.relativeTargetOrigin,this.target,p.target),ye(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}nt&&Ie.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||bs(this.parent.latestValues)||Zr(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var a;const l=this.getLead(),c=!!this.resumingFrom||this!==l;let d=!0;if((this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty)&&(d=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(d=!1),this.resolvedRelativeTargetAt===le.timestamp&&(d=!1),d)return;const{layout:u,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||h))return;ye(this.layoutCorrected,this.layout.layoutBox);const f=this.treeScale.x,p=this.treeScale.y;hd(this.layoutCorrected,this.treeScale,this.path,c),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox,l.targetWithTransforms=se());const{target:b}=l;if(!b){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(li(this.prevProjectionDelta.x,this.projectionDelta.x),li(this.prevProjectionDelta.y,this.projectionDelta.y)),at(this.projectionDelta,this.layoutCorrected,b,this.latestValues),(this.treeScale.x!==f||this.treeScale.y!==p||!xi(this.projectionDelta.x,this.prevProjectionDelta.x)||!xi(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",b)),nt&&Ie.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var l;if((l=this.options.visualElement)===null||l===void 0||l.scheduleRender(),a){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=He(),this.projectionDelta=He(),this.projectionDeltaWithTransform=He()}setAnimationOrigin(a,l=!1){const c=this.snapshot,d=c?c.latestValues:{},u={...this.latestValues},h=He();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const f=se(),p=c?c.source:void 0,b=this.layout?this.layout.source:void 0,y=p!==b,T=this.getStack(),j=!T||T.members.length<=1,g=!!(y&&!j&&this.options.crossfade===!0&&!this.path.some(Jd));this.animationProgress=0;let v;this.mixTargetDelta=w=>{const x=w/1e3;bi(h.x,a.x,x),bi(h.y,a.y,x),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(ot(f,this.layout.layoutBox,this.relativeParent.layout.layoutBox),qd(this.relativeTarget,this.relativeTargetOrigin,f,x),v&&Vd(this.relativeTarget,v)&&(this.isProjectionDirty=!1),v||(v=se()),ye(v,this.relativeTarget)),y&&(this.animationValues=u,Pd(u,d,this.latestValues,x,g,j)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=x},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Ee(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=J.update(()=>{Tt.hasAnimatedSinceResize=!0,this.currentAnimation=jd(0,gi,{...a,onUpdate:l=>{this.mixTargetDelta(l),a.onUpdate&&a.onUpdate(l)},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(gi),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:l,target:c,layout:d,latestValues:u}=a;if(!(!l||!c||!d)){if(this!==a&&this.layout&&d&&ca(this.options.animationType,this.layout.layoutBox,d.layoutBox)){c=this.target||se();const h=xe(this.layout.layoutBox.x);c.x.min=a.target.x.min,c.x.max=c.x.min+h;const f=xe(this.layout.layoutBox.y);c.y.min=a.target.y.min,c.y.max=c.y.min+f}ye(l,c),We(l,u),at(this.projectionDeltaWithTransform,this.layoutCorrected,l,u)}}registerSharedNode(a,l){this.sharedNodes.has(a)||this.sharedNodes.set(a,new Rd),this.sharedNodes.get(a).add(l);const d=l.options.initialPromotionConfig;l.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(l):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var a;const{layoutId:l}=this.options;return l?((a=this.getStack())===null||a===void 0?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:l}=this.options;return l?(a=this.getStack())===null||a===void 0?void 0:a.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:l,preserveFollowOpacity:c}={}){const d=this.getStack();d&&d.promote(this,c),a&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let l=!1;const{latestValues:c}=a;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(l=!0),!l)return;const d={};c.z&&is("z",a,d,this.animationValues);for(let u=0;u<ns.length;u++)is(`rotate${ns[u]}`,a,d,this.animationValues),is(`skew${ns[u]}`,a,d,this.animationValues);a.render();for(const u in d)a.setStaticValue(u,d[u]),this.animationValues&&(this.animationValues[u]=d[u]);a.scheduleRender()}getProjectionStyles(a){var l,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Ld;const d={visibility:""},u=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,d.opacity="",d.pointerEvents=Nt(a==null?void 0:a.pointerEvents)||"",d.transform=u?u(this.latestValues,""):"none",d;const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){const y={};return this.options.layoutId&&(y.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,y.pointerEvents=Nt(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!Re(this.latestValues)&&(y.transform=u?u({},""):"none",this.hasProjected=!1),y}const f=h.animationValues||h.latestValues;this.applyTransformsToTarget(),d.transform=Id(this.projectionDeltaWithTransform,this.treeScale,f),u&&(d.transform=u(f,d.transform));const{x:p,y:b}=this.projectionDelta;d.transformOrigin=`${p.origin*100}% ${b.origin*100}% 0`,h.animationValues?d.opacity=h===this?(c=(l=f.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:f.opacityExit:d.opacity=h===this?f.opacity!==void 0?f.opacity:"":f.opacityExit!==void 0?f.opacityExit:0;for(const y in _t){if(f[y]===void 0)continue;const{correct:T,applyTo:j}=_t[y],g=d.transform==="none"?f[y]:T(f[y],h);if(j){const v=j.length;for(let w=0;w<v;w++)d[j[w]]=g}else d[y]=g}return this.options.layoutId&&(d.pointerEvents=h===this?Nt(a==null?void 0:a.pointerEvents)||"":"none"),d}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var l;return(l=a.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(yi),this.root.sharedNodes.clear()}}}function Od(e){e.updateLayout()}function Bd(e){var t;const s=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&s&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:r}=e.layout,{animationType:o}=e.options,a=s.source!==e.layout.source;o==="size"?ve(h=>{const f=a?s.measuredBox[h]:s.layoutBox[h],p=xe(f);f.min=n[h].min,f.max=f.min+p}):ca(o,s.layoutBox,n)&&ve(h=>{const f=a?s.measuredBox[h]:s.layoutBox[h],p=xe(n[h]);f.max=f.min+p,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[h].max=e.relativeTarget[h].min+p)});const l=He();at(l,n,s.layoutBox);const c=He();a?at(c,e.applyTransform(r,!0),s.measuredBox):at(c,n,s.layoutBox);const d=!ra(l);let u=!1;if(!e.resumeFrom){const h=e.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:f,layout:p}=h;if(f&&p){const b=se();ot(b,s.layoutBox,f.layoutBox);const y=se();ot(y,n,p.layoutBox),aa(b,y)||(u=!0),h.options.layoutRoot&&(e.relativeTarget=y,e.relativeTargetOrigin=b,e.relativeParent=h)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:s,delta:c,layoutDelta:l,hasLayoutChanged:d,hasRelativeTargetChanged:u})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function $d(e){nt&&Ie.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function zd(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function Ud(e){e.clearSnapshot()}function yi(e){e.clearMeasurements()}function Hd(e){e.isLayoutDirty=!1}function Kd(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function vi(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function Wd(e){e.resolveTargetDelta()}function Gd(e){e.calcProjection()}function Yd(e){e.resetSkewAndRotation()}function Xd(e){e.removeLeadSnapshot()}function bi(e,t,s){e.translate=Q(t.translate,0,s),e.scale=Q(t.scale,1,s),e.origin=t.origin,e.originPoint=t.originPoint}function wi(e,t,s,n){e.min=Q(t.min,s.min,n),e.max=Q(t.max,s.max,n)}function qd(e,t,s,n){wi(e.x,t.x,s.x,n),wi(e.y,t.y,s.y,n)}function Jd(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const Zd={duration:.45,ease:[.4,0,.1,1]},ji=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),Ni=ji("applewebkit/")&&!ji("chrome/")?Math.round:pe;function Si(e){e.min=Ni(e.min),e.max=Ni(e.max)}function Qd(e){Si(e.x),Si(e.y)}function ca(e,t,s){return e==="position"||e==="preserve-aspect"&&!sd(pi(t),pi(s),.2)}function eu(e){var t;return e!==e.root&&((t=e.scroll)===null||t===void 0?void 0:t.wasRoot)}const tu=la({attachResizeListener:(e,t)=>ft(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),rs={current:void 0},da=la({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!rs.current){const e=new tu({});e.mount(window),e.setOptions({layoutScroll:!0}),rs.current=e}return rs.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),su={pan:{Feature:yd},drag:{Feature:gd,ProjectionNode:da,MeasureLayout:sa}};function Ti(e,t,s){const{props:n}=e;e.animationState&&n.whileHover&&e.animationState.setActive("whileHover",s==="Start");const r="onHover"+s,o=n[r];o&&J.postRender(()=>o(t,gt(t)))}class nu extends De{mount(){const{current:t}=this.node;t&&(this.unmount=sl(t,s=>(Ti(this.node,s,"Start"),n=>Ti(this.node,n,"End"))))}unmount(){}}class iu extends De{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=xt(ft(this.node.current,"focus",()=>this.onFocus()),ft(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function Ci(e,t,s){const{props:n}=e;e.animationState&&n.whileTap&&e.animationState.setActive("whileTap",s==="Start");const r="onTap"+(s==="End"?"":s),o=n[r];o&&J.postRender(()=>o(t,gt(t)))}class ru extends De{mount(){const{current:t}=this.node;t&&(this.unmount=al(t,s=>(Ci(this.node,s,"Start"),(n,{success:r})=>Ci(this.node,n,r?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const js=new WeakMap,as=new WeakMap,au=e=>{const t=js.get(e.target);t&&t(e)},ou=e=>{e.forEach(au)};function lu({root:e,...t}){const s=e||document;as.has(s)||as.set(s,{});const n=as.get(s),r=JSON.stringify(t);return n[r]||(n[r]=new IntersectionObserver(ou,{root:e,...t})),n[r]}function cu(e,t,s){const n=lu(t);return js.set(e,s),n.observe(e),()=>{js.delete(e),n.unobserve(e)}}const du={some:0,all:1};class uu extends De{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:s,margin:n,amount:r="some",once:o}=t,a={root:s?s.current:void 0,rootMargin:n,threshold:typeof r=="number"?r:du[r]},l=c=>{const{isIntersecting:d}=c;if(this.isInView===d||(this.isInView=d,o&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:u,onViewportLeave:h}=this.node.getProps(),f=d?u:h;f&&f(c)};return cu(this.node.current,a,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:s}=this.node;["amount","margin","root"].some(hu(t,s))&&this.startObserver()}unmount(){}}function hu({viewport:e={}},{viewport:t={}}={}){return s=>e[s]!==t[s]}const fu={inView:{Feature:uu},tap:{Feature:ru},focus:{Feature:iu},hover:{Feature:nu}},mu={layout:{ProjectionNode:da,MeasureLayout:sa}},Ns={current:null},ua={current:!1};function pu(){if(ua.current=!0,!!Ms)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>Ns.current=e.matches;e.addListener(t),t()}else Ns.current=!1}const xu=[...Ir,de,Me],gu=e=>xu.find(Rr(e)),ki=new WeakMap;function yu(e,t,s){for(const n in t){const r=t[n],o=s[n];if(ue(r))e.addValue(n,r);else if(ue(o))e.addValue(n,ut(r,{owner:e}));else if(o!==r)if(e.hasValue(n)){const a=e.getValue(n);a.liveStyle===!0?a.jump(r):a.hasAnimated||a.set(r)}else{const a=e.getStaticValue(n);e.addValue(n,ut(a!==void 0?a:r,{owner:e}))}}for(const n in s)t[n]===void 0&&e.removeValue(n);return t}const Pi=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class vu{scrapeMotionValuesFromProps(t,s,n){return{}}constructor({parent:t,props:s,presenceContext:n,reducedMotionConfig:r,blockInitialAnimation:o,visualState:a},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=an,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const p=Se.now();this.renderScheduledAt<p&&(this.renderScheduledAt=p,J.render(this.render,!1,!0))};const{latestValues:c,renderState:d,onUpdate:u}=a;this.onUpdate=u,this.latestValues=c,this.baseTarget={...c},this.initialValues=s.initial?{...c}:{},this.renderState=d,this.parent=t,this.props=s,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=r,this.options=l,this.blockInitialAnimation=!!o,this.isControllingVariants=zt(s),this.isVariantNode=Hi(s),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:h,...f}=this.scrapeMotionValuesFromProps(s,{},this);for(const p in f){const b=f[p];c[p]!==void 0&&ue(b)&&b.set(c[p],!1)}}mount(t){this.current=t,ki.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((s,n)=>this.bindToMotionValue(n,s)),ua.current||pu(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Ns.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){ki.delete(this.current),this.projection&&this.projection.unmount(),Ee(this.notifyUpdate),Ee(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const s=this.features[t];s&&(s.unmount(),s.isMounted=!1)}this.current=null}bindToMotionValue(t,s){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const n=Be.has(t),r=s.on("change",l=>{this.latestValues[t]=l,this.props.onUpdate&&J.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0)}),o=s.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,t,s)),this.valueSubscriptions.set(t,()=>{r(),o(),a&&a(),s.owner&&s.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in Xe){const s=Xe[t];if(!s)continue;const{isEnabled:n,Feature:r}=s;if(!this.features[t]&&r&&n(this.props)&&(this.features[t]=new r(this)),this.features[t]){const o=this.features[t];o.isMounted?o.update():(o.mount(),o.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):se()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,s){this.latestValues[t]=s}update(t,s){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=s;for(let n=0;n<Pi.length;n++){const r=Pi[n];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const o="on"+r,a=t[o];a&&(this.propEventSubscriptions[r]=this.on(r,a))}this.prevMotionValues=yu(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const s=this.getClosestVariantNode();if(s)return s.variantChildren&&s.variantChildren.add(t),()=>s.variantChildren.delete(t)}addValue(t,s){const n=this.values.get(t);s!==n&&(n&&this.removeValue(t),this.bindToMotionValue(t,s),this.values.set(t,s),this.latestValues[t]=s.get())}removeValue(t){this.values.delete(t);const s=this.valueSubscriptions.get(t);s&&(s(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,s){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&s!==void 0&&(n=ut(s===null?void 0:s,{owner:this}),this.addValue(t,n)),n}readValue(t,s){var n;let r=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(n=this.getBaseTargetFromProps(this.props,t))!==null&&n!==void 0?n:this.readValueFromInstance(this.current,t,this.options);return r!=null&&(typeof r=="string"&&(Dr(r)||Sr(r))?r=parseFloat(r):!gu(r)&&Me.test(s)&&(r=_r(t,s)),this.setBaseTarget(t,ue(r)?r.get():r)),ue(r)?r.get():r}setBaseTarget(t,s){this.baseTarget[t]=s}getBaseTarget(t){var s;const{initial:n}=this.props;let r;if(typeof n=="string"||typeof n=="object"){const a=Os(this.props,n,(s=this.presenceContext)===null||s===void 0?void 0:s.custom);a&&(r=a[t])}if(n&&r!==void 0)return r;const o=this.getBaseTargetFromProps(this.props,t);return o!==void 0&&!ue(o)?o:this.initialValues[t]!==void 0&&r===void 0?void 0:this.baseTarget[t]}on(t,s){return this.events[t]||(this.events[t]=new Qs),this.events[t].add(s)}notify(t,...s){this.events[t]&&this.events[t].notify(...s)}}class ha extends vu{constructor(){super(...arguments),this.KeyframeResolver=Lr}sortInstanceNodePosition(t,s){return t.compareDocumentPosition(s)&2?1:-1}getBaseTargetFromProps(t,s){return t.style?t.style[s]:void 0}removeValueFromRenderState(t,{vars:s,style:n}){delete s[t],delete n[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;ue(t)&&(this.childSubscription=t.on("change",s=>{this.current&&(this.current.textContent=`${s}`)}))}}function bu(e){return window.getComputedStyle(e)}class wu extends ha{constructor(){super(...arguments),this.type="html",this.renderInstance=Qi}readValueFromInstance(t,s){if(Be.has(s)){const n=rn(s);return n&&n.default||0}else{const n=bu(t),r=(qi(s)?n.getPropertyValue(s):n[s])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(t,{transformPagePoint:s}){return ea(t,s)}build(t,s,n){zs(t,s,n.transformTemplate)}scrapeMotionValuesFromProps(t,s,n){return Ws(t,s,n)}}class ju extends ha{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=se}getBaseTargetFromProps(t,s){return t[s]}readValueFromInstance(t,s){if(Be.has(s)){const n=rn(s);return n&&n.default||0}return s=er.has(s)?s:Is(s),t.getAttribute(s)}scrapeMotionValuesFromProps(t,s,n){return nr(t,s,n)}build(t,s,n){Us(t,s,this.isSVGTag,n.transformTemplate)}renderInstance(t,s,n,r){tr(t,s,n,r)}mount(t){this.isSVGTag=Ks(t.tagName),super.mount(t)}}const Nu=(e,t)=>Fs(e)?new ju(t):new wu(t,{allowProjection:e!==m.Fragment}),Su=Xo({...Gc,...fu,...su,...mu},Nu),be=co(Su),Tu=({title:e,onFilterClick:t,showAdd:s=!0,variant:n="default"})=>{const r=n==="overlay";return i.jsxs("div",{className:r?"fixed top-0 left-0 right-0 z-30 px-6 py-4 bg-gradient-to-b from-pink-200/60 via-purple-200/40 to-transparent backdrop-blur-sm flex justify-between items-center pointer-events-none":"sticky top-0 z-20 px-6 py-4 bg-primary-50/80 backdrop-blur-md flex justify-between items-center transition-all",children:[i.jsx("div",{className:r?"text-2xl font-bold text-slate-800 tracking-tight flex items-center opacity-0":"text-2xl font-bold text-slate-800 tracking-tight flex items-center",children:e}),i.jsx("div",{className:r?"flex gap-4 opacity-0":"flex gap-4",children:s&&i.jsx("button",{onClick:t,className:"p-2 rounded-full bg-white text-primary-500 shadow-sm hover:shadow-md transition-all active:scale-95","aria-label":"",children:i.jsx(It,{size:20})})})]})};var lt=(e=>(e.ONLINE="",e.OFFLINE="",e.BUSY="",e))(lt||{}),Fe=(e=>(e.TEXT="text",e.SYSTEM="system",e))(Fe||{}),Z=(e=>(e.HOME="home",e.CHAT="chat",e.ME="me",e))(Z||{});const Cu=({activeTab:e,onTabChange:t})=>{const s=n=>`flex flex-col items-center justify-center w-full h-full transition-all duration-300 ${e===n?"text-primary-600 scale-105":"text-slate-400 hover:text-primary-400"}`;return i.jsx("div",{className:"fixed bottom-0 inset-x-0 z-30",children:i.jsxs("div",{className:"mx-auto w-full max-w-md h-20 bg-white/90 backdrop-blur-lg border-t border-primary-100 shadow-[0_-4px_20px_rgba(0,0,0,0.02)] flex justify-around items-center px-4 rounded-none md:rounded-b-3xl md:shadow-2xl",children:[i.jsxs("button",{className:s(Z.HOME),onClick:()=>t(Z.HOME),children:[i.jsx(Oa,{size:24,strokeWidth:e===Z.HOME?2.5:2}),i.jsx("span",{className:"text-xs mt-1 font-semibold",children:""})]}),i.jsxs("button",{className:s(Z.CHAT),onClick:()=>t(Z.CHAT),children:[i.jsxs("div",{className:"relative",children:[i.jsx(Ps,{size:24,strokeWidth:e===Z.CHAT?2.5:2}),i.jsx("span",{className:"absolute -top-1 -right-1 w-2.5 h-2.5 bg-red-400 rounded-full border-2 border-white"})]}),i.jsx("span",{className:"text-xs mt-1 font-semibold",children:""})]}),i.jsxs("button",{className:s(Z.ME),onClick:()=>t(Z.ME),children:[i.jsx(Cs,{size:24,strokeWidth:e===Z.ME?2.5:2}),i.jsx("span",{className:"text-xs mt-1 font-semibold",children:""})]})]})})},Ai=({chat:e,onClick:t,onTogglePin:s,roundedClass:n})=>{const r=a=>a.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit",hour12:!1}),o=a=>{a.stopPropagation(),s()};return i.jsxs("div",{onClick:t,className:`group relative flex items-center gap-4 p-4 bg-white ${n||"rounded-2xl"} shadow-sm border border-transparent hover:border-primary-100 hover:shadow-md active:scale-[0.98] transition-all duration-200 cursor-pointer`,children:[i.jsx("div",{className:"relative flex-shrink-0",children:i.jsx("div",{className:"w-14 h-14 rounded-full p-0.5 bg-gradient-to-tr from-primary-300 to-accent-pink",children:i.jsx("img",{src:e.character.avatar,alt:e.character.name,className:"w-full h-full rounded-full object-cover border-2 border-white"})})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex justify-between items-baseline mb-1",children:[i.jsx("div",{className:"flex items-center gap-2",children:i.jsx("h3",{className:"font-bold text-slate-800 text-lg truncate",children:e.character.name})}),i.jsx("span",{className:"text-xs text-slate-400 font-medium whitespace-nowrap ml-2",children:r(e.lastMessage.timestamp)})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("p",{className:"text-slate-500 text-sm truncate pr-4 leading-relaxed",children:[e.lastMessage.senderId==="user"&&i.jsx("span",{className:"text-slate-400",children:": "}),e.lastMessage.text]}),i.jsxs("div",{className:"flex gap-2 items-center flex-shrink-0",children:[i.jsx("button",{onClick:o,className:`w-6 h-6 flex items-center justify-center rounded-full transition-all ${e.character.isPinned?"bg-primary-50 text-primary-400":"text-slate-200 hover:text-primary-300"}`,children:i.jsx(Ja,{size:14,className:`transform rotate-45 ${e.character.isPinned?"fill-primary-400":""}`})}),e.unreadCount>0&&i.jsx("span",{className:"flex items-center justify-center min-w-[20px] h-5 px-1.5 bg-red-400 text-white text-[10px] font-bold rounded-full",children:e.unreadCount})]})]})]})]})},ku=({chats:e,onChatClick:t,onTogglePin:s,onDeleteChat:n,isDetailOpen:r=!1})=>{const o=(navigator==null?void 0:navigator.maxTouchPoints)>0,a=e.filter(g=>g.character.isPinned),l=e.filter(g=>!g.character.isPinned),[c,d]=m.useState({}),[u,h]=m.useState(null),f=m.useRef(0),p=m.useRef(null),b=(g,v)=>{f.current=g.touches[0].clientX,p.current=v},y=(g,v)=>{if(p.current!==v)return;const w=g.touches[0].clientX-f.current,x=Math.max(-96,Math.min(0,w));d(P=>({...P,[v]:x}))},T=g=>{if(p.current!==g)return;const w=(c[g]||0)<-60?-96:0;d(x=>({...x,[g]:w})),p.current=null},j=g=>d(v=>({...v,[g]:0}));return i.jsxs(be.div,{className:"px-6 pb-24 animate-in fade-in slide-in-from-bottom-4 duration-700",initial:{x:0},animate:r&&o?{x:"-100%"}:{x:0},transition:r&&o?{duration:.3,ease:"linear"}:{duration:0},children:[a.length>0&&i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-3 px-1",children:""}),a.map(g=>i.jsxs("div",{className:"relative overflow-hidden mb-3 rounded-2xl",children:[(()=>{const v=Math.min(96,Math.max(0,-(c[g.characterId]||0)));return i.jsx("div",{className:"absolute right-0 top-0 bottom-0 bg-red-500 flex items-center justify-center rounded-r-2xl shadow-sm",style:{width:`${v}px`,transition:"width 120ms ease"},children:i.jsx("button",{onClick:()=>h(g.characterId),className:"text-white font-bold drop-shadow-sm",children:""})})})(),i.jsx("div",{onTouchStart:v=>b(v,g.characterId),onTouchMove:v=>y(v,g.characterId),onTouchEnd:()=>T(g.characterId),style:{transform:`translateX(${c[g.characterId]||0}px)`,transition:"transform 180ms ease"},children:i.jsx(Ai,{chat:g,onClick:()=>t(g),onTogglePin:()=>s(g.characterId),roundedClass:(c[g.characterId]||0)<0?"rounded-l-2xl rounded-r-none":"rounded-2xl"})})]},g.characterId))]}),l.length>0&&i.jsxs("div",{children:[i.jsx("h2",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-3 px-1",children:""}),l.map(g=>i.jsxs("div",{className:"relative overflow-hidden mb-3 rounded-2xl",children:[(()=>{const v=Math.min(96,Math.max(0,-(c[g.characterId]||0)));return i.jsx("div",{className:"absolute right-0 top-0 bottom-0 bg-red-500 flex items-center justify-center rounded-r-2xl shadow-sm",style:{width:`${v}px`,transition:"width 120ms ease"},children:i.jsx("button",{onClick:()=>h(g.characterId),className:"text-white font-bold drop-shadow-sm",children:""})})})(),i.jsx("div",{onTouchStart:v=>b(v,g.characterId),onTouchMove:v=>y(v,g.characterId),onTouchEnd:()=>T(g.characterId),style:{transform:`translateX(${c[g.characterId]||0}px)`,transition:"transform 180ms ease"},children:i.jsx(Ai,{chat:g,onClick:()=>t(g),onTogglePin:()=>s(g.characterId),roundedClass:(c[g.characterId]||0)<0?"rounded-l-2xl rounded-r-none":"rounded-2xl"})})]},g.characterId))]}),u&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 z-[80] bg-black/20 animate-[fadeBg_200ms_ease]"}),i.jsx("div",{className:"fixed inset-0 z-[90] flex items-center justify-center",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl border border-slate-200 w-[85%] max-w-sm animate-[fadeCard_200ms_ease]",children:[i.jsx("div",{className:"px-6 py-5 text-center text-slate-800 font-bold",children:""}),i.jsx("div",{className:"h-[1px] bg-slate-100"}),i.jsxs("div",{className:"flex",children:[i.jsx("button",{className:"flex-1 py-4 text-slate-600 active:opacity-70",onClick:()=>{j(u),h(null)},children:""}),i.jsx("div",{className:"w-[1px] bg-slate-100"}),i.jsx("button",{className:"flex-1 py-4 text-red-600 font-bold active:opacity-70",onClick:()=>{const g=u;h(null),n(g)},children:""})]})]})}),i.jsx("style",{children:`
        @keyframes fadeCard { from { opacity: 0; transform: translateY(-6px) } to { opacity: 1; transform: translateY(0) } }
        @keyframes fadeBg { from { opacity: 0 } to { opacity: 1 } }
      `})]}),e.length===0&&i.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[i.jsx("div",{className:"w-20 h-20 bg-primary-100 rounded-full flex items-center justify-center mb-4 text-4xl",children:""}),i.jsx("p",{className:"text-slate-500 font-medium",children:""}),i.jsx("p",{className:"text-slate-400 text-sm mt-1",children:""})]})]})},Pu={type:"tween",ease:"easeInOut",duration:.28},dn={type:"tween",ease:"linear",duration:.28},Kt={duration:.18},Au="/api",_u={async login(e,t){const s=await fetch(`${Au}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})});if(!s.ok)throw new Error("login_failed");return s.json()}},un=e=>e==="male"?"":e==="female"?"":"",Eu=async e=>{const t={name:(e==null?void 0:e.name)||"",age:parseInt((e==null?void 0:e.age)||"0")||null,gender:un(e==null?void 0:e.gender),profession:(e==null?void 0:e.profession)||null,basic_info:(e==null?void 0:e.basicInfo)||null,personality:(e==null?void 0:e.personality)||null,avatar:(e==null?void 0:e.avatar)||null},{authFetch:s}=await re(async()=>{const{authFetch:o}=await import("./http-DqgzyhP5.js");return{authFetch:o}},__vite__mapDeps([0,1,2,3])),n=await s("/user/chat-role",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok)throw new Error("create_role_failed");return(await n.json()).id},Mu=async(e,t)=>{const s={name:(t==null?void 0:t.name)||"",age:parseInt((t==null?void 0:t.age)||"0")||null,gender:un(t==null?void 0:t.gender),profession:(t==null?void 0:t.profession)||null,basic_info:(t==null?void 0:t.basicInfo)||null,personality:(t==null?void 0:t.personality)||null,avatar:(t==null?void 0:t.avatar)||null},{authFetch:n}=await re(async()=>{const{authFetch:o}=await import("./http-DqgzyhP5.js");return{authFetch:o}},__vite__mapDeps([0,1,2,3]));if(!(await n(`/user/chat-role/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).ok)throw new Error("update_role_failed");return!0},Du=async()=>{const{authFetch:e}=await re(async()=>{const{authFetch:n}=await import("./http-DqgzyhP5.js");return{authFetch:n}},__vite__mapDeps([0,1,2,3])),t=await e("/user/chat-role",{method:"GET"});if(!t.ok)throw new Error("fetch_roles_failed");const s=await t.json();return Array.isArray(s)?s:[]},Ss=async(e,t)=>{const s={character_id:Number(e)};typeof t=="number"&&(s.user_chat_role_id=t);const{authFetch:n}=await re(async()=>{const{authFetch:a}=await import("./http-DqgzyhP5.js");return{authFetch:a}},__vite__mapDeps([0,1,2,3])),r=await n("/chat/sessions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!r.ok)throw new Error("create_session_failed");const o=await r.json();return typeof o=="string"?{sessionId:o}:{sessionId:o.sessionId,model:o.model,temperature:o.temperature}},os=(e,t)=>{const r=`${`${location.protocol==="https:"?"wss":"ws"}://${location.host}`}/ws/chat`;console.log("[ws] connecting",r);let o=null,a=!1,l=1e3;const c=1e4,d=[],u=()=>{o=new WebSocket(r),o.onmessage=b=>{try{const y=JSON.parse(String(b.data));y&&y.type==="assistant_message"&&typeof y.content=="string"&&t(y.content,y.quote,{chunkIndex:y.chunkIndex,chunkTotal:y.chunkTotal})}catch{}},o.onerror=b=>{console.error("[ws] error",b)},o.onopen=()=>{for(console.log("[ws] open"),l=1e3;d.length;){const y=d.shift();try{o==null||o.send(JSON.stringify(y))}catch{}}const b={type:"typing",sessionId:e,typing:!1};try{o==null||o.send(JSON.stringify(b))}catch{}},o.onclose=()=>{console.log("[ws] closed"),a||(setTimeout(u,l),l=Math.min(l*2,c))}};return u(),{ws:o,sendText:(b,y,T,j,g)=>{const v={sessionId:e,text:b,chatMode:y};T&&(v.userRole={name:T.name,gender:un(T.gender),age:T.age||"",profession:T.profession||"",basic_info:T.basicInfo||"",personality:T.personality||"",avatar:T.avatar||""}),j&&(v.model_id=j),typeof g=="number"&&(v.temperature=g),o&&o.readyState===WebSocket.OPEN?o.send(JSON.stringify(v)):d.push(v)},sendTyping:b=>{const y={type:"typing",sessionId:e,typing:b};o&&o.readyState===WebSocket.OPEN?o.send(JSON.stringify(y)):d.push(y)},close:()=>{a=!0;try{o==null||o.close()}catch{}}}},Vu=async()=>{const{authFetch:e}=await re(async()=>{const{authFetch:n}=await import("./http-DqgzyhP5.js");return{authFetch:n}},__vite__mapDeps([0,1,2,3])),t=await e("/chat/models",{method:"GET"});if(!t.ok)throw new Error("list_models_failed");const s=await t.json();return Array.isArray(s.items)?s.items:[]},Ru=async e=>{const{authFetch:t}=await re(async()=>{const{authFetch:o}=await import("./http-DqgzyhP5.js");return{authFetch:o}},__vite__mapDeps([0,1,2,3])),s=await t(`/chat/sessions/${e}`,{method:"GET"});if(!s.ok)throw new Error("get_session_failed");const n=await s.json(),r=(n==null?void 0:n.session)||{};return{model:r==null?void 0:r.model,temperature:r==null?void 0:r.temperature}},hn=({imageSrc:e,onCrop:t,onCancel:s})=>{const[n,r]=m.useState(1),[o,a]=m.useState({x:0,y:0}),[l,c]=m.useState(!1),[d,u]=m.useState({x:0,y:0}),h=m.useRef(null),f=m.useRef(null),p=m.useRef(null),b=300,y=v=>{c(!0);const w="touches"in v?v.touches[0].clientX:v.clientX,x="touches"in v?v.touches[0].clientY:v.clientY;u({x:w-o.x,y:x-o.y})},T=v=>{if(!l)return;v.preventDefault();const w="touches"in v?v.touches[0].clientX:v.clientX,x="touches"in v?v.touches[0].clientY:v.clientY;a({x:w-d.x,y:x-d.y})},j=()=>{c(!1)},g=()=>{const v=p.current,w=h.current;if(!v||!w)return;const x=v.getContext("2d");if(!x)return;const P=800;v.width=P,v.height=P;const M=w.naturalWidth,S=w.naturalHeight,L=Math.min(M,S),O=b/L,D=P/b;x.fillStyle="#000",x.fillRect(0,0,P,P),x.translate(P/2,P/2),x.translate(o.x*D,o.y*D),x.scale(n*D,n*D),x.scale(O,O),x.drawImage(w,-M/2,-S/2),t(v.toDataURL("image/jpeg",.9))};return i.jsxs("div",{className:"fixed inset-0 z-[100] bg-black flex flex-col items-center justify-center animate-in fade-in duration-300",children:[i.jsxs("div",{className:"absolute top-0 w-full p-4 flex justify-between items-center z-20 text-white",children:[i.jsx("button",{onClick:s,className:"p-2 bg-white/10 rounded-full backdrop-blur-md",children:i.jsx(Ct,{size:24})}),i.jsx("h3",{className:"font-bold text-lg tracking-wider",children:""}),i.jsx("button",{onClick:g,className:"p-2 bg-purple-500 rounded-full text-white shadow-lg shadow-purple-500/30",children:i.jsx(Ri,{size:24})})]}),i.jsxs("div",{ref:f,className:"relative w-full h-full overflow-hidden bg-black flex items-center justify-center touch-none select-none",onMouseDown:y,onMouseMove:T,onMouseUp:j,onMouseLeave:j,onTouchStart:y,onTouchMove:T,onTouchEnd:j,children:[i.jsx("img",{ref:h,src:e,alt:"Crop target",className:"absolute max-w-none transition-transform duration-75 ease-linear pointer-events-none",style:{transform:`translate(${o.x}px, ${o.y}px) scale(${n})`,height:b,width:"auto"},draggable:!1}),i.jsx("div",{className:"absolute inset-0 pointer-events-none z-10 flex items-center justify-center",children:i.jsx("div",{className:"absolute border-2 border-white box-content shadow-[0_0_0_9999px_rgba(0,0,0,0.8)]",style:{width:b,height:b},children:i.jsxs("div",{className:"absolute inset-0 grid grid-cols-3 grid-rows-3 opacity-30",children:[i.jsx("div",{className:"border-r border-white"}),i.jsx("div",{className:"border-r border-white"}),i.jsx("div",{className:"border-b border-white col-span-3 row-start-1"}),i.jsx("div",{className:"border-b border-white col-span-3 row-start-2"})]})})})]}),i.jsx("div",{className:"absolute bottom-0 w-full bg-slate-900/80 backdrop-blur-md p-6 pb-10 flex flex-col gap-4 z-20",children:i.jsxs("div",{className:"flex items-center gap-4 text-white justify-center",children:[i.jsx(Ya,{size:20,className:"text-slate-400"}),i.jsx("input",{type:"range",min:"0.5",max:"3",step:"0.05",value:n,onChange:v=>r(parseFloat(v.target.value)),className:"w-64 h-2 bg-slate-600 rounded-lg appearance-none cursor-pointer accent-purple-500"}),i.jsx(It,{size:20,className:"text-slate-400"})]})}),i.jsx("canvas",{ref:p,className:"hidden"})]})},fa=({currentPersona:e,roleId:t,onBack:s,onSave:n,withinContainer:r=!1})=>{const[o,a]=m.useState((e==null?void 0:e.gender)||"female"),[l,c]=m.useState((e==null?void 0:e.name)||""),[d,u]=m.useState((e==null?void 0:e.age)||""),[h,f]=m.useState((e==null?void 0:e.profession)||""),[p,b]=m.useState((e==null?void 0:e.basicInfo)||""),[y,T]=m.useState((e==null?void 0:e.personality)||""),[j,g]=m.useState(e==null?void 0:e.avatar),[v,w]=m.useState(null),[x,P]=m.useState(!1),M=m.useRef(null),S=B=>{var te;const X=B.split(","),ne=((te=X[0].match(/:(.*?);/))==null?void 0:te[1])||"image/jpeg",ie=atob(X[1]);let ce=ie.length;const U=new Uint8Array(ce);for(;ce--;)U[ce]=ie.charCodeAt(ce);return new Blob([U],{type:ne})},L=async()=>{if(x)return;P(!0);const B=localStorage.getItem("user_access_token");let X=j;try{if(j&&j.startsWith("data:image")){const ie=S(j),ce=new FormData,U=`${Date.now()}_${Math.random().toString(36).slice(2,8)}.jpg`;ce.append("avatar",ie,"avatar.jpg"),ce.append("filename",U),X=`/uploads/users/avatars/${U}`,fetch("/api/uploads/avatar",{method:"POST",headers:{Authorization:B?`Bearer ${B}`:""},body:ce}).catch(()=>{})}const ne={gender:o,name:l,age:d,profession:h,basicInfo:p,personality:y,avatar:X||void 0};typeof t=="number"?await Mu(t,ne):await Eu(ne)}catch{}n({gender:o,name:l,age:d,profession:h,basicInfo:p,personality:y,avatar:X}),P(!1),s()},O=()=>{var B;(B=M.current)==null||B.click()},D=B=>{var ne;const X=(ne=B.target.files)==null?void 0:ne[0];if(X){const ie=new FileReader;ie.onloadend=()=>{w(ie.result)},ie.readAsDataURL(X)}M.current&&(M.current.value="")};return i.jsxs("div",{className:`${r?"absolute":"fixed"} inset-0 z-[80]`,children:[i.jsx(be.div,{className:"absolute inset-0 bg-[#F8F9FA]",initial:{opacity:0},animate:{opacity:1},transition:Kt}),i.jsxs(be.div,{className:"absolute bottom-0 left-0 right-0 bg-white rounded-t-2xl shadow-[0_-10px_30px_rgba(0,0,0,0.08)] flex flex-col h-[92vh] w-full overflow-y-auto no-scrollbar",initial:{y:"100%"},animate:{y:0},transition:dn,children:[v&&i.jsx(hn,{imageSrc:v,onCancel:()=>w(null),onCrop:B=>{g(B),w(null)}}),i.jsxs("div",{className:"mx-auto w-full max-w-md bg-white/90 backdrop-blur-md px-4 py-3 flex items-center justify-between sticky top-0 z-10 shadow-sm border-b border-slate-100 rounded-none md:rounded-t-3xl",children:[i.jsx("button",{onClick:s,className:"p-2 -ml-2 text-slate-800 hover:bg-slate-50 rounded-full transition-colors",children:i.jsx(Lt,{size:24})}),i.jsx("button",{onClick:L,disabled:x,className:`px-4 py-1.5 rounded-lg text-sm font-bold transition-transform ${x?"bg-purple-200 text-white cursor-not-allowed":"bg-purple-50 text-purple-600 active:scale-95"}`,children:""})]}),i.jsxs("div",{className:"mx-auto w-full max-w-md bg-white p-4 space-y-3 pb-10 rounded-none md:rounded-b-3xl md:shadow-2xl",children:[i.jsx("div",{className:"flex justify-center py-6",children:i.jsxs("div",{onClick:O,className:"relative group cursor-pointer active:scale-95 transition-transform",children:[i.jsx("div",{className:"w-24 h-24 rounded-full bg-pink-200 flex items-center justify-center text-white shadow-sm border-4 border-white overflow-hidden",children:j?i.jsx("img",{src:j,alt:"User Avatar",className:"w-full h-full object-cover"}):i.jsx(Cs,{size:48,fill:"currentColor"})}),i.jsx("div",{className:"absolute bottom-0 right-0 bg-white p-2 rounded-full shadow-md border border-slate-100",children:i.jsx(xa,{size:14,className:"text-slate-400"})}),i.jsx("input",{type:"file",ref:M,className:"hidden",accept:"image/*",onChange:D})]})}),i.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-sm",children:[i.jsx("label",{className:"block font-bold text-slate-800 text-sm mb-4",children:""}),i.jsxs("div",{className:"flex gap-6",children:[i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[i.jsx("div",{className:`w-4 h-4 rounded-full border flex items-center justify-center ${o==="male"?"border-blue-500":"border-slate-300"}`,children:o==="male"&&i.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"})}),i.jsx("input",{type:"radio",name:"gender",value:"male",checked:o==="male",onChange:()=>a("male"),className:"hidden"}),i.jsx("span",{className:"text-sm text-slate-700 group-hover:text-slate-900",children:""})]}),i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[i.jsx("div",{className:`w-4 h-4 rounded-full border flex items-center justify-center ${o==="female"?"border-blue-500":"border-slate-300"}`,children:o==="female"&&i.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"})}),i.jsx("input",{type:"radio",name:"gender",value:"female",checked:o==="female",onChange:()=>a("female"),className:"hidden"}),i.jsx("span",{className:"text-sm text-slate-700 group-hover:text-slate-900",children:""})]}),i.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[i.jsx("div",{className:`w-4 h-4 rounded-full border flex items-center justify-center ${o==="secret"?"border-blue-500":"border-slate-300"}`,children:o==="secret"&&i.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"})}),i.jsx("input",{type:"radio",name:"gender",value:"secret",checked:o==="secret",onChange:()=>a("secret"),className:"hidden"}),i.jsx("span",{className:"text-sm text-slate-700 group-hover:text-slate-900",children:""})]})]})]}),i.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-sm",children:[i.jsx("label",{className:"block font-bold text-slate-800 text-sm mb-2",children:" ()"}),i.jsx("input",{type:"text",placeholder:"",className:"w-full text-sm outline-none placeholder:text-slate-300 py-1",value:l,onChange:B=>c(B.target.value)})]}),i.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-sm",children:[i.jsx("label",{className:"block font-bold text-slate-800 text-sm mb-2",children:""}),i.jsx("input",{type:"text",placeholder:"",className:"w-full text-sm outline-none placeholder:text-slate-300 py-1",value:d,onChange:B=>u(B.target.value)})]}),i.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-sm",children:[i.jsx("label",{className:"block font-bold text-slate-800 text-sm mb-2",children:""}),i.jsx("input",{type:"text",placeholder:"",className:"w-full text-sm outline-none placeholder:text-slate-300 py-1",value:h,onChange:B=>f(B.target.value)})]}),i.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-sm",children:[i.jsx("label",{className:"block font-bold text-slate-800 text-sm mb-2",children:""}),i.jsx("textarea",{placeholder:"...",className:"w-full text-sm outline-none placeholder:text-slate-300 py-1 resize-none h-20",value:p,onChange:B=>b(B.target.value)})]}),i.jsxs("div",{className:"bg rounded-xl p-5 shadow-sm",children:[i.jsx("label",{className:"block font-bold text-slate-800 text-sm mb-2",children:""}),i.jsx("textarea",{placeholder:"...",className:"w-full text-sm outline-none placeholder:text-slate-300 py-1 resize-none h-20",value:y,onChange:B=>T(B.target.value)})]})]})]})]})},Iu=e=>e===""?"male":e===""?"female":"secret",Lu=({isOpen:e,currentPersona:t,onClose:s,onAdd:n,onSelect:r})=>{const[o,a]=m.useState([]),[l,c]=m.useState(null);m.useEffect(()=>{e&&(async()=>{try{const h=await Du();a(h)}catch{}})()},[e]),m.useEffect(()=>{if(t){const u=o.find(h=>h.name===t.name);u&&c(u.id)}},[o,t]);const d=u=>{c(u.id);const h={name:u.name||"",gender:Iu(u.gender),age:u.age?String(u.age):"",profession:u.profession||"",basicInfo:u.basic_info||"",personality:u.personality||"",avatar:u.avatar||void 0};try{localStorage.setItem("user_chat_role_id",String(u.id))}catch{}r(h,u.id),s()};return i.jsx("div",{className:`fixed inset-0 z-[90] ${e?"":"pointer-events-none"}`,children:i.jsx(Ge,{children:e&&i.jsxs(i.Fragment,{children:[i.jsx(be.div,{className:"absolute inset-0 bg-black/30 will-change-opacity",onClick:s,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:Kt},"backdrop"),i.jsx(be.div,{className:"absolute bottom-0 left-0 right-0 bg-transparent will-change-transform transform-gpu",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:dn,children:i.jsxs("div",{className:"mx-auto w-full max-w-md bg-white rounded-t-2xl shadow-[0_-10px_30px_rgba(0,0,0,0.08)]",children:[i.jsxs("div",{className:"sticky top-0 bg-white/95 backdrop-blur-md p-3 border-b border-slate-100 flex justify-between items-center z-10",children:[i.jsxs("button",{onClick:s,className:"flex items-center gap-2",children:[i.jsx(Lt,{className:"w-6 h-6"}),i.jsx("span",{className:"font-bold text-lg",children:""})]}),i.jsx("button",{onClick:n,className:"w-9 h-9 rounded-full bg-purple-50 text-[#A855F7] flex items-center justify-center active:scale-90 transition-transform",children:i.jsx(It,{className:"w-6 h-6"})})]}),i.jsxs("div",{className:"p-4 flex flex-col gap-3 max-h-[70vh] overflow-y-auto",children:[o.map(u=>i.jsxs("div",{onClick:()=>d(u),className:`p-4 bg rounded-xl shadow-sm border border-slate-100 flex items-center gap-3 active:scale-[0.98] transition-transform ${l===u.id?"border-[#A855F7] bg-[#FBF5FF]":""}`,children:[i.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden bg-slate-200 flex items-center justify-center text-slate-600 font-bold",children:u.avatar?i.jsx("img",{src:u.avatar,alt:u.name,className:"w-full h-full object-cover"}):(u.name||"")[0]}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"font-bold text-slate-800 truncate",children:u.name}),i.jsxs("div",{className:"text-xs text-slate-500 truncate",children:[u.profession||"",u.age?`  ${u.age}`:""]})]}),l===u.id&&i.jsx(Di,{className:"w-5 h-5 text-[#A855F7]"})]},u.id)),!o.length&&i.jsxs("div",{className:"p-6 text-center text-slate-500",children:[i.jsx("div",{className:"text-sm",children:""}),i.jsx("div",{className:"mt-3",children:i.jsx("button",{onClick:n,className:"px-3 py-1.5 bg-[#A855F7] text-white rounded-lg text-sm font-bold",children:""})})]})]})]})},"sheet")]})})})},Fu=({isOpen:e,currentModelId:t,onClose:s,onSelect:n,temperature:r,onTempChange:o})=>{const[a,l]=m.useState([]),[c,d]=m.useState(t),[u,h]=m.useState(typeof r=="number"?r:.1);return m.useEffect(()=>{d(t)},[t]),m.useEffect(()=>{typeof r=="number"&&h(r)},[r]),m.useEffect(()=>{if(!e)return;(async()=>{try{const b=[...await Vu()].sort((y,T)=>(y.nickname||y.id).localeCompare(T.nickname||T.id,"zh-CN",{sensitivity:"base"}));l(b)}catch{}})()},[e]),i.jsx("div",{className:`fixed inset-0 z-[90] ${e?"":"pointer-events-none"}`,children:i.jsx(Ge,{children:e&&i.jsxs(i.Fragment,{children:[i.jsx(be.div,{className:"absolute inset-0 bg-black/30 will-change-opacity",onClick:s,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:Kt},"backdrop"),i.jsxs(be.div,{className:"absolute bottom-0 left-0 right-0 bg-white rounded-t-2xl shadow-[0_-10px_30px_rgba(0,0,0,0.08)] will-change-transform transform-gpu",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:dn,children:[i.jsxs("div",{className:"sticky top-0 bg-white/95 backdrop-blur-md p-3 border-b border-slate-100 flex justify-between items-center z-10",children:[i.jsxs("button",{onClick:s,className:"flex items-center gap-2",children:[i.jsx(Lt,{className:"w-6 h-6"}),i.jsx("span",{className:"font-bold text-lg",children:""})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-sm font-bold text-slate-700",children:""}),i.jsx("input",{value:u,onChange:f=>{const p=parseFloat(f.target.value||"0");h(isNaN(p)?0:p),o==null||o(isNaN(p)?0:p)},type:"number",step:"0.1",min:"0",max:"2",className:"w-16 px-2 py-1 border border-slate-200 rounded-lg text-sm"})]})]}),i.jsxs("div",{className:"p-4 flex flex-col gap-3 max-h-[70vh] overflow-y-auto",children:[a.map(f=>i.jsxs("div",{onClick:()=>{d(f.id),n(f.id,f.nickname),s()},className:`relative p-4 rounded-xl shadow-sm border active:scale-[0.98] transition-transform flex items-center justify-center ${c===f.id?"bg-[#F3E8FF] border-[#A855F7]":"bg-white border-slate-100"}`,children:[i.jsx("div",{className:"w-full text-center font-bold text-slate-800 truncate",children:f.nickname||f.id}),c===f.id&&i.jsx(Di,{className:"w-5 h-5 text-[#A855F7] absolute right-4 top-1/2 -translate-y-1/2"})]},f.id)),!a.length&&i.jsx("div",{className:"p-6 text-center text-slate-500",children:i.jsx("div",{className:"text-sm",children:""})})]})]},"sheet")]})})})},Ou=({character:e,initialMessages:t,userPersona:s,onBack:n,onUpdateLastMessage:r,onOpenUserSettings:o,onShowProfile:a,onUpdateUserPersona:l})=>{const[c,d]=m.useState(t),[u,h]=m.useState("scene"),[f,p]=m.useState(""),[b,y]=m.useState(!1),[T,j]=m.useState(!1),[g,v]=m.useState(!1),[w,x]=m.useState(!1),[P,M]=m.useState(!1),[S,L]=m.useState(void 0),[O,D]=m.useState(.1),[B,X]=m.useState(void 0),[ne,ie]=m.useState(!1),[ce,U]=m.useState(!1),[te,ge]=m.useState(void 0),je=m.useRef(null),q=m.useRef(null),N=m.useRef(null),[A,_]=m.useState(null),$=m.useRef(null),z=(()=>{try{return localStorage.getItem("user_id")||"0"}catch{return"0"}})(),me=`chat_history_${z}_${e.id}`,oe=`chat_config_${e.id}`,Ae=`chat_model_${e.id}`,$e=`chat_temp_${e.id}`,yt=`chat_model_name_${e.id}`,C=m.useMemo(()=>{if(te)return te;try{const E=localStorage.getItem("user_nickname")||"",R=localStorage.getItem("user_avatar")||"";if(E||R)return{name:E||"",gender:"secret",age:"",profession:"",basicInfo:"",personality:"",avatar:R||void 0}}catch{}},[te]),V=(E,R,H)=>{d(W=>{const K=[...W];for(let Y=K.length-1;Y>=0;Y--)if(K[Y].senderId==="user"&&!K[Y].read){K[Y]={...K[Y],read:!0};break}const G={id:(Date.now()+1).toString(),senderId:e.id,text:E,quote:R,timestamp:new Date,type:Fe.TEXT};K.push(G);try{setTimeout(()=>r(G),0)}catch{}return K}),H&&typeof H.chunkIndex=="number"&&typeof H.chunkTotal=="number"?y(H.chunkIndex<H.chunkTotal):y(!1)},k=()=>{var E;q.current?q.current.scrollTop=q.current.scrollHeight:(E=je.current)==null||E.scrollIntoView({behavior:"smooth"})};m.useEffect(()=>{k()},[c,b]),m.useEffect(()=>{const E=()=>{q.current?q.current.scrollTop=q.current.scrollHeight:k()};return window.addEventListener("resize",E),window.visualViewport&&window.visualViewport.addEventListener("resize",E),()=>{window.removeEventListener("resize",E),window.visualViewport&&window.visualViewport.removeEventListener("resize",E)}},[]),m.useEffect(()=>{try{const E=`chat_history_${e.id}`,R=localStorage.getItem(me)||(z==="0"?localStorage.getItem(E):null);if(R){const W=JSON.parse(R).map(K=>({id:K.id,senderId:K.senderId,text:K.text,timestamp:new Date(K.ts),type:K.type,quote:K.quote,read:K.read}));W.length&&d(W)}}catch{}},[e.id]),m.useEffect(()=>{try{const E=c.map(R=>{var H,W;return{id:R.id,senderId:R.senderId,text:R.text,ts:(W=(H=R.timestamp)==null?void 0:H.getTime)!=null&&W.call(H)?R.timestamp.getTime():Date.now(),type:R.type,quote:R.quote,read:R.read}});localStorage.setItem(me,JSON.stringify(E))}catch{}},[c]),m.useEffect(()=>{try{const E=localStorage.getItem(oe);if(E){const G=JSON.parse(E);((G==null?void 0:G.chatMode)==="daily"||(G==null?void 0:G.chatMode)==="scene")&&h(G.chatMode),G!=null&&G.persona&&ge(G.persona)}const R=localStorage.getItem(Ae)||void 0,H=localStorage.getItem($e),W=H?parseFloat(H):void 0;R&&(L(R),ie(!0)),typeof W=="number"&&!isNaN(W)&&(D(W),U(!0));const K=localStorage.getItem(yt)||void 0;K&&X(K)}catch{}},[e.id]),m.useEffect(()=>{const E=`chat_session_${z}_${e.id}`,R=localStorage.getItem(E)||localStorage.getItem(`chat_session_${e.id}`);return(async()=>{var W;if(R){if(_(R),!localStorage.getItem(E))try{localStorage.setItem(E,R)}catch{}try{const G=await Ru(R);if((G==null?void 0:G.temperature)!==void 0){D(G.temperature);try{localStorage.setItem($e,String(G.temperature))}catch{}}}catch{}const K=os(R,(G,Y,Te)=>{V(G,Y,Te)});$.current=K;return}try{const K=localStorage.getItem("user_chat_role_id"),G=K?parseInt(K):void 0,Y=await Ss(e.id,typeof G=="number"?G:void 0),Te=Y.sessionId;if(localStorage.setItem(E,Te),_(Te),(W=Y.model)!=null&&W.id){L(Y.model.id);try{localStorage.setItem(Ae,Y.model.id)}catch{}}if(typeof Y.temperature=="number"){D(Y.temperature);try{localStorage.setItem($e,String(Y.temperature))}catch{}}const Qe=os(Te,(Wt,Gt,pa)=>{V(Wt,Gt,pa)});$.current=Qe}catch{}})(),()=>{var W;(W=$.current)==null||W.close(),$.current=null}},[e.id]);const F=E=>{h(E),E==="scene"?!f.includes("")&&!f.includes("(")?p(R=>`${R}`):f===""&&p(""):(f===""||f==="()")&&p("");try{localStorage.setItem(oe,JSON.stringify({chatMode:E,persona:s||void 0}))}catch{}},he=async()=>{var R,H;if(!f.trim()||f.trim()===""||f.trim()==="()")return;const E={id:Date.now().toString(),senderId:"user",text:f,timestamp:new Date,type:Fe.TEXT,read:!1};d(W=>[...W,E]);try{setTimeout(()=>r(E),0)}catch{}p(u==="scene"?"":""),y(!0);try{if(!A){const W=localStorage.getItem("user_chat_role_id"),K=W?parseInt(W):void 0,Y=(await Ss(e.id,typeof K=="number"?K:void 0)).sessionId;localStorage.setItem(`chat_session_${z}_${e.id}`,Y),_(Y);const Te=os(Y,(Qe,Wt,Gt)=>{V(Qe,Wt,Gt)});$.current=Te}(R=$.current)==null||R.sendText(E.text,u,C,ne?S:void 0,ce?O:void 0),(H=$.current)==null||H.sendTyping(!1)}catch(W){console.error(W),y(!1)}},fe=E=>E.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit",hour12:!1});return i.jsx(be.div,{className:"fixed inset-0 bg-primary-50 z-50",style:{height:"calc(var(--vh) * 100)",overscrollBehavior:"none"},initial:{x:(navigator==null?void 0:navigator.maxTouchPoints)>0?"100%":0},animate:{x:0},exit:{x:(navigator==null?void 0:navigator.maxTouchPoints)>0?"100%":0},transition:{duration:(navigator==null?void 0:navigator.maxTouchPoints)>0?.3:0,ease:"linear"},children:i.jsxs("div",{className:"mx-auto w-full max-w-md h-full flex flex-col relative bg-white shadow-2xl rounded-none md:rounded-3xl md:overflow-hidden",children:[i.jsx("div",{className:"bg-primary-50/95 backdrop-blur-md pt-[env(safe-area-inset-top)] shadow-none z-10 border-b border-white/50 flex-shrink-0",children:i.jsxs("div",{className:"px-4 h-12 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:n,className:"p-2 -ml-2 text-slate-800 hover:bg-black/5 rounded-full transition-colors",children:i.jsx(Ft,{size:24})}),i.jsx("div",{className:"flex items-center cursor-pointer active:opacity-70 transition-opacity",onClick:a,children:i.jsx("h2",{className:"font-bold text-slate-800 text-lg",children:b?"...":e.name})})]}),i.jsx("button",{onClick:()=>j(!0),className:"p-2 text-slate-800 hover:text-primary-600 rounded-full hover:bg-black/5 transition-all",children:i.jsx(_a,{size:24})})]})}),i.jsxs("div",{ref:q,className:"flex-1 overflow-y-auto p-4 space-y-4 no-scrollbar bg-primary-50",style:{overflowAnchor:"none"},children:[i.jsx("div",{className:"flex justify-center my-4",children:i.jsx("span",{className:"bg-black/10 text-white text-[10px] px-3 py-1 rounded-full font-medium",children:""})}),c.map((E,R)=>{const H=E.senderId==="user";return i.jsxs("div",{className:`flex w-full ${H?"justify-end":"justify-start"} mb-4 group`,children:[!H&&i.jsx("div",{className:"flex-shrink-0 mr-3 flex flex-col items-center gap-1",children:i.jsx("div",{onClick:a,className:"w-10 h-10 rounded-full overflow-hidden bg-blue-100 flex items-center justify-center text-blue-500 font-bold border border-white cursor-pointer active:scale-95 transition-transform",children:e.avatar?i.jsx("img",{src:e.avatar,alt:e.name,className:"w-full h-full object-cover"}):e.name[0]})}),i.jsxs("div",{className:`flex flex-col ${H?"items-end":"items-start"} max-w-[75%]`,children:[i.jsx("div",{className:`
                      px-4 py-3 text-[15px] shadow-sm leading-relaxed relative
                      ${H?"bg-[#A855F7] text-white rounded-[20px] rounded-tr-sm":"bg-white text-slate-800 rounded-[20px] rounded-tl-sm border border-slate-100"}
                    `,children:E.text}),!H&&E.quote&&i.jsx("div",{className:"mt-1 max-w-full",children:i.jsx("div",{className:"inline-block bg-slate-100 text-slate-500 text-xs leading-tight rounded-[12px] px-2 py-1 border border-slate-200",children:E.quote})}),i.jsxs("div",{className:`flex items-center gap-2 mt-1 ${H?"mr-1":"ml-1"}`,children:[H&&E.read&&i.jsx("span",{className:"text-[10px] text-slate-400",children:""}),i.jsx("span",{className:"text-[10px] text-slate-400",children:fe(E.timestamp)})]})]}),H&&i.jsx("div",{className:"flex-shrink-0 ml-3",children:i.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden bg-pink-200 flex items-center justify-center text-pink-600 font-bold border border-white shadow-sm",children:C!=null&&C.avatar?i.jsx("img",{src:C.avatar,alt:(C==null?void 0:C.name)||"",className:"w-full h-full object-cover"}):C!=null&&C.name?C.name[0]:""})})]},E.id)}),i.jsx("div",{ref:je})]}),i.jsx("div",{className:"bg-white p-3 pb-3 border-t border-slate-100 shadow-[0_-4px_20px_rgba(0,0,0,0.02)] pb-[env(safe-area-inset-bottom)] mb-3 flex-shrink-0",children:i.jsxs("div",{className:"flex items-center gap-2 bg-white rounded-[24px] px-3 py-2 border border-slate-100 shadow-[0_12px_28px_rgba(0,0,0,0.12)] transition-shadow focus-within:shadow-[0_16px_40px_rgba(0,0,0,0.16)]",children:[i.jsx("div",{className:"flex-1 flex items-center pl-2",children:i.jsx("textarea",{ref:N,value:f,onChange:E=>{var R;p(E.target.value),(R=$.current)==null||R.sendTyping(!0)},onKeyDown:E=>{E.key==="Enter"&&!E.shiftKey&&(E.preventDefault(),he())},onBlur:()=>{var E;return(E=$.current)==null?void 0:E.sendTyping(!1)},placeholder:"",className:"w-full bg-transparent border-none outline-none focus:ring-0 text-slate-700 text-sm p-0 resize-none max-h-24 overflow-y-auto leading-5 placeholder:text-slate-400",rows:1,style:{minHeight:"22px"}})}),i.jsx("button",{onClick:he,disabled:!f.trim()||f.trim()==="",className:`p-2 rounded-full transition-all duration-300 flex-shrink-0 flex items-center justify-center ${f.trim()&&f.trim()!==""?"bg-[#A855F7] text-white shadow-md active:scale-95":"bg-transparent text-[#A855F7]"}`,children:i.jsx(ga,{size:20,className:f.trim()&&f.trim()!==""?"ml-0.5":""})})]})}),i.jsx(Ge,{initial:!1,children:T&&i.jsxs(i.Fragment,{children:[i.jsx(be.div,{className:"absolute inset-0 bg-black/20 z-[60] will-change-opacity",onClick:()=>j(!1),initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:Kt}),i.jsxs(be.div,{className:"absolute top-0 right-0 h-full w-3/4 bg-white z-[70] shadow-2xl will-change-transform transform-gpu",initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:Pu,children:[i.jsxs("div",{className:"p-5 border-b border-slate-100 flex justify-between items-center",children:[i.jsx("h3",{className:"font-bold text-lg text-slate-800",children:""}),i.jsx("button",{onClick:()=>j(!1),className:"text-slate-400 hover:text-slate-600",children:i.jsx(Ct,{size:24})})]}),i.jsxs("div",{className:"p-2",children:[i.jsxs("button",{onClick:()=>{j(!1),x(!0)},className:"w-full flex items-center justify-between p-4 hover:bg-slate-50 rounded-xl transition-colors",children:[i.jsxs("div",{className:"flex items-center gap-3 text-slate-700",children:[i.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-50 flex items-center justify-center text-purple-600",children:i.jsx(Cs,{size:18})}),i.jsx("span",{className:"font-bold text-sm",children:""})]}),i.jsx(kt,{size:16,className:"text-slate-300"})]}),i.jsx("div",{className:"h-[1px] bg-slate-50 mx-4"}),i.jsxs("button",{onClick:()=>{j(!1),M(!0)},className:"w-full flex items-center justify-between p-4 hover:bg-slate-50 rounded-xl transition-colors",children:[i.jsxs("div",{className:"flex items-center gap-3 text-slate-700",children:[i.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-50 flex items-center justify-center text-purple-600",children:i.jsx(ya,{size:18})}),i.jsx("span",{className:"font-bold text-sm",children:""})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-xs text-slate-500",children:B||""}),i.jsx(kt,{size:16,className:"text-slate-300"})]})]}),i.jsx("div",{className:"h-[1px] bg-slate-50 mx-4"}),i.jsxs("div",{className:"w-full flex items-center justify-between p-4 hover:bg-slate-50 rounded-xl transition-colors",children:[i.jsxs("div",{className:"flex items-center gap-3 text-slate-700",children:[i.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-50 flex items-center justify-center text-purple-600",children:i.jsx(Wa,{size:18})}),i.jsx("span",{className:"font-bold text-sm",children:""})]}),i.jsxs("div",{className:"flex bg-slate-100 p-1 rounded-lg",children:[i.jsx("button",{onClick:()=>F("daily"),className:`px-3 py-1 text-xs font-bold rounded-md transition-all ${u==="daily"?"bg-white text-slate-800 shadow-sm":"text-slate-400"}`,children:""}),i.jsx("button",{onClick:()=>F("scene"),className:`px-3 py-1 text-xs font-bold rounded-md transition-all ${u==="scene"?"bg-white text-purple-600 shadow-sm":"text-slate-400"}`,children:""})]})]})]})]})]})}),g&&i.jsx(fa,{currentPersona:void 0,onBack:()=>v(!1),onSave:E=>{v(!1),x(!0)},withinContainer:!0}),i.jsx(Lu,{isOpen:w,currentPersona:s,onClose:()=>x(!1),onAdd:()=>{x(!1),v(!0)},onSelect:E=>{ge(E);try{localStorage.setItem(oe,JSON.stringify({chatMode:u,persona:E}))}catch{}}}),i.jsx(Fu,{isOpen:P,currentModelId:S,onClose:()=>M(!1),onSelect:(E,R)=>{L(E),ie(!0),X(R);try{localStorage.setItem(Ae,E),R&&localStorage.setItem(yt,R)}catch{}},temperature:O,onTempChange:E=>{D(E),U(!0);try{localStorage.setItem($e,String(E))}catch{}}})]})})},ma=m.createContext({showToast:()=>{},showCenter:()=>{}}),_i=({children:e})=>{const[t,s]=m.useState([]),n=m.useRef(new Map),r=(l,c)=>{const d=n.current.get(l);d&&clearTimeout(d);const u=window.setTimeout(()=>{s(h=>h.filter(f=>f.id!==l)),n.current.delete(l)},c);n.current.set(l,u)},o=(l,c="info")=>{const d=Date.now(),u=2e3;s(h=>[...h,{id:d,text:l,type:c,position:"bottom",duration:u}]),r(d,u)},a=l=>{s(d=>{const u=d.find(f=>f.position==="center"&&f.text===l);if(u)return r(u.id,3e3),d;const h=Date.now();return r(h,2e3),[...d,{id:h,text:l,type:"center",position:"center",duration:2e3}]})};return i.jsxs(ma.Provider,{value:{showToast:o,showCenter:a},children:[e,i.jsx("div",{className:"fixed bottom-6 left-0 right-0 z-[100] flex justify-center pointer-events-none",children:i.jsx("div",{className:"space-y-2",children:t.filter(l=>l.position==="bottom").map(l=>i.jsx("div",{className:`${l.type==="role"?"bg-white text-pink-600 border border-pink-200 shadow-md":l.type==="error"?"bg-red-500 text-white":l.type==="success"?"bg-green-500 text-white":"bg-slate-800 text-white"} px-4 py-2 rounded-2xl shadow-lg inline-block`,children:l.text},l.id))})}),i.jsx("div",{className:"fixed top-[25%] left-1/2 -translate-x-1/2 z-[100] pointer-events-none",children:i.jsx("div",{className:"space-y-2 flex flex-col items-center",children:t.filter(l=>l.position==="center").map(l=>i.jsx("div",{className:"bg-white text-slate-800 px-6 py-3 rounded-2xl shadow-2xl border border-slate-200 whitespace-nowrap",children:l.text},l.id))})}),i.jsx("style",{children:`
        @keyframes toastFade {
          0% { opacity: 0; transform: translateY(-6px); }
          10% { opacity: 1; transform: translateY(0); }
          90% { opacity: 1; transform: translateY(0); }
          100% { opacity: 0; transform: translateY(-6px); }
        }
      `})]})},Bu=()=>m.useContext(ma),$u=({character:e,onBack:t,onStartChat:s,isFromChat:n=!1,isExistingChat:r=!1})=>{const[o,a]=m.useState(!1),{showToast:l,showCenter:c}=Bu(),d=o?e.tags:e.tags.slice(0,4),u=e.tags.length>4;return i.jsx(be.div,{className:"fixed inset-0 z-50 bg-primary-50",initial:{x:(navigator==null?void 0:navigator.maxTouchPoints)>0?"100%":0},animate:{x:0},exit:{x:(navigator==null?void 0:navigator.maxTouchPoints)>0?"100%":0},transition:{duration:(navigator==null?void 0:navigator.maxTouchPoints)>0?.3:0,ease:"linear"},children:i.jsxs("div",{className:"mx-auto w-full max-w-md h-full flex flex-col bg-white shadow-2xl rounded-none md:rounded-3xl md:overflow-hidden relative",children:[i.jsx("button",{onClick:t,className:"absolute top-4 left-4 z-50 w-10 h-10 bg-black/20 backdrop-blur-sm rounded-full flex items-center justify-center text-white hover:bg-black/30 transition-all",children:i.jsx(Ft,{size:24})}),i.jsxs("div",{className:"flex-1 overflow-y-auto no-scrollbar relative pb-24",children:[i.jsxs("div",{className:"relative w-full h-[55vh]",children:[i.jsx("img",{src:e.profileImage||e.avatar,alt:e.name,className:"w-full h-full object-cover"}),i.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-900/60 via-transparent to-slate-900/10"}),i.jsxs("div",{className:"absolute bottom-12 left-6 right-6 z-10 text-white flex flex-col items-start space-y-1",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("h1",{className:"text-5xl font-bold tracking-wide",children:e.name}),i.jsxs("span",{className:"bg-white/20 backdrop-blur-md px-2 py-0.5 rounded-full text-[10px] border border-white/30 text-white flex items-center gap-1",children:[i.jsx("span",{className:"text-green-400",children:""})," ",e.roleType||""]})]}),i.jsxs("div",{className:"flex items-center text-white text-sm font-medium pl-1",children:[i.jsx("span",{children:e.profession}),i.jsx("span",{className:"mx-2 bg-white w-1 h-1 rounded-full"}),i.jsx("span",{children:e.age})]}),i.jsxs("div",{className:"text-white text-xs font-medium pl-1",children:["by ",e.creator]})]})]}),i.jsxs("div",{className:"relative -mt-6 bg-white rounded-t-none md:rounded-t-[32px] px-6 py-8 min-h-[50vh] z-10",children:[i.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:d.map((h,f)=>i.jsxs("span",{className:"px-4 py-1.5 rounded-full bg-purple-50 text-purple-600 text-sm font-bold shadow-sm",children:["# ",h]},f))}),u&&i.jsx("div",{className:"flex justify-center mb-8",children:i.jsxs("button",{onClick:()=>a(!o),className:"text-xs text-purple-300 flex items-center gap-1 font-bold hover:text-purple-400 transition-colors",children:[o?"":""," ",o?i.jsx(ks,{size:14}):i.jsx(Pt,{size:14})]})}),i.jsxs("div",{className:"mb-8",children:[i.jsx("h3",{className:"text-purple-500 font-bold text-sm mb-3",children:""}),i.jsxs("div",{className:"relative pl-4 py-1",children:[i.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 bg-purple-400 rounded-full"}),i.jsxs("div",{className:"bg-purple-50/50 p-4 rounded-r-xl text-slate-700 font-bold text-lg",children:["",e.oneLinePersona,""]})]})]}),i.jsxs("div",{className:"mb-8",children:[i.jsx("h3",{className:"text-purple-500 font-bold text-sm mb-3",children:""}),i.jsx("div",{className:"bg-slate-50 border border-slate-100 rounded-2xl p-5 text-slate-600 leading-7 text-justify text-sm",children:e.personality})]}),i.jsxs("div",{className:"mb-8",children:[i.jsx("h3",{className:"text-purple-500 font-bold text-sm mb-3",children:""}),i.jsx("div",{children:i.jsxs("span",{className:"inline-flex items-center gap-1 bg-pink-100 text-pink-500 px-3 py-1 rounded-full text-sm font-bold",children:[i.jsx(Ii,{size:12,fill:"currentColor"})," ",e.currentRelationship]})})]}),i.jsxs("div",{className:"mb-8",children:[i.jsx("h3",{className:"text-purple-900 font-extrabold text-lg mb-4",children:""}),i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx("span",{className:"bg-pink-400 text-white text-[10px] px-1.5 py-0.5 rounded font-bold",children:"THEME"}),i.jsx("span",{className:"bg-pink-50 text-pink-800 text-sm font-bold px-2 py-0.5 rounded",children:e.plotTheme})]}),i.jsx("div",{className:"bg-slate-50 border border-slate-100 rounded-2xl p-5 text-slate-600 leading-7 text-justify text-sm mb-4",children:e.plotDescription}),e.openingLine&&i.jsxs("div",{className:"bg-purple-50/50 rounded-2xl p-4 flex items-center",children:[i.jsx("span",{className:"text-purple-600 font-bold text-sm whitespace-nowrap mr-3",children:""}),i.jsx("div",{className:"h-4 w-[1px] bg-purple-200 mr-4"}),i.jsx("span",{className:"text-slate-700 font-bold text-sm",children:e.openingLine})]})]})]})]}),i.jsx("div",{className:"absolute bottom-3 inset-x-0 z-50",children:i.jsx("div",{className:"mx-auto w-full max-w-md bg-white/90 backdrop-blur-md border-t border-slate-100 p-4 pb-[env(safe-area-inset-bottom)]",children:i.jsx("button",{onClick:()=>{if(n){s();return}if(r){c("");return}s()},className:"w-full font-bold text-lg py-4 rounded-2xl shadow-lg active:scale-[0.98] transition-all flex items-center justify-center gap-2 bg-purple-200 text-purple-900 shadow-purple-100",children:n?i.jsxs(i.Fragment,{children:[i.jsx(Ps,{size:20}),""]}):""})})})]})})},Ei=async()=>{const{authFetch:e}=await re(async()=>{const{authFetch:n}=await import("./http-DqgzyhP5.js");return{authFetch:n}},__vite__mapDeps([0,1,2,3])),t=await e("/user-characters");if(!t.ok)throw new Error("failed");const s=await t.json();return Array.isArray(s.items)?s.items:[]},Ts=async e=>{const{authFetch:t}=await re(async()=>{const{authFetch:n}=await import("./http-DqgzyhP5.js");return{authFetch:n}},__vite__mapDeps([0,1,2,3])),s=await t(`/user-characters/${e}`);if(!s.ok)throw new Error("failed");return await s.json()},zu=async e=>{const{authFetch:t}=await re(async()=>{const{authFetch:r}=await import("./http-DqgzyhP5.js");return{authFetch:r}},__vite__mapDeps([0,1,2,3])),s=await t("/user-characters",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok)throw new Error("create_character_failed");return(await s.json()).id},Uu=async e=>{const{authFetch:t}=await re(async()=>{const{authFetch:r}=await import("./http-DqgzyhP5.js");return{authFetch:r}},__vite__mapDeps([0,1,2,3])),s=await t("/user-characters/draft",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok)throw new Error("create_draft_failed");return(await s.json()).id},Hu=async(e,t)=>{const{authFetch:s}=await re(async()=>{const{authFetch:r}=await import("./http-DqgzyhP5.js");return{authFetch:r}},__vite__mapDeps([0,1,2,3]));if(!(await s(`/user-characters/${e}/draft`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok)throw new Error("update_draft_failed");return!0},Ku=async(e,t)=>{const{authFetch:s}=await re(async()=>{const{authFetch:r}=await import("./http-DqgzyhP5.js");return{authFetch:r}},__vite__mapDeps([0,1,2,3]));if(!(await s(`/user-characters/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok)throw new Error("update_failed");return!0},Wu=async e=>{const{authFetch:t}=await re(async()=>{const{authFetch:n}=await import("./http-DqgzyhP5.js");return{authFetch:n}},__vite__mapDeps([0,1,2,3]));if(!(await t(`/user-characters/${e}`,{method:"DELETE"})).ok)throw new Error("delete_failed");return!0},Mi=({character:e,createdId:t,onBack:s,onStartChat:n,onEdit:r,onDeleted:o})=>{const[a,l]=m.useState(!1),[c,d]=m.useState(!0),[u,h]=m.useState(e),[f,p]=m.useState(!1),[b,y]=m.useState(!1),[T,j]=m.useState(!1);m.useEffect(()=>{let w=!0,x;const P=async()=>{try{const S=await Ts(t);if(!w)return;const L=typeof(S==null?void 0:S.status)=="string"?S.status.trim():"",O=!!(S!=null&&S.hasSystemPrompt);if(L==="draft"){y(!0),d(!1),x&&clearInterval(x);return}if(L==="publishing"||!O){y(!1),d(!1);return}if(S&&(L==="published"||O)){d(!0),y(!1),h(D=>({...D,id:String(S.id||D.id),name:S.name||D.name,avatar:S.avatar||D.avatar,profileImage:D.profileImage,oneLinePersona:S.tagline||D.oneLinePersona,personality:S.personality||D.personality,profession:String(S.occupation||D.profession||""),age:String(S.age||D.age||""),currentRelationship:String(S.relationship||D.currentRelationship||""),plotTheme:String(S.plot_theme||D.plotTheme||""),plotDescription:String(S.plot_summary||D.plotDescription||""),openingLine:String(S.opening_line||D.openingLine||"")})),x&&clearInterval(x);return}}catch{}};return(async()=>{try{const S=await Ts(t);if(!w)return;if(S){h(D=>({...D,id:String(S.id||D.id),name:S.name||D.name,avatar:S.avatar||D.avatar,oneLinePersona:S.tagline||D.oneLinePersona,personality:S.personality||D.personality,profession:String(S.occupation||D.profession||""),age:String(S.age||D.age||""),currentRelationship:String(S.relationship||D.currentRelationship||""),plotTheme:String(S.plot_theme||D.plotTheme||""),plotDescription:String(S.plot_summary||D.plotDescription||""),openingLine:String(S.opening_line||D.openingLine||"")}));const L=!!S.hasSystemPrompt,O=typeof S.status=="string"?S.status.trim():"";if(O==="draft"){y(!0),d(!1);return}if(O==="publishing"){y(!1),d(!1),x=setInterval(P,3e3),P();return}if(!L){y(!1),d(!1),x=setInterval(P,3e3),P();return}y(!1),d(!0);return}y(!1),d(!0)}catch{y(!1),d(!0)}})(),()=>{w=!1,clearInterval(x)}},[t]);const g=a?u.tags:u.tags.slice(0,4),v=u.tags.length>4;return i.jsxs(be.div,{className:"fixed inset-0 z-50 bg-primary-50",initial:{x:(navigator==null?void 0:navigator.maxTouchPoints)>0?"100%":0},animate:{x:0},exit:{x:(navigator==null?void 0:navigator.maxTouchPoints)>0?"100%":0},transition:{duration:(navigator==null?void 0:navigator.maxTouchPoints)>0?.3:0,ease:"linear"},children:[i.jsxs("div",{className:"mx-auto w-full max-w-md h-full flex flex-col bg shadow-2xl rounded-none md:rounded-3xl md:overflow-hidden relative",children:[i.jsx("button",{onClick:s,className:"absolute top-4 left-4 z-50 w-10 h-10 bg-black/20 backdrop-blur-sm rounded-full flex items-center justify-center text-white hover:bg-black/30 transition-all",children:i.jsx(Ft,{size:24})}),i.jsx("button",{onClick:()=>r==null?void 0:r(u),className:"absolute top-4 right-4 z-50 w-10 h-10 bg-black/40 text-white rounded-full flex items-center justify-center hover:bg-black/60 transition-all border border-white/30",children:i.jsx(Li,{size:20})}),i.jsx("button",{disabled:f,onClick:()=>j(!0),className:`absolute top-16 right-4 z-50 w-10 h-10 bg-black/40 text-white rounded-full flex items-center justify-center hover:bg-black/60 transition-all border border-white/30 ${f?"opacity-60 cursor-not-allowed":""}`,children:i.jsx(va,{size:18,className:"text-red-500"})}),i.jsxs("div",{className:"flex-1 overflow-y-auto no-scrollbar relative pb-24",children:[i.jsxs("div",{className:"relative w-full h-[55vh]",children:[i.jsx("img",{src:u.profileImage||u.avatar,alt:u.name,className:"w-full h-full object-cover"}),i.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-900/60 via-transparent to-slate-900/10"}),i.jsxs("div",{className:"absolute bottom-12 left-6 right-6 z-10 text-white flex flex-col items-start space-y-1",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("h1",{className:"text-5xl font-bold tracking-wide",children:u.name}),i.jsxs("span",{className:"bg-white/20 backdrop-blur-md px-2 py-0.5 rounded-full text-[10px] border border-white/30 text-white flex items-center gap-1",children:[i.jsx("span",{className:"text-green-400",children:""})," ",u.roleType||""]})]}),i.jsxs("div",{className:"flex items-center text-white text-sm font-medium pl-1",children:[i.jsx("span",{children:u.profession}),i.jsx("span",{className:"mx-2 bg-white w-1 h-1 rounded-full"}),i.jsx("span",{children:u.age})]}),i.jsxs("div",{className:"text-white text-xs font-medium pl-1",children:["by ",u.creator]})]})]}),i.jsxs("div",{className:"relative -mt-6 bg-white rounded-t-none md:rounded-t-[32px] px-6 py-8 min-h-[50vh] z-10",children:[i.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:g.map((w,x)=>i.jsxs("span",{className:"px-4 py-1.5 rounded-full bg-purple-50 text-purple-600 text-sm font-bold shadow-sm",children:["# ",w]},x))}),v&&i.jsx("div",{className:"flex justify-center mb-8",children:i.jsxs("button",{onClick:()=>l(!a),className:"text-xs text-purple-300 flex items-center gap-1 font-bold hover:text-purple-400 transition-colors",children:[a?"":""," ",a?i.jsx(ks,{size:14}):i.jsx(Pt,{size:14})]})}),i.jsxs("div",{className:"mb-8",children:[i.jsx("h3",{className:"text-purple-500 font-bold text-sm mb-3",children:""}),i.jsxs("div",{className:"relative pl-4 py-1",children:[i.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 bg-purple-400 rounded-full"}),i.jsxs("div",{className:"bg-purple-50/50 p-4 rounded-r-xl text-slate-700 font-bold text-lg",children:["",u.oneLinePersona,""]})]})]}),i.jsxs("div",{className:"mb-8",children:[i.jsx("h3",{className:"text-purple-500 font-bold text-sm mb-3",children:""}),i.jsx("div",{className:"bg-slate-50 border border-slate-100 rounded-2xl p-5 text-slate-600 leading-7 text-justify text-sm",children:u.personality})]}),i.jsxs("div",{className:"mb-8",children:[i.jsx("h3",{className:"text-purple-500 font-bold text-sm mb-3",children:""}),i.jsx("div",{children:i.jsxs("span",{className:"inline-flex items-center gap-1 bg-pink-100 text-pink-500 px-3 py-1 rounded-full text-sm font-bold",children:[i.jsx(Ii,{size:12,fill:"currentColor"})," ",u.currentRelationship]})})]}),i.jsxs("div",{className:"mb-8",children:[i.jsx("h3",{className:"text-purple-900 font-extrabold text-lg mb-4",children:""}),i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx("span",{className:"bg-pink-400 text-white text-[10px] px-1.5 py-0.5 rounded font-bold",children:"THEME"}),i.jsx("span",{className:"bg-pink-50 text-pink-800 text-sm font-bold px-2 py-0.5 rounded",children:u.plotTheme})]}),i.jsx("div",{className:"bg-slate-50 border border-slate-100 rounded-2xl p-5 text-slate-600 leading-7 text-justify text-sm mb-4",children:u.plotDescription}),u.openingLine&&i.jsxs("div",{className:"bg-purple-50/50 rounded-2xl p-4 flex items-center",children:[i.jsx("span",{className:"text-purple-600 font-bold text-sm whitespace-nowrap mr-3",children:""}),i.jsx("div",{className:"h-4 w-[1px] bg-purple-200 mr-4"}),i.jsx("span",{className:"text-slate-700 font-bold text-sm",children:u.openingLine})]})]})]})]}),i.jsx("div",{className:"absolute bottom-3 inset-x-0 z-50",children:i.jsx("div",{className:"mx-auto w-full max-w-md bg-white/90 backdrop-blur-md border-t border-slate-100 p-4 pb-[env(safe-area-inset-bottom)]",children:i.jsx("button",{disabled:!c||b,onClick:()=>n(u),className:`w-full font-bold text-lg py-4 rounded-2xl shadow-lg transition-all flex items-center justify-center gap-2 ${c&&!b?"bg-purple-200 text-purple-900 shadow-purple-100 active:scale-[0.98]":"bg-slate-200 text-slate-500 cursor-not-allowed"}`,children:c&&!b?i.jsxs(i.Fragment,{children:[i.jsx(Ps,{size:20}),""]}):b?"":""})})})]}),T&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 z-[80] bg/20 animate-[fadeBg_200ms_ease]"}),i.jsx("div",{className:"fixed inset-0 z-[90] flex items-center justify-center",onClick:()=>!f&&j(!1),children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl border border-slate-200 w-[85%] max-w-sm animate-[fadeCard_200ms_ease]",onClick:w=>w.stopPropagation(),children:[i.jsx("div",{className:"px-6 py-5 text-center text-slate-800 font-bold",children:""}),i.jsx("div",{className:"h-[1px] bg-slate-100"}),i.jsxs("div",{className:"flex",children:[i.jsx("button",{disabled:f,className:"flex-1 py-4 text-slate-600 active:opacity-70",onClick:()=>{f||j(!1)},children:""}),i.jsx("div",{className:"w-[1px] bg-slate-100"}),i.jsx("button",{disabled:f,className:"flex-1 py-4 text-red-600 font-bold active:opacity-70",onClick:async()=>{if(!f)try{p(!0),await Wu(t),j(!1),o?o():s()}catch{p(!1)}},children:""})]})]})}),i.jsx("style",{children:`
            @keyframes fadeCard { from { opacity: 0; transform: translateY(-6px) } to { opacity: 1; transform: translateY(0) } }
            @keyframes fadeBg { from { opacity: 0 } to { opacity: 1 } }
          `})]})]})},Gu=({onBack:e,onCreate:t,isEdit:s=!1,characterId:n,initial:r,onUpdated:o})=>{const[a,l]=m.useState({type:"",avatar:"",profileImage:"",name:"",gender:"",age:"",profession:"",tagline:"",personality:"",searchTags:[],relationship:"",plotTheme:"",plotSummary:"",openingLine:"",styleExamples:["","",""],hobbies:"",experiences:"",isPublic:!0}),[c,d]=m.useState(!1),[u,h]=m.useState(!0),[f,p]=m.useState(!1),[b,y]=m.useState(""),[T,j]=m.useState(!1),[g,v]=m.useState({}),[w,x]=m.useState(!1),[P,M]=m.useState(null),S=m.useRef(null),L=N=>{var oe;const A=N.split(","),_=((oe=A[0].match(/:(.*?);/))==null?void 0:oe[1])||"image/jpeg",$=atob(A[1]);let z=$.length;const me=new Uint8Array(z);for(;z--;)me[z]=$.charCodeAt(z);return new Blob([me],{type:_})};m.useEffect(()=>{r&&l(A=>({...A,type:r.roleType||A.type,avatar:r.avatar||A.avatar,profileImage:r.profileImage||A.profileImage,name:r.name||A.name,gender:r.gender||A.gender,age:r.age||A.age,profession:r.profession||A.profession,tagline:r.oneLinePersona||A.tagline,personality:r.personality||A.personality,relationship:r.currentRelationship||A.relationship,plotTheme:r.plotTheme||A.plotTheme,plotSummary:r.plotDescription||A.plotSummary,openingLine:r.openingLine||A.openingLine,styleExamples:Array.isArray(r.styleExamples)&&r.styleExamples.length?r.styleExamples:A.styleExamples,hobbies:r.hobbies||A.hobbies,experiences:r.experiences||A.experiences,searchTags:Array.isArray(r.tags)?r.tags:A.searchTags,isPublic:typeof r.isPublic=="boolean"?r.isPublic:A.isPublic}));const N=localStorage.getItem("create_character_draft");if(N&&!s)try{const A=JSON.parse(N);l(_=>({..._,...A}))}catch(A){console.error("Failed to load draft",A)}},[r,s]),m.useEffect(()=>{if(!s||!n)return;const N=!(r&&Array.isArray(r.tags)&&r.tags.length),A=!(r&&Array.isArray(r.styleExamples)&&r.styleExamples.length);!N&&!A||(async()=>{try{const _=await Ts(n),$=Array.isArray(_==null?void 0:_.styleExamples)?_.styleExamples.slice(0,3):[];for(;$.length<3;)$.push("");l(z=>({...z,name:(_==null?void 0:_.name)??z.name,gender:(_==null?void 0:_.gender)??z.gender,avatar:(_==null?void 0:_.avatar)??z.avatar,tagline:(_==null?void 0:_.tagline)??z.tagline,personality:(_==null?void 0:_.personality)??z.personality,relationship:(_==null?void 0:_.relationship)??z.relationship,plotTheme:(_==null?void 0:_.plot_theme)??z.plotTheme,plotSummary:(_==null?void 0:_.plot_summary)??z.plotSummary,openingLine:(_==null?void 0:_.opening_line)??z.openingLine,hobbies:(_==null?void 0:_.hobbies)??z.hobbies,experiences:(_==null?void 0:_.experiences)??z.experiences,age:(_==null?void 0:_.age)!=null?String(_.age):z.age,profession:(_==null?void 0:_.occupation)??z.profession,searchTags:Array.isArray(_==null?void 0:_.tags)?_.tags:z.searchTags,styleExamples:$,isPublic:_!=null&&_.visibility?_.visibility==="public":z.isPublic}))}catch{}})()},[s,n,r]);const O=["","",""],D=["","","","",""],B=["M/M","M/F","BL","BG","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],X=()=>{var N;(N=S.current)==null||N.click()},ne=N=>{var _;const A=(_=N.target.files)==null?void 0:_[0];if(A){const $=new FileReader;$.onloadend=()=>{M($.result)},$.readAsDataURL(A)}S.current&&(S.current.value="")},ie=N=>{a.searchTags.includes(N)?l(A=>({...A,searchTags:A.searchTags.filter(_=>_!==N)})):l(A=>({...A,searchTags:[...A.searchTags,N]}))},ce=()=>{const N=b.trim();N&&!a.searchTags.includes(N)&&(l(A=>({...A,searchTags:[...A.searchTags,N]})),y(""))},U=async N=>{if(N){try{const A=localStorage.getItem("user_access_token");let _=a.avatar||null;if(_&&_.startsWith("data:image")){const z=L(_),me=new FormData,oe=`${Date.now()}_${Math.random().toString(36).slice(2,8)}.jpg`;me.append("avatar",z,"avatar.jpg"),me.append("filename",oe),_=`/uploads/users/avatars/${oe}`;try{await fetch("/api/uploads/avatar",{method:"POST",headers:{Authorization:A?`Bearer ${A}`:""},body:me})}catch{}}const $={name:a.name||"",gender:a.gender,avatar:_,identity:null,tagline:a.tagline,personality:a.personality,relationship:a.relationship,plotTheme:a.plotTheme,plotSummary:a.plotSummary,openingLine:a.openingLine,hobbies:a.hobbies,experiences:a.experiences,age:a.age&&parseInt(a.age,10)||null,occupation:a.profession,character_type:a.type,visibility:a.isPublic?"public":"private",tags:a.searchTags,styleExamples:a.styleExamples.filter(Boolean)};s&&n?await Hu(n,$):await Uu($)}catch{}localStorage.setItem("create_character_draft",JSON.stringify(a))}else localStorage.removeItem("create_character_draft"),l({type:"",avatar:"",profileImage:"",name:"",gender:"",age:"",profession:"",tagline:"",personality:"",searchTags:[],relationship:"",plotTheme:"",plotSummary:"",openingLine:"",styleExamples:["","",""],hobbies:"",experiences:"",isPublic:!0});j(!1)},te=()=>{const N={};return a.name.trim()||(N.name=!0),a.age.trim()||(N.age=!0),a.profession.trim()||(N.profession=!0),a.tagline.trim()||(N.tagline=!0),a.personality.trim()||(N.personality=!0),a.searchTags.length===0&&(N.searchTags=!0),a.relationship.trim()||(N.relationship=!0),a.plotTheme.trim()||(N.plotTheme=!0),a.plotSummary.trim()||(N.plotSummary=!0),a.openingLine.trim()||(N.openingLine=!0),v(N),Object.keys(N).length===0},ge=async()=>{if(!te()){x(!0);return}let N=null;try{const _=localStorage.getItem("user_access_token");let $=a.avatar||null;if($&&$.startsWith("data:image")){const me=L($),oe=new FormData,Ae=`${Date.now()}_${Math.random().toString(36).slice(2,8)}.jpg`;oe.append("avatar",me,"avatar.jpg"),oe.append("filename",Ae),$=`/uploads/users/avatars/${Ae}`;try{await fetch("/api/uploads/avatar",{method:"POST",headers:{Authorization:_?`Bearer ${_}`:""},body:oe})}catch{}}const z={name:a.name,gender:a.gender,avatar:$,identity:null,tagline:a.tagline,personality:a.personality,relationship:a.relationship,plotTheme:a.plotTheme,plotSummary:a.plotSummary,openingLine:a.openingLine,hobbies:a.hobbies,experiences:a.experiences,age:a.age&&parseInt(a.age,10)||null,occupation:a.profession,character_type:a.type,visibility:a.isPublic?"public":"private",tags:a.searchTags,styleExamples:a.styleExamples.filter(Boolean)};s&&n?(await Ku(n,z),N=typeof n=="number"?n:parseInt(String(n))||null):N=await zu(z)}catch{}const A={id:N?String(N):`c_${Date.now()}`,name:a.name,avatar:a.avatar||"https://image.pollinations.ai/prompt/anime%20silhouette%20purple?width=400&height=400&nologo=true",profileImage:a.profileImage||a.avatar,status:lt.ONLINE,bio:`${a.age} ${a.profession}`,tags:a.searchTags,isPinned:!1,relationshipLevel:0,creator:"",playCount:"0",age:a.age||"",profession:a.profession||"",gender:a.gender,roleType:a.type,isOriginal:a.type==="",oneLinePersona:a.tagline,personality:a.personality,currentRelationship:a.relationship,plotTheme:a.plotTheme,plotDescription:a.plotSummary,openingLine:a.openingLine,styleExamples:a.styleExamples.filter(_=>_),hobbies:a.hobbies,experiences:a.experiences,isPublic:a.isPublic};localStorage.removeItem("create_character_draft"),s&&o?o(A):t(A)},je=N=>["","",""][N],q="field-label font-kosugi mb-3 text-slate-700 font-bold text-sm block";return i.jsx("div",{className:"fixed inset-0 bg-white z-[60]",children:i.jsxs("div",{className:"mx-auto w-full max-w-md h-full relative flex flex-col overflow-hidden rounded-3xl shadow-2xl bg font-kosugi",children:[P&&i.jsx(hn,{imageSrc:P,onCancel:()=>{M(null),S.current&&(S.current.value="")},onCrop:N=>{l(A=>({...A,avatar:N,profileImage:P})),M(null)}}),i.jsx("div",{className:"ambient-bg hidden"}),i.jsxs("div",{className:"hidden",children:[i.jsx("div",{className:"star",style:{left:"10%",width:"4px",height:"4px"}}),i.jsx("div",{className:"star",style:{left:"80%",animationDelay:"2s",width:"6px",height:"6px"}})]}),i.jsxs("div",{className:"sticky top-0 z-50 bg-white px-4 py-3 flex items-center border-b border-slate-100 rounded-t-3xl relative",children:[i.jsx("button",{onClick:e,className:"w-8 h-8 flex items-center justify-center text-purple-800 hover:bg-purple-100 rounded-full transition",children:i.jsx(Lt,{size:20})}),i.jsx("h1",{className:"absolute left-1/2 -translate-x-1/2 text-xl font-bold text-purple-900 font-kosugi",children:s?"":""}),!s&&i.jsx("button",{onClick:()=>j(!0),className:"ml-auto text-sm font-bold text-purple-600 font-kosugi",children:""})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto no-scrollbar pb-28 px-4 space-y-6",children:[i.jsxs("section",{className:"mt-4",children:[i.jsx("div",{className:"text-[#2E1065] font-bold text-[0.9rem] mb-2 ml-1 font-kosugi",children:""}),i.jsx("div",{className:"flex gap-2 overflow-x-auto no-scrollbar pb-1 mt-2",children:O.map(N=>i.jsx("button",{onClick:()=>l(A=>({...A,type:N})),className:`
                                flex-shrink-0 px-5 py-2.5 rounded-2xl text-sm font-bold transition-all whitespace-nowrap tracking-wide font-kosugi
                                ${a.type===N?"bg-purple-500 text-white shadow-purple-200 shadow-md":"bg-white/70 text-slate-500 border-transparent"}
                            `,children:N},N))})]}),i.jsxs("section",{className:"flex flex-col items-center py-2",children:[i.jsxs("div",{onClick:X,className:"relative group cursor-pointer active:scale-95 transition-transform",children:[i.jsx("div",{className:"w-24 h-24 rounded-full bg-white border-[3px] border-white shadow-xl flex items-center justify-center overflow-hidden relative",children:a.avatar?i.jsx("img",{src:a.avatar,className:"w-full h-full object-cover",alt:"avatar"}):i.jsx("div",{className:"text-purple-200 text-3xl",children:i.jsx(Vi,{size:32})})}),i.jsx("div",{className:"absolute bottom-0 right-0 bg-purple-500 text-white w-8 h-8 rounded-full flex items-center justify-center border-[3px] border-white shadow-md",children:i.jsx(It,{size:14})})]}),i.jsx("input",{type:"file",ref:S,className:"hidden",accept:"image/*",onChange:ne}),i.jsx("p",{className:"mt-2 text-xs text-purple-400 font-bold tracking-wide font-kosugi",children:""})]}),i.jsxs("section",{className:"glass-card p-6 space-y-6",children:[i.jsx("div",{className:"section-title !font-kosugi !text-purple-900 mb-2",children:""}),i.jsxs("div",{children:[i.jsxs("label",{className:`${q} flex items-center gap-1`,children:["",g.name&&i.jsx("span",{className:"text-red-500 text-[10px] font-normal ml-1",children:""})]}),i.jsx("div",{className:"relative",children:i.jsx("input",{value:a.name,onChange:N=>l(A=>({...A,name:N.target.value})),type:"text",placeholder:"",className:`dream-input w-full px-4 py-3 text-sm font-bold ${g.name?"border-red-300 bg-red-50":""}`})})]}),i.jsxs("div",{children:[i.jsx("label",{className:q,children:""}),i.jsx("div",{className:"flex gap-3",children:["","",""].map(N=>i.jsx("button",{onClick:()=>l(A=>({...A,gender:N})),className:`flex-1 py-2.5 rounded-2xl text-sm font-bold transition font-kosugi ${a.gender===N?N===""?"bg-blue-100 text-blue-600 ring-2 ring-blue-200":N===""?"bg-pink-100 text-pink-600 ring-2 ring-pink-200":"bg-purple-100 text-purple-600 ring-2 ring-purple-200":"bg-white/50 text-slate-400"}`,children:N},N))})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"w-full",children:[i.jsxs("label",{className:`${q} flex items-center gap-1`,children:["",g.age&&i.jsx("span",{className:"text-red-500 text-[10px] font-normal ml-1",children:""})]}),i.jsx("input",{value:a.age,onChange:N=>l(A=>({...A,age:N.target.value})),type:"text",placeholder:"28",className:`dream-input w-full px-4 py-3 text-sm font-bold rounded-2xl ${g.age?"border-red-300 bg-red-50":""}`})]}),i.jsxs("div",{className:"w-full",children:[i.jsxs("label",{className:`${q} flex items-center gap-1`,children:["",g.profession&&i.jsx("span",{className:"text-red-500 text-[10px] font-normal ml-1",children:""})]}),i.jsx("input",{value:a.profession,onChange:N=>l(A=>({...A,profession:N.target.value})),type:"text",placeholder:"",className:`dream-input w-full px-4 py-3 text-sm font-bold rounded-2xl ${g.profession?"border-red-300 bg-red-50":""}`})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:`${q} flex items-center gap-1`,children:["",g.tagline&&i.jsx("span",{className:"text-red-500 text-[10px] font-normal ml-1",children:""})]}),i.jsx("input",{value:a.tagline,onChange:N=>l(A=>({...A,tagline:N.target.value})),type:"text",placeholder:"",className:`dream-input w-full px-4 py-3 text-sm ${g.tagline?"border-red-300 bg-red-50":""}`})]}),i.jsxs("div",{children:[i.jsxs("label",{className:`${q} flex items-center gap-1`,children:["",g.personality&&i.jsx("span",{className:"text-red-500 text-[10px] font-normal ml-1",children:""})]}),i.jsx("textarea",{value:a.personality,onChange:N=>l(A=>({...A,personality:N.target.value})),rows:3,placeholder:"...",className:`dream-input w-full px-4 py-3 text-sm resize-none ${g.personality?"border-red-300 bg-red-50":""}`})]}),i.jsxs("div",{children:[i.jsxs("label",{className:`${q} flex items-center gap-1`,children:["",g.searchTags&&i.jsx("span",{className:"text-red-500 text-[10px] font-normal ml-1",children:""})]}),i.jsxs("div",{onClick:()=>p(!0),className:`dream-input w-full px-3 py-2 min-h-[46px] flex flex-wrap gap-2 items-center bg-white/60 cursor-pointer hover:bg-white/80 transition ${g.searchTags?"border-red-300 bg-red-50":""}`,children:[a.searchTags.length===0&&i.jsx("span",{className:"text-xs text-[#B3A4C8] ml-1",children:" (# #...)"}),a.searchTags.map(N=>i.jsxs("span",{className:"tag-pill px-2 py-1 flex items-center shadow-sm",children:["#",N,i.jsx(Ct,{size:12,className:"ml-1 opacity-60 hover:opacity-100 cursor-pointer",onClick:A=>{A.stopPropagation(),ie(N)}})]},N)),i.jsx(kt,{className:"ml-auto text-purple-300",size:16})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:`${q} flex items-center gap-1`,children:["",g.relationship&&i.jsx("span",{className:"text-red-500 text-[10px] font-normal ml-1",children:""})]}),i.jsxs("div",{className:"flex flex-wrap gap-2 mb-2",children:[i.jsx("button",{onClick:()=>{d(!0),l(N=>({...N,relationship:""}))},className:`px-4 py-2 rounded-xl text-xs font-bold transition-all font-kosugi ${c?"bg-purple-500 text-white shadow-md":"bg-white text-slate-500 border border-purple-100"}`,children:""}),D.map(N=>i.jsx("button",{onClick:()=>{d(!1),l(A=>({...A,relationship:N}))},className:`px-4 py-2 rounded-xl text-xs font-bold transition-all font-kosugi ${a.relationship===N&&!c?"bg-purple-500 text-white shadow-md":"bg-white text-slate-500 border border-purple-100"}`,children:N},N))]}),c&&i.jsx("div",{className:"relative animate-in fade-in",children:i.jsx("input",{value:a.relationship,onChange:N=>l(A=>({...A,relationship:N.target.value})),type:"text",placeholder:"",className:`dream-input w-full px-4 py-2 text-sm ${g.relationship?"border-red-300 bg-red-50":""}`})})]})]}),i.jsxs("section",{className:"glass-card p-6 space-y-5",children:[i.jsx("div",{className:"section-title !font-kosugi !text-purple-900 mb-4",children:""}),i.jsxs("p",{className:"text-xs text-slate-500 leading-relaxed bg-purple-50/50 p-3 rounded-xl border border-purple-100 flex gap-1",children:[i.jsx(ba,{size:14,className:"text-purple-400 mt-0.5 flex-shrink-0"}),i.jsx("span",{children:""})]}),i.jsxs("div",{className:"bg-white/40 p-4 rounded-3xl border border-purple-100/50 space-y-4",children:[i.jsxs("div",{className:"relative group/input",children:[i.jsxs("label",{className:"text-xs font-bold text-slate-600 mb-2 flex items-center gap-1 font-kosugi",children:["",g.plotTheme&&i.jsx("span",{className:"text-red-500 text-[10px] font-normal",children:""})]}),i.jsx("input",{value:a.plotTheme,onChange:N=>l(A=>({...A,plotTheme:N.target.value})),type:"text",placeholder:"",className:`dream-input w-full px-3 py-2.5 rounded-xl text-sm bg-white/80 ${g.plotTheme?"border-red-300 bg-red-50":""}`})]}),i.jsxs("div",{className:"relative group/input",children:[i.jsxs("label",{className:"text-xs font-bold text-slate-600 mb-2 flex items-center gap-1 font-kosugi",children:["",g.plotSummary&&i.jsx("span",{className:"text-red-500 text-[10px] font-normal",children:""})]}),i.jsx("textarea",{value:a.plotSummary,onChange:N=>l(A=>({...A,plotSummary:N.target.value})),rows:5,placeholder:"......",className:`dream-input w-full px-3 py-2.5 rounded-xl text-sm bg-white/80 resize-none leading-relaxed ${g.plotSummary?"border-red-300 bg-red-50":""}`})]}),i.jsxs("div",{className:"relative group/input",children:[i.jsxs("label",{className:"text-xs font-bold text-slate-600 mb-2 flex items-center gap-1 font-kosugi",children:["",g.openingLine&&i.jsx("span",{className:"text-red-500 text-[10px] font-normal",children:""})]}),i.jsx("textarea",{value:a.openingLine,onChange:N=>l(A=>({...A,openingLine:N.target.value})),rows:2,placeholder:"",className:`dream-input w-full px-3 py-2.5 rounded-xl text-sm bg-white/80 resize-none ${g.openingLine?"border-red-300 bg-red-50":""}`})]})]})]}),i.jsxs("section",{className:"glass-card p-0 overflow-hidden transition-all",children:[i.jsxs("button",{onClick:()=>h(!u),className:"w-full flex items-center justify-between p-6 bg-transparent transition",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"section-title !font-kosugi !text-purple-900 mb-0",children:""}),i.jsx("span",{className:"text-[10px] bg-purple-100 text-purple-500 px-1.5 py-0.5 rounded font-bold border border-purple-200 self-center font-kosugi",children:""})]}),u?i.jsx(ks,{className:"text-purple-400"}):i.jsx(Pt,{className:"text-purple-400"})]}),u&&i.jsxs("div",{className:"p-6 pt-0 space-y-5 animate-in slide-in-from-top-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:q,children:""}),i.jsx("div",{className:"space-y-3",children:[0,1,2].map(N=>i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("span",{className:"text-xs font-bold text-purple-300 w-4 font-mono",children:["0",N+1]}),i.jsx("input",{value:a.styleExamples[N],onChange:A=>{const _=[...a.styleExamples];_[N]=A.target.value,l($=>({...$,styleExamples:_}))},type:"text",placeholder:je(N),className:"dream-input flex-1 px-3 py-2.5 rounded-xl text-sm"})]},N))})]}),i.jsxs("div",{children:[i.jsx("label",{className:q,children:""}),i.jsx("textarea",{value:a.hobbies,onChange:N=>l(A=>({...A,hobbies:N.target.value})),rows:2,placeholder:"...",className:"dream-input w-full px-4 py-3 text-sm resize-none"})]}),i.jsxs("div",{children:[i.jsx("label",{className:q,children:""}),i.jsx("textarea",{value:a.experiences,onChange:N=>l(A=>({...A,experiences:N.target.value})),rows:2,placeholder:"",className:"dream-input w-full px-4 py-3 text-sm resize-none"})]}),i.jsxs("div",{className:"pt-2 border-t border-purple-100",children:[i.jsx("label",{className:`${q} mb-1`,children:""}),i.jsx("p",{className:"text-[10px] text-slate-500 leading-tight mb-3",children:""}),i.jsxs("div",{className:"flex gap-3",children:[i.jsxs("button",{onClick:()=>l(N=>({...N,isPublic:!0})),className:`flex-1 py-2.5 rounded-2xl text-sm font-bold transition flex items-center justify-center gap-1 font-kosugi ${a.isPublic?"bg-purple-500 text-white shadow-md":"bg-white text-slate-500 border border-purple-100"}`,children:[i.jsx(Ia,{size:14})," "]}),i.jsxs("button",{onClick:()=>l(N=>({...N,isPublic:!1})),className:`flex-1 py-2.5 rounded-2xl text-sm font-bold transition flex items-center justify-center gap-1 font-kosugi ${a.isPublic?"bg-white text-slate-500 border border-purple-100":"bg-purple-500 text-white shadow-md"}`,children:[i.jsx($a,{size:14})," "]})]})]})]})]})]}),i.jsx("div",{className:"absolute bottom-0 inset-x-0 mx-auto w-full max-w-md bg-white/90 backdrop-blur-md p-4 z-50 border-t border-purple-50 rounded-b-3xl shadow-2xl",children:i.jsx("button",{onClick:ge,className:"w-full bg-gradient-to-r from-purple-500 to-indigo-500 text-white font-bold py-3.5 rounded-2xl shadow-lg shadow-purple-300 active:scale-95 transition-transform flex items-center justify-center tracking-widest text-lg font-kosugi",children:s?"":""})}),f&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 bg-black/30 backdrop-blur-[2px] z-[61]",onClick:()=>p(!1)}),i.jsxs("div",{className:"fixed bottom-0 left-0 w-full bg-white rounded-t-[30px] z-[62] shadow-[0_-10px_40px_rgba(0,0,0,0.1)] flex flex-col h-[80vh] animate-in slide-in-from-bottom duration-300",children:[i.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-purple-50 bg-white rounded-t-[30px]",children:[i.jsx("button",{onClick:()=>p(!1),className:"w-8 h-8 rounded-full bg-purple-50 text-purple-800 flex items-center justify-center",children:i.jsx(Pt,{size:20})}),i.jsx("h3",{className:"text-lg font-bold text-purple-900 font-kosugi",children:" #"}),i.jsx("button",{onClick:()=>p(!1),className:"text-sm font-bold text-purple-600 bg-purple-50 px-3 py-1 rounded-full font-kosugi",children:""})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-5 pb-10",children:[i.jsxs("div",{className:"mb-4",children:[i.jsx("div",{className:"text-xs font-bold text-slate-400 mb-2 ml-1 font-kosugi",children:""}),i.jsxs("div",{className:"flex flex-wrap gap-2 min-h-[46px] bg-purple-50/50 p-3 rounded-xl border border-purple-100 border-dashed",children:[a.searchTags.length===0&&i.jsx("span",{className:"text-xs text-slate-400 self-center",children:""}),a.searchTags.map(N=>i.jsxs("button",{onClick:()=>ie(N),className:"bg-purple-500 text-white px-3 py-1.5 rounded-xl text-xs font-bold shadow-sm flex items-center gap-1 font-kosugi",children:["#",N," ",i.jsx(Ct,{size:10,className:"opacity-80"})]},N))]})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("div",{className:"text-xs font-bold text-slate-400 mb-2 ml-1 font-kosugi",children:" ()"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{value:b,onChange:N=>y(N.target.value),onKeyDown:N=>N.key==="Enter"&&ce(),type:"text",placeholder:"#",className:"dream-input flex-1 px-4 py-2 text-sm bg-white"}),i.jsx("button",{onClick:ce,className:"bg-gradient-to-r from-purple-400 to-purple-500 text-white px-4 rounded-xl font-bold text-sm shadow-md active:scale-95 transition font-kosugi",children:""})]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs font-bold text-slate-400 mb-2 ml-1 font-kosugi",children:""}),i.jsx("div",{className:"grid grid-cols-4 gap-2",children:B.map(N=>i.jsxs("button",{onClick:()=>ie(N),className:`
                                            rounded-2xl font-bold text-[0.85rem] px-2 py-2 transition-all whitespace-nowrap overflow-hidden text-ellipsis font-kosugi
                                            ${a.searchTags.includes(N)?"bg-[#8B5CF6] text-white shadow-md":"bg-[#F3E8FF] text-[#6B21A8]"}
                                        `,children:["#",N]},N))})]})]})]})]}),T&&i.jsx("div",{className:"fixed inset-0 z-[70] flex items-center justify-center bg-black/40 backdrop-blur-sm animate-in fade-in duration-200",children:i.jsxs("div",{className:"bg-white rounded-3xl p-6 w-[80%] max-w-xs shadow-2xl scale-100 animate-in zoom-in-95 duration-200",children:[i.jsx("h3",{className:"text-lg font-bold text-slate-800 text-center mb-4 font-kosugi",children:s?"":""}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:()=>U(!1),className:"flex-1 py-2.5 rounded-xl border border-slate-200 text-slate-600 font-bold hover:bg-slate-50 transition-colors font-kosugi",children:s?"":""}),i.jsx("button",{onClick:()=>U(!0),className:"flex-1 py-2.5 rounded-xl bg-purple-500 text-white font-bold shadow-lg shadow-purple-200 hover:bg-purple-600 transition-colors font-kosugi",children:s?"":""})]})]})}),w&&i.jsx("div",{className:"fixed inset-0 z-[70] flex items-center justify-center bg-black/40 backdrop-blur-sm animate-in fade-in duration-200",children:i.jsxs("div",{className:"bg-white rounded-3xl p-6 w-[80%] max-w-xs shadow-2xl scale-100 animate-in zoom-in-95 duration-200 flex flex-col items-center",children:[i.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center text-red-500 mb-3",children:i.jsx(Pa,{size:28})}),i.jsx("h3",{className:"text-lg font-bold text-slate-800 text-center mb-1 font-kosugi",children:""}),i.jsx("p",{className:"text-xs text-slate-400 text-center mb-5 font-kosugi",children:""}),i.jsx("button",{onClick:()=>x(!1),className:"w-full py-2.5 rounded-xl bg-purple-500 text-white font-bold shadow-lg shadow-purple-200 hover:bg-purple-600 transition-colors font-kosugi",children:""})]})})]})})},Yu=({onLogin:e})=>{const[t,s]=m.useState(""),[n,r]=m.useState(""),[o,a]=m.useState(!1),[l,c]=m.useState(!1),[d,u]=m.useState(null),h=m.useRef(null),f=m.useRef(null),p=m.useRef(null),[b,y]=m.useState(!1);m.useEffect(()=>{const v=()=>{const M=window.visualViewport&&window.visualViewport.height?window.visualViewport.height:window.innerHeight;document.documentElement.style.setProperty("--vh",`${M*.01}px`)};v();const w=()=>v();window.addEventListener("resize",w),window.visualViewport&&window.visualViewport.addEventListener("resize",w);const x=()=>{const M=window.innerHeight,S=window.visualViewport&&window.visualViewport.height?window.visualViewport.height:M;y(S<M-160)};x();const P=()=>{v(),x()};return window.visualViewport&&window.visualViewport.addEventListener("resize",P),()=>{window.removeEventListener("resize",w),window.visualViewport&&(window.visualViewport.removeEventListener("resize",w),window.visualViewport.removeEventListener("resize",P))}},[]);const T=()=>y(!0),j=()=>y(!1),g=async v=>{if(v.preventDefault(),u(null),!t.trim()||!n.trim()){u("");return}c(!0);try{const w=await _u.login(t.trim(),n.trim());if(w!=null&&w.access_token)try{localStorage.setItem("user_access_token",w.access_token)}catch{}if(w!=null&&w.refresh_token)try{localStorage.setItem("user_refresh_token",w.refresh_token)}catch{}e()}catch{u("")}finally{c(!1)}};return i.jsx("div",{ref:h,className:`h-full w-full bg-primary-50 flex flex-col items-center ${b?"justify-start":"justify-center"} px-8 font-sans overflow-hidden animate-in fade-in duration-700`,style:{paddingTop:b?"10vh":void 0},children:i.jsxs("div",{className:"w-full flex flex-col items-center z-10",children:[i.jsx("div",{className:"text-center mb-12",children:i.jsx("h1",{className:"text-[40px] font-extrabold text-[#A855F7] mb-0 tracking-tight font-sans",children:"YumeCrush"})}),i.jsxs("form",{onSubmit:g,className:"w-full space-y-5",children:[i.jsx("input",{type:"text",placeholder:"",value:t,onChange:v=>s(v.target.value),onFocus:T,onBlur:j,ref:f,className:"w-full h-[60px] px-6 rounded-2xl bg-white border border-[#F3F4F6] text-[#374151] placeholder:text-[#D1D5DB] outline-none focus:border-[#C084FC] focus:bg-white focus:ring-4 focus:ring-[#F3E8FF] transition-all text-[15px] font-medium shadow-sm"}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:o?"text":"password",placeholder:"",value:n,onChange:v=>r(v.target.value),onFocus:T,onBlur:j,ref:p,className:"w-full h-[60px] px-6 rounded-2xl bg-white border border-[#F3F4F6] text-[#374151] placeholder:text-[#D1D5DB] outline-none focus:border-[#C084FC] focus:bg-white focus:ring-4 focus:ring-[#F3E8FF] transition-all text-[15px] font-medium shadow-sm"}),i.jsx("button",{type:"button",onClick:()=>a(!o),className:"absolute right-5 top-1/2 -translate-y-1/2 text-[#9CA3AF] hover:text-[#C084FC] transition-colors",children:o?i.jsx(Ma,{size:20}):i.jsx(Va,{size:20})})]}),d&&i.jsx("div",{className:"text-red-500 text-xs font-bold",children:d}),i.jsx("button",{type:"submit",disabled:l,className:`w-full h-[60px] ${l?"bg-[#A855F7]/70":"bg-[#A855F7] hover:bg-[#9333EA]"} text-white font-bold text-[16px] rounded-2xl shadow-[0_10px_30px_rgba(168,85,247,0.3)] active:scale-[0.98] transition-all mt-4`,children:l?"...":""})]})]})})},Xu=({userProfile:e,myCharacters:t,myUserCharacters:s,myStories:n,onUpdateProfile:r,onCharacterClick:o,onLogout:a})=>{const[l,c]=m.useState(!1),[d,u]=m.useState(e.nickname),[h,f]=m.useState(!1),[p,b]=m.useState(null),y=m.useRef(null),T=w=>{var O;const x=w.split(","),P=((O=x[0].match(/:(.*?);/))==null?void 0:O[1])||"image/jpeg",M=atob(x[1]);let S=M.length;const L=new Uint8Array(S);for(;S--;)L[S]=M.charCodeAt(S);return new Blob([L],{type:P})},j=()=>{var w;(w=y.current)==null||w.click()},g=w=>{var P;const x=(P=w.target.files)==null?void 0:P[0];if(x){const M=new FileReader;M.onloadend=()=>{b(M.result)},M.readAsDataURL(x)}y.current&&(y.current.value="")},v=async()=>{const w=d.trim();if(!w){u(e.nickname),c(!1);return}try{const{authFetch:x}=await re(async()=>{const{authFetch:P}=await import("./http-DqgzyhP5.js");return{authFetch:P}},__vite__mapDeps([0,1,2,3]));await x("/user/profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({nickname:w})}),r({...e,nickname:w})}catch{u(e.nickname)}c(!1)};return m.useEffect(()=>{},[e.usedCount]),i.jsxs("div",{className:"h-full w-full bg-[#F8F9FB] flex flex-col font-kosugi relative",children:[p&&i.jsx(hn,{imageSrc:p,onCancel:()=>b(null),onCrop:async w=>{const x=localStorage.getItem("user_access_token");let P=w;try{if(w&&w.startsWith("data:image")){const M=T(w),S=new FormData,L=`${Date.now()}_${Math.random().toString(36).slice(2,8)}.jpg`;S.append("avatar",M,"avatar.jpg"),S.append("filename",L),P=`/uploads/users/avatars/${L}`,await fetch("/api/uploads/avatar",{method:"POST",headers:{Authorization:x?`Bearer ${x}`:""},body:S}).catch(()=>{})}}catch{}try{const{authFetch:M}=await re(async()=>{const{authFetch:S}=await import("./http-DqgzyhP5.js");return{authFetch:S}},__vite__mapDeps([0,1,2,3]));await M("/user/profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({avatar:P})})}catch{}r({...e,avatar:P||e.avatar}),b(null)}}),i.jsxs("div",{className:"relative pb-4",children:[i.jsxs("div",{className:"h-40 bg-gradient-to-br from-pink-200 via-purple-200 to-indigo-200 rounded-b-[40px] relative overflow-hidden",children:[i.jsx("div",{className:"absolute top-[-20px] left-[-20px] w-40 h-40 bg-white/20 rounded-full blur-xl"}),i.jsx("div",{className:"absolute bottom-[-10px] right-[-10px] w-32 h-32 bg-purple-400/20 rounded-full blur-xl"})]}),i.jsxs("div",{className:"absolute top-16 left-4 right-4 bg-white rounded-3xl shadow-lg p-4 flex flex-col items-center animate-in slide-in-from-bottom-4 duration-500",children:[i.jsxs("div",{className:"relative -mt-12 mb-2 group cursor-pointer",onClick:j,children:[i.jsx("div",{className:"w-20 h-20 rounded-full border-4 border-white shadow-md overflow-hidden bg-slate-100",children:i.jsx("img",{src:e.avatar||"/uploads/avatars/default_avatar.jpg",alt:"Me",className:"w-full h-full object-cover"})}),i.jsx("div",{className:"absolute bottom-0 right-0 bg-primary-500 p-1.5 rounded-full text-white border-2 border-white shadow-sm",children:i.jsx(Vi,{size:10})}),i.jsx("input",{type:"file",ref:y,className:"hidden",accept:"image/*",onChange:g})]}),i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l?i.jsx("input",{value:d,onChange:w=>u(w.target.value),onBlur:v,onKeyDown:w=>w.key==="Enter"&&v(),autoFocus:!0,className:"text-lg font-bold text-center text-slate-800 border-b-2 border-primary-300 outline-none bg-transparent min-w-[100px]"}):i.jsx("h2",{className:"text-lg font-bold text-slate-800",children:e.nickname}),!l&&i.jsx("button",{onClick:()=>c(!0),className:"text-slate-400 hover:text-primary-500",children:i.jsx(Li,{size:12})})]}),i.jsx("div",{className:"flex flex-col items-center gap-1 mb-1",children:i.jsxs("div",{className:"flex items-center gap-1.5 text-slate-400 text-[10px] font-bold bg-slate-50 px-3 py-0.5 rounded-full",children:[i.jsx(Ua,{size:10}),i.jsx("span",{className:"tracking-wide",children:e.email})]})})]})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto px-4 pb-24 space-y-6 no-scrollbar mt-8",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2 mb-3 px-1",children:[i.jsx("div",{className:"w-1 h-4 bg-purple-400 rounded-full"}),i.jsx("h3",{className:"font-bold text-slate-700",children:""})]}),s.length>0?i.jsx("div",{className:"flex flex-col gap-3",children:s.map(w=>i.jsxs("div",{onClick:()=>o(w),className:"bg p-3 rounded-2xl shadow-sm flex items-center gap-4 active:scale-[0.98] transition-all cursor-pointer border border-transparent hover:border-purple-100",children:[i.jsx("div",{className:"w-14 h-14 rounded-full bg-slate-100 flex-shrink-0 overflow-hidden border border-slate-50",children:i.jsx("img",{src:w.avatar,className:"w-full h-full object-cover",alt:w.name})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsx("h4",{className:"font-bold text-slate-800",children:w.name}),i.jsxs("div",{className:"flex flex-col items-end gap-0.5",children:[i.jsx("span",{className:`text-[10px] px-1.5 py-0.5 rounded font-bold ${w.isPublic?"bg-green-100 text-green-600":"bg-slate-100 text-slate-400"}`,children:w.isPublic?"":""}),i.jsx("span",{className:`text-[10px] px-1.5 py-0.5 rounded font-bold ${w.isPublished?"text-green-600":"text-slate-400"}`,children:w.isPublished?"":""})]})]}),i.jsx("p",{className:"text-xs text-slate-400 truncate mt-1",children:w.oneLinePersona||w.bio})]}),i.jsx(kt,{size:16,className:"text-slate-300"})]},w.id))}):i.jsx("div",{className:"bg rounded-2xl p-6 text-center shadow-sm border border-slate-50 border-dashed",children:i.jsx("p",{className:"text-xs text-slate-400",children:""})})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2 mb-3 px-1",children:[i.jsx("div",{className:"w-1 h-4 bg-pink-400 rounded-full"}),i.jsx("h3",{className:"font-bold text-slate-700",children:""})]}),i.jsx("div",{className:"bg-white rounded-2xl p-6 text-center shadow-sm border border-slate-50 border-dashed flex flex-col items-center gap-2",children:i.jsx("p",{className:"text-xs text-slate-400",children:""})})]}),i.jsx("div",{className:"bg-white rounded-3xl shadow-sm p-2",children:i.jsxs("button",{onClick:()=>f(!0),className:"w-full flex items-center justify-center gap-3 p-2 hover:bg-red-50 rounded-2xl transition-colors group",children:[i.jsx("div",{className:"w-8 h-8 rounded-full bg-red-50 text-red-400 flex items-center justify-center group-hover:bg-red-100 group-hover:text-red-500 transition-colors",children:i.jsx(fn,{size:16})}),i.jsx("span",{className:"text-center font-bold text-slate-700 text-sm group-hover:text-red-500",children:""})]})})]}),h&&i.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/40 backdrop-blur-sm animate-in fade-in duration-200",children:i.jsxs("div",{className:"bg-white rounded-[32px] p-6 w-[80%] max-w-xs shadow-2xl scale-100 animate-in zoom-in-95 duration-200 text-center",children:[i.jsx("div",{className:"w-16 h-16 bg-red-50 text-red-400 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx(fn,{size:28})}),i.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-2",children:""}),i.jsx("p",{className:"text-xs text-slate-400 mb-6 px-4 leading-relaxed"}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:()=>f(!1),className:"flex-1 py-3 rounded-2xl bg-slate-100 text-slate-600 font-bold hover:bg-slate-200 transition-colors text-sm",children:""}),i.jsx("button",{onClick:a,className:"flex-1 py-3 rounded-2xl bg-red-500 text-white font-bold shadow-lg shadow-red-200 hover:bg-red-600 transition-colors text-sm",children:""})]})]})})]})},qu=async e=>{const t=new URLSearchParams;t.set("limit",String(e.limit));const{authFetch:s}=await re(async()=>{const{authFetch:a}=await import("./http-DqgzyhP5.js");return{authFetch:a}},__vite__mapDeps([0,1,2,3])),n=await s(`/stories/?${t.toString()}`);if(!n.ok)throw new Error("failed");const r=await n.json();return Array.isArray(r==null?void 0:r.items)?r.items:[]},Ju=async e=>{const{authFetch:t}=await re(async()=>{const{authFetch:r}=await import("./http-DqgzyhP5.js");return{authFetch:r}},__vite__mapDeps([0,1,2,3])),s=await t(`/stories/${e}`);if(!s.ok)throw new Error("failed");return await s.json()},Zu=({story:e,onBack:t,onStartRoleplay:s})=>{const n=m.useRef(null),r=m.useRef(null),[o,a]=m.useState(20),[l,c]=m.useState(0),[d,u]=m.useState(!1),[h,f]=m.useState(!1),[p,b]=m.useState(null),y=m.useRef(0),T=m.useRef(0),j=m.useCallback(()=>{if(!n.current||!r.current)return;const{scrollTop:x,scrollHeight:P,clientHeight:M}=n.current,S=r.current.clientHeight;if(P<=M){a(S),c(0);return}const L=M/P,O=Math.max(L*S,30);a(O);const D=P-M,B=S-O,X=x/D;c(X*B)},[]);m.useEffect(()=>{const x=new ResizeObserver(()=>{j()});n.current&&x.observe(n.current),r.current&&x.observe(r.current);const P=setTimeout(j,100);return()=>{x.disconnect(),clearTimeout(P)}},[j]);const g=x=>{x.preventDefault(),x.stopPropagation(),u(!0);const P="touches"in x?x.touches[0].clientX:x.clientY;y.current=P,T.current=l};m.useEffect(()=>{const x=M=>{if(!d||!n.current||!r.current)return;M.preventDefault();const L=("touches"in M?M.touches[0].clientY:M.clientY)-y.current,D=r.current.clientHeight-o,B=n.current.scrollHeight-n.current.clientHeight;if(D<=0)return;let X=T.current+L;X=Math.max(0,Math.min(X,D));const ne=X/D;n.current.scrollTop=ne*B},P=()=>{u(!1)};return d&&(document.addEventListener("mousemove",x),document.addEventListener("mouseup",P),document.addEventListener("touchmove",x,{passive:!1}),document.addEventListener("touchend",P)),()=>{document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",P),document.removeEventListener("touchmove",x),document.removeEventListener("touchend",P)}},[d,o]);const v=()=>{if(p&&e.availableRoles){const x=e.availableRoles.find(P=>P.name===p);x&&s(x)}},w=e.content.split(`
`).filter(x=>x.trim()!=="");return i.jsxs("div",{className:"fixed inset-0 bg-white z-[60] flex flex-col h-full w-full animate-in slide-in-from-right duration-300",children:[i.jsx("div",{className:"fixed top-4 left-4 z-[100]",children:i.jsx("button",{onClick:t,className:"w-10 h-10 bg-black/20 backdrop-blur-md rounded-full flex items-center justify-center text-white hover:bg-black/30 transition-all",children:i.jsx(Ft,{size:24})})}),i.jsxs("div",{className:"mx-auto w-full max-w-md h-full flex flex-col relative bg-white rounded-none md:rounded-3xl md:overflow-hidden shadow-2xl",children:[i.jsxs("div",{className:"flex-1 overflow-y-auto no-scrollbar bg-[#FAFAFA]",onScroll:j,ref:n,children:[i.jsxs("div",{className:"w-full h-64 relative",children:[i.jsx("img",{src:e.image,alt:e.title,className:"w-full h-full object-cover"}),i.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#FAFAFA] to-transparent"})]}),i.jsxs("div",{className:"px-6 -mt-12 relative z-10 pb-20",children:[i.jsxs("div",{className:"mb-8",children:[i.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-4 leading-tight",children:e.title}),i.jsxs("div",{className:"flex items-center mt-2",children:[i.jsx("div",{className:"w-9 h-9 rounded-full bg-slate-200 overflow-hidden border border-white shadow-sm mr-3",children:i.jsx("img",{src:`https://api.dicebear.com/7.x/miniavs/svg?seed=${e.author}`,alt:"author",className:"w-full h-full object-cover"})}),i.jsx("span",{className:"text-sm font-bold text-slate-700",children:e.author})]})]}),i.jsx("article",{className:"prose prose-slate max-w-none",children:w.map((x,P)=>i.jsx("p",{className:"mb-6 text-justify tracking-wide text-[16px]",style:{lineHeight:1.8,color:"#334155"},children:x},P))}),i.jsx("div",{className:"flex items-center justify-center my-10",children:i.jsx("span",{className:"text-slate-400/80 text-sm font-medium tracking-widest",children:"  "})}),i.jsx("div",{className:"mb-12 flex flex-wrap gap-4 pl-1",children:e.tags.map(x=>i.jsxs("span",{className:"text-sm text-slate-400",children:["#",x]},x))}),i.jsx("div",{className:"hidden",children:i.jsxs("button",{onClick:()=>f(!0),className:"flex items-center gap-2 px-6 py-3 bg-purple-100 rounded-full shadow-lg shadow-purple-200/50 hover:bg-purple-200 transition-all active:scale-95 cursor-pointer",children:[i.jsx("span",{className:"text-lg font-bold text-purple-600 tracking-widest",style:{fontFamily:"'Noto Serif SC', serif"},children:""}),i.jsx(Na,{size:18,className:"text-purple-600"})]})})]})]}),i.jsx("div",{ref:r,className:"absolute right-1 top-4 bottom-4 w-1.5 z-[70]",children:i.jsx("div",{className:"w-full rounded-full cursor-pointer transition-colors duration-200 bg-slate-400/40 hover:bg-slate-400/60",style:{height:`${o}px`,transform:`translateY(${l}px)`,touchAction:"none"},onMouseDown:g,onTouchStart:g})})]}),h&&i.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-sm animate-in fade-in duration-300",children:i.jsxs("div",{className:"bg-white w-[85%] max-w-sm rounded-[32px] overflow-hidden shadow-2xl animate-in zoom-in-95 duration-300",children:[i.jsxs("div",{className:"p-6 pb-2",children:[i.jsx("h3",{className:"text-xl font-bold text-slate-900 text-center mb-1 font-kosugi",children:""}),i.jsx("p",{className:"text-xs text-slate-400 text-center mb-6",children:"AI"}),i.jsx("div",{className:"space-y-3 max-h-[50vh] overflow-y-auto no-scrollbar py-2 px-1",children:e.availableRoles?e.availableRoles.map(x=>{const P=p===x.name;return i.jsxs("div",{onClick:()=>b(x.name),className:`
                                            relative p-4 rounded-2xl flex items-center justify-between cursor-pointer transition-all border-2
                                            ${P?"bg-purple-50 border-purple-500 shadow-md scale-[1.02]":"bg-slate-50 border-transparent hover:bg-slate-100"}
                                        `,children:[i.jsx("span",{className:`font-bold text-base ${P?"text-purple-700":"text-slate-800"}`,children:x.name}),P&&i.jsx("div",{className:"w-5 h-5 rounded-full bg-purple-500 flex items-center justify-center text-white shadow-sm",children:i.jsx(Ri,{size:12,strokeWidth:3})})]},x.name)}):i.jsx("p",{className:"text-center text-slate-400 py-4 text-sm",children:""})})]}),i.jsx("div",{className:"p-6 pt-2 bg-gradient-to-t from-white via-white to-transparent",children:i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:()=>f(!1),className:"flex-1 py-3.5 rounded-2xl border border-slate-200 font-bold text-slate-500 hover:bg-slate-50 text-sm",children:""}),i.jsx("button",{onClick:v,disabled:!p,className:`
                                   flex-1 py-3.5 rounded-2xl font-bold text-white text-sm shadow-lg transition-all flex items-center justify-center gap-2
                                   ${p?"bg-purple-600 shadow-purple-200 hover:bg-purple-700 active:scale-95":"bg-slate-300 shadow-none cursor-not-allowed"}
                               `,children:""})]})})]})})]})},Qu=e=>({id:(e==null?void 0:e.id)??(e==null?void 0:e._id)??(e==null?void 0:e.character_id)??String(Date.now()),name:(e==null?void 0:e.name)??(e==null?void 0:e.title)??"",avatar:(e==null?void 0:e.avatar)??(e==null?void 0:e.cover)??(e==null?void 0:e.image)??"",profileImage:(e==null?void 0:e.profileImage)??(e==null?void 0:e.banner)??(e==null?void 0:e.image)??"",bio:(e==null?void 0:e.bio)??(e==null?void 0:e.tagline)??(e==null?void 0:e.description)??"",tags:(e==null?void 0:e.tags)??(e==null?void 0:e.keywords)??[],creator:(e==null?void 0:e.creator)??(e==null?void 0:e.author)??"",oneLinePersona:(e==null?void 0:e.oneLinePersona)??(e==null?void 0:e.tagline)??"",personality:(e==null?void 0:e.personality)??(e==null?void 0:e.personality)??"",profession:(e==null?void 0:e.profession)??(e==null?void 0:e.occupation)??"",age:(e==null?void 0:e.age)??"",roleType:(e==null?void 0:e.roleType)??(e==null?void 0:e.character_type)??"",currentRelationship:(e==null?void 0:e.currentRelationship)??(e==null?void 0:e.relationship)??"",plotTheme:(e==null?void 0:e.plotTheme)??(e==null?void 0:e.plot_theme)??"",plotDescription:(e==null?void 0:e.plotDescription)??(e==null?void 0:e.plot_summary)??"",openingLine:(e==null?void 0:e.openingLine)??(e==null?void 0:e.opening_line)??""}),eh=async e=>{const t=new URLSearchParams;e!=null&&e.tag&&t.set("tag",e.tag),t.set("limit",String(e.limit));const{authFetch:s}=await re(async()=>{const{authFetch:a}=await import("./http-DqgzyhP5.js");return{authFetch:a}},__vite__mapDeps([0,1,2,3])),n=await s(`/characters/?${t.toString()}`);if(!n.ok)throw new Error("failed");const r=await n.json();return(Array.isArray(r==null?void 0:r.items)?r.items:[]).map(Qu)},th=[],sh=()=>{const[e,t]=m.useState(Z.HOME),[s,n]=m.useState(th),[r,o]=m.useState([]),[a,l]=m.useState(!1),[c,d]=m.useState(null),[u,h]=m.useState(null),[f,p]=m.useState("stories"),[b,y]=m.useState(!1),[T,j]=m.useState(void 0),[g,v]=m.useState(!1),[w,x]=m.useState(null),[P,M]=m.useState(null),[S,L]=m.useState([]),[O,D]=m.useState(null),[B,X]=m.useState(!!localStorage.getItem("user_access_token")),[ne,ie]=m.useState(()=>{const C=localStorage.getItem("user_nickname")||"",V=localStorage.getItem("user_email")||"me@example.com",k=localStorage.getItem("user_avatar")||"";return{nickname:C,email:V,avatar:k}}),[ce,U]=m.useState(!1),[te,ge]=m.useState(!1),[je,q]=m.useState([]),[N,A]=m.useState(!1),_=()=>{localStorage.removeItem("user_access_token"),localStorage.removeItem("user_refresh_token"),localStorage.removeItem("user_nickname"),localStorage.removeItem("user_email"),localStorage.removeItem("user_avatar"),j(void 0),d(null),h(null),t(Z.HOME),X(!1)};if(m.useEffect(()=>{B&&((async()=>{try{const{authFetch:C}=await re(async()=>{const{authFetch:k}=await import("./http-DqgzyhP5.js");return{authFetch:k}},__vite__mapDeps([0,1,2,3])),V=await C("/user/profile");if(V&&V.ok){const k=await V.json(),F=(k==null?void 0:k.nickname)||"",he=(k==null?void 0:k.email)||"me@example.com",fe=(k==null?void 0:k.avatar)||"",E=typeof(k==null?void 0:k.used_count)=="number"?k.used_count:0;ie({nickname:F,email:he,avatar:fe,usedCount:E});try{localStorage.setItem("user_nickname",F),localStorage.setItem("user_email",he),fe&&localStorage.setItem("user_avatar",fe);const R=(k==null?void 0:k.id)??(k==null?void 0:k.user_id)??(k==null?void 0:k.uid);R!=null&&localStorage.setItem("user_id",String(R))}catch{}}}catch{}})(),(async()=>{try{const C=await qu({limit:12});L(C)}catch{L([])}})(),l(!0),eh({limit:24}).then(C=>{const V=C.map(k=>({id:String(k.id),name:k.name||"",avatar:k.avatar||"",profileImage:k.profileImage||"",status:lt.ONLINE,bio:k.bio||"",tags:Array.isArray(k.tags)?k.tags:[],creator:k.creator||"",oneLinePersona:k.oneLinePersona||"",personality:k.personality||"",profession:k.profession||"",age:k.age||"",roleType:k.roleType||"",currentRelationship:k.currentRelationship||"",plotTheme:k.plotTheme||"",plotDescription:k.plotDescription||"",openingLine:k.openingLine||""}));o(V);try{const k=[],F=localStorage.getItem("user_id")||"0";if(!F||F==="0"){n([]);return}Object.keys(localStorage).filter(E=>E.startsWith(`chat_history_${F}_`)).forEach(E=>{const R=E.replace(`chat_history_${F}_`,""),H=V.find(Qe=>String(Qe.id)===String(R));if(!H)return;const W=localStorage.getItem(E);if(!W)return;const K=JSON.parse(W);if(!K.length||!!!localStorage.getItem(`chat_session_${F}_${R}`))return;const Y=K[K.length-1],Te={id:Y.id,senderId:Y.senderId,text:Y.text,timestamp:new Date(Y.ts),type:Y.type};k.push({characterId:String(R),character:H,lastMessage:Te,unreadCount:0})}),k.length&&n(k)}catch{}}).catch(()=>o([])).finally(()=>l(!1)),(async()=>{try{const C=await Ei(),k=(Array.isArray(C)?C.filter(F=>typeof(F==null?void 0:F.mypage_id)<"u"&&typeof(F==null?void 0:F.mypage_name)=="string"&&typeof(F==null?void 0:F.mypage_visibility)=="string"&&typeof(F==null?void 0:F.mypage_status)=="string"):[]).map(F=>({id:String(F.mypage_id),name:F.mypage_name||"",avatar:F.mypage_avatar||"",profileImage:"",status:lt.ONLINE,bio:"",tags:[],creator:ne.nickname||"",oneLinePersona:F.mypage_tagline||"",personality:"",profession:"",age:"",roleType:"",gender:"",currentRelationship:"",plotTheme:"",plotDescription:"",openingLine:"",styleExamples:[],hobbies:"",experiences:"",isPublic:F.mypage_visibility?F.mypage_visibility==="public":!1,isPublished:F.mypage_status==="published"}));q(k)}catch{q([])}})())},[B]),m.useEffect(()=>{if(!((navigator==null?void 0:navigator.maxTouchPoints)>0))return;const V=document.querySelector('meta[name="viewport"]'),k=(V==null?void 0:V.getAttribute("content"))||"";V&&V.setAttribute("content","width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no");let he=0;const fe=E=>{const R=Date.now();R-he<=300&&E.preventDefault(),he=R};return document.addEventListener("touchend",fe,{passive:!1}),document.body.style.touchAction="manipulation",()=>{V&&V.setAttribute("content",k),document.removeEventListener("touchend",fe),document.body.style.touchAction=""}},[]),m.useEffect(()=>{const C=()=>{const k=window.visualViewport&&window.visualViewport.height?window.visualViewport.height:window.innerHeight;document.documentElement.style.setProperty("--vh",`${k*.01}px`)};C();const V=()=>C();return window.addEventListener("resize",V),window.visualViewport&&window.visualViewport.addEventListener("resize",V),()=>{window.removeEventListener("resize",V),window.visualViewport&&window.visualViewport.removeEventListener("resize",V)}},[]),!B)return i.jsx(_i,{children:i.jsx("div",{className:"fixed inset-0 w-full bg-primary-50 overflow-hidden",style:{height:"calc(var(--vh) * 100)",overscrollBehavior:"none"},children:i.jsx("div",{className:"h-full w-full max-w-md mx-auto bg relative shadow-2xl rounded-none md:rounded-3xl md:overflow-hidden flex",children:i.jsx(Yu,{onLogin:()=>X(!0)})})})});const $=C=>{try{const k=`chat_history_${localStorage.getItem("user_id")||"0"}_${C.characterId}`,F=localStorage.getItem(k);if(F){const fe=JSON.parse(F).map(E=>({id:E.id,senderId:E.senderId,text:E.text,timestamp:new Date(E.ts),type:E.type,quote:E.quote,read:E.read}));if(fe.length)return fe}}catch{}return C.character.openingLine?[{id:`m_${Date.now()}`,senderId:C.characterId,text:C.character.openingLine.replace(/^['"]|['"]$/g,""),timestamp:new Date,type:Fe.TEXT}]:[{id:"m0",senderId:C.characterId,text:"",timestamp:new Date(new Date().setDate(new Date().getDate()-2)),type:Fe.TEXT},C.lastMessage]},z=C=>{c&&n(V=>V.map(k=>k.characterId===c.characterId?{...k,lastMessage:C,unreadCount:0}:k))},me=C=>{n(V=>V.map(k=>k.characterId===C?{...k,character:{...k.character,isPinned:!k.character.isPinned}}:k))},oe=async C=>{const V=s.find(k=>k.characterId===C.id);if(V){h(null),A(!1),d(V),t(Z.CHAT);return}try{const F=`chat_session_${localStorage.getItem("user_id")||"0"}_${C.id}`;let he=localStorage.getItem(F)||"";he||(he=(await Ss(C.id)).sessionId,localStorage.setItem(F,he));const fe={id:`msg_${Date.now()}`,senderId:C.id,text:C.openingLine?C.openingLine.replace(/^['"]|['"]$/g,""):"...",timestamp:new Date,type:Fe.TEXT},E={characterId:C.id,character:C,lastMessage:fe,unreadCount:0};n(R=>[E,...R]),h(null),A(!1),d(E),t(Z.CHAT)}catch{const k={characterId:C.id,character:C,lastMessage:{id:`msg_${Date.now()}`,senderId:C.id,text:C.openingLine?C.openingLine.replace(/^['"]|['"]$/g,""):"...",timestamp:new Date,type:Fe.TEXT},unreadCount:0};n(F=>[k,...F]),h(null),A(!1),d(k),t(Z.CHAT)}},Ae=C=>{v(!1),M({character:C,id:String(C.id)})},$e=()=>i.jsxs("div",{className:"flex items-center gap-5",children:[i.jsxs("button",{onClick:()=>p("stories"),className:`relative transition-all duration-300 ${f==="stories"?"text-slate-800 font-extrabold text-2xl scale-105":"text-slate-400 font-semibold text-lg hover:text-slate-600"}`,children:["",f==="stories"&&i.jsx("span",{className:"absolute -bottom-1 left-1/2 -translate-x-1/2 w-4 h-1 bg-primary-500 rounded-full"})]}),i.jsx("div",{className:"h-5 w-[1px] bg-slate-300/50 rounded-full"}),i.jsxs("button",{onClick:()=>p("characters"),className:`relative transition-all duration-300 ${f==="characters"?"text-slate-800 font-extrabold text-2xl scale-105":"text-slate-400 font-semibold text-lg hover:text-slate-600"}`,children:["",f==="characters"&&i.jsx("span",{className:"absolute -bottom-1 left-1/2 -translate-x-1/2 w-4 h-1 bg-primary-500 rounded-full"})]})]}),yt=()=>{switch(e){case Z.HOME:return i.jsx("div",{className:"px-6 pb-24 animate-in fade-in slide-in-from-bottom-4 duration-500",children:f==="stories"?i.jsxs("div",{className:"space-y-6 mt-2",children:[S.map(C=>i.jsxs("div",{className:"group relative bg-white rounded-3xl overflow-hidden shadow-md hover:shadow-xl transition-all cursor-pointer border border-transparent hover:border-primary-100 hover:-translate-y-0.5 duration-200",onClick:async()=>{try{const V=await Ju(C.id),k={id:Number(V.id),title:V.title,description:V.description||"",image:V.image||"",tags:Array.isArray(V.tags)?V.tags:[],author:V.author||"",likes:"",content:V.content||"",publishDate:V.publish_date||void 0};D(k)}catch{}},children:[i.jsxs("div",{className:"h-40 overflow-hidden relative",children:[i.jsx("img",{src:C.image,alt:C.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-700"}),i.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 via-black/20 to-transparent"}),i.jsx("div",{className:"absolute bottom-4 left-4",children:i.jsx("h3",{className:"text-xl font-bold text-white",children:C.title})})]}),i.jsxs("div",{className:"p-5",children:[i.jsx("p",{className:"text-slate-500 text-sm leading-relaxed mb-4 line-clamp-2",children:C.description}),i.jsx("div",{className:"flex justify-between items-center",children:i.jsx("div",{className:"flex gap-2 flex-wrap",children:(C.tags||[]).map(V=>i.jsxs("span",{className:"text-[10px] font-bold text-primary-600 bg-primary-50 px-2 py-1 rounded-full",children:["#",V]},V))})})]})]},C.id)),!S.length&&i.jsx("div",{className:"text-center text-xs text-slate-400",children:""})]}):i.jsxs("div",{className:"flex flex-col gap-4 mt-2",children:[a&&i.jsx("div",{className:"text-center text-xs text-slate-400",children:"..."}),!a&&r.map(C=>{var V;return i.jsxs("div",{className:"bg-white rounded-2xl p-4 shadow-sm flex gap-4 hover:shadow-md transition-all cursor-pointer border border-transparent hover:border-primary-100",onClick:()=>{U(!1),ge(!1),h(C)},children:[i.jsx("div",{className:"w-20 h-28 flex-shrink-0 rounded-xl overflow-hidden bg-slate-100 relative group",children:i.jsx("img",{src:C.avatar,alt:C.name,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"})}),i.jsxs("div",{className:"flex-1 flex flex-col justify-between py-1 min-w-0",children:[i.jsxs("div",{children:[i.jsx("div",{className:"flex justify-between items-start",children:i.jsx("h3",{className:"font-bold text-slate-800 text-lg leading-tight",children:C.name})}),i.jsx("div",{className:"flex flex-wrap gap-1.5 mt-2 mb-2",children:(V=C.tags)==null?void 0:V.slice(0,4).map(k=>i.jsx("span",{className:"text-[10px] font-medium px-1.5 py-0.5 rounded-md bg-pink-50 text-pink-500",children:k},k))}),i.jsx("p",{className:"text-xs text-slate-500 line-clamp-2 leading-relaxed mb-2",children:C.oneLinePersona||C.bio})]}),i.jsx("div",{className:"flex items-center justify-end mt-1 border-t border-slate-50 pt-2",children:i.jsxs("div",{className:"text-[10px] text-slate-400",children:["by ",C.creator||""]})})]})]},C.id)}),!a&&r.length===0&&i.jsx("div",{className:"mt-2 text-center",children:i.jsx("p",{className:"text-xs text-slate-300",children:" ~"})})]})});case Z.ME:return i.jsx(Xu,{userProfile:ne,myCharacters:r,myUserCharacters:je,myStories:[],onUpdateProfile:C=>{ie(C);try{localStorage.setItem("user_nickname",C.nickname||""),localStorage.setItem("user_email",C.email||"me@example.com"),C.avatar&&localStorage.setItem("user_avatar",C.avatar)}catch{}},onCharacterClick:C=>{U(!1),ge(!0),h(C)},onLogout:_});case Z.CHAT:default:return i.jsx(i.Fragment,{children:(!c||N)&&i.jsx(ku,{chats:s,onChatClick:C=>{A(!0),d(C)},onTogglePin:me,onDeleteChat:C=>{n(k=>k.filter(F=>F.characterId!==C));const V=localStorage.getItem("user_id")||"0";localStorage.removeItem(`chat_session_${V}_${C}`),localStorage.removeItem(`chat_history_${V}_${C}`),(c==null?void 0:c.characterId)===C&&d(null)},isDetailOpen:N&&!!c})})}};return i.jsx(_i,{children:i.jsx("div",{className:"fixed inset-0 w-full bg-primary-50 overflow-hidden",style:{height:"calc(var(--vh) * 100)",overscrollBehavior:"none"},children:i.jsxs("div",{className:"h-full w-full max-w-md mx-auto bg relative shadow-2xl rounded-none md:rounded-3xl md:overflow-hidden flex flex-col",children:[g&&i.jsx(Gu,{onBack:()=>{v(!1),x(null)},onCreate:Ae,isEdit:!!(w!=null&&w.isEdit),characterId:w==null?void 0:w.id,initial:w==null?void 0:w.initial,onUpdated:C=>{v(!1),x(null),h(C)}}),b&&i.jsx(fa,{currentPersona:T,onBack:()=>y(!1),onSave:C=>j(C)}),i.jsx(Ge,{initial:!1,children:c&&!b&&!g&&i.jsx(Ou,{character:c.character,initialMessages:$(c),userPersona:T,onBack:()=>{d(null),A(!1)},onUpdateLastMessage:z,onOpenUserSettings:()=>y(!0),onUpdateUserPersona:C=>j(C),onShowProfile:()=>{U(!0),ge(!1),M(null),h(c.character)}})}),i.jsx(Ge,{initial:!1,children:u&&!b&&!g&&!P&&(te?i.jsx(Mi,{character:u,createdId:u.id,onBack:()=>h(null),onStartChat:C=>oe(C),onEdit:C=>{x({initial:C,id:C.id,isEdit:!0}),v(!0)},onDeleted:async()=>{h(null);try{const V=(await Ei()).map(k=>({id:String(k.id),name:k.name||"",avatar:k.avatar||"",profileImage:"",status:lt.ONLINE,bio:k.plot_summary||"",tags:Array.isArray(k.tags)?k.tags:[],creator:ne.nickname||"",oneLinePersona:k.tagline||"",personality:k.personality||"",profession:k.occupation||"",age:k.age?String(k.age):"",roleType:"",gender:k.gender||"",currentRelationship:k.relationship||"",plotTheme:k.plot_theme||"",plotDescription:"",openingLine:k.opening_line||"",styleExamples:Array.isArray(k.styleExamples)?k.styleExamples:[],hobbies:k.hobbies||"",experiences:k.experiences||"",isPublic:k.visibility?k.visibility==="public":!1}));q(V)}catch{q([])}}}):i.jsx($u,{character:u,onBack:()=>h(null),onStartChat:()=>oe(u),isFromChat:ce,isExistingChat:!!s.find(C=>C.characterId===u.id)}))}),P&&!b&&!g&&i.jsx(Mi,{character:P.character,createdId:P.id,onBack:()=>M(null),onStartChat:C=>{M(null),oe(C)}}),O&&i.jsx(Zu,{story:O,onBack:()=>D(null),onStartRoleplay:()=>D(null)}),!b&&!g&&i.jsxs(i.Fragment,{children:[i.jsx(Tu,{title:e===Z.HOME?$e():e===Z.CHAT?"":"",variant:e===Z.ME?"overlay":"default",onFilterClick:()=>{e===Z.HOME&&f==="characters"&&v(!0)},showAdd:e===Z.HOME&&f==="characters"}),i.jsx(Ge,{initial:!1,children:i.jsx("div",{className:"flex-1 overflow-y-auto no-scrollbar scroll-smooth min-h-0",children:yt()})}),i.jsx(Cu,{activeTab:e,onTabChange:t})]})]})})})},ah=Object.freeze(Object.defineProperty({__proto__:null,default:sh},Symbol.toStringTag,{value:"Module"}));export{ah as A,Au as B};
//# sourceMappingURL=App-COhCSAwy.js.map
