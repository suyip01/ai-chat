{"version":3,"file":"LoginPage-Cwx44NTI.js","sources":["../../admin/components/LoginPage.jsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { BASE_URL } from '../api.js';\nimport { Sparkles, LogOut } from 'lucide-react';\nimport { useToast } from '../Toast.jsx';\n\nconst LoginPage = ({ onLogin }) => {\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const { showToast } = useToast();\n  const handleLogin = async () => {\n    try {\n      const r = await fetch(`${BASE_URL}/crypto/public-key`);\n      const pem = await r.text();\n      const b64 = pem.replace(/-----BEGIN PUBLIC KEY-----/, '').replace(/-----END PUBLIC KEY-----/, '').replace(/\\s+/g, '');\n      const bin = Uint8Array.from(atob(b64), c => c.charCodeAt(0));\n      const key = await window.crypto.subtle.importKey('spki', bin.buffer, { name: 'RSA-OAEP', hash: 'SHA-256' }, false, ['encrypt']);\n      const enc = await window.crypto.subtle.encrypt({ name: 'RSA-OAEP' }, key, new TextEncoder().encode(password));\n      const encB64 = btoa(String.fromCharCode(...new Uint8Array(enc)));\n      const res = await fetch(`${BASE_URL}/login`, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ username, password_encrypted: encB64 }) });\n      if (!res.ok) { showToast('登录失败', 'error'); return; }\n      const data = await res.json();\n      if (data?.access_token) localStorage.setItem('admin_access_token', data.access_token);\n      if (data?.refresh_token) localStorage.setItem('admin_refresh_token', data.refresh_token);\n      localStorage.setItem('admin_username', username);\n      onLogin();\n    } catch {\n      showToast('登录失败', 'error');\n    }\n  };\n  return (\n    <div className=\"min-h-screen flex items-center justify-center relative overflow-hidden\" onKeyDown={(e) => { if (e.key === 'Enter') handleLogin(); }}>\n      <div className=\"ambient-bg\"></div>\n      <div className=\"glass-card p-10 rounded-3xl w-full max-w-md shadow-2xl transform transition-all hover:scale-[1.01]\">\n        <div className=\"text-center mb-8\">\n          <div className=\"inline-flex items-center justify-center w-16 h-16 rounded-full bg-pink-100 text-pink-600 mb-4 shadow-inner\">\n            <Sparkles size={32} />\n          </div>\n          <h1 className=\"text-3xl font-cute text-pink-900 mb-2\">YumeCrush</h1>\n          <p className=\"text-pink-400 text-sm\">运营管理平台</p>\n        </div>\n        <div className=\"space-y-5\">\n          <div>\n            <label className=\"block text-sm font-bold text-pink-800 mb-2 ml-1\">管理员账号</label>\n            <input type=\"text\" placeholder=\"请输入管理员账号\" value={username} onChange={e => setUsername(e.target.value)} className=\"dream-input w-full px-4 py-3 rounded-2xl\" />\n          </div>\n          <div>\n            <label className=\"block text-sm font-bold text-pink-800 mb-2 ml-1\">密码</label>\n            <input type=\"password\" placeholder=\"••••••••\" value={password} onChange={e => setPassword(e.target.value)} className=\"dream-input w-full px-4 py-3 rounded-2xl\" />\n          </div>\n          <button onClick={handleLogin} className=\"w-full bg-gradient-to-r from-pink-500 to-pink-600 hover:from-pink-600 hover:to-pink-700 text-white font-bold py-3.5 rounded-2xl shadow-lg shadow-pink-200 transition-all transform active:scale-95 flex items-center justify-center gap-2\">\n            <LogOut size={18} className=\"rotate-180\" /> 登录后台\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default LoginPage;\n"],"names":["LoginPage","onLogin","username","setUsername","useState","password","setPassword","showToast","useToast","handleLogin","b64","BASE_URL","bin","c","key","enc","encB64","res","data","e","jsx","jsxs","Sparkles","LogOut"],"mappings":"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"}