import{B as i}from"./App-CkPLNNFB.js";import"./index-CTyRBVen.js";import"./x-DbfECaiq.js";const u=()=>localStorage.getItem("user_access_token")||"",k=()=>localStorage.getItem("user_refresh_token")||"",_=e=>{e&&localStorage.setItem("user_access_token",e)},m=async(e,s={})=>{const o=e.startsWith("http")?e:`${i}${e.startsWith("/")?"":"/"}${e}`,c=new Headers(s.headers||{}),a=u();a&&c.set("Authorization",`Bearer ${a}`);const r=await fetch(o,{...s,headers:c});if(r.status!==401)return r;const n=k();if(!n)return r;try{const h=await fetch(`${i}/auth/refresh`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:n})});if(h.ok){const t=await h.json();t!=null&&t.access_token&&_(t.access_token);const f=new Headers(s.headers||{});return f.set("Authorization",`Bearer ${t.access_token}`),fetch(o,{...s,headers:f})}}catch{}return r};export{m as authFetch};
//# sourceMappingURL=http-CnAUqEq7.js.map
