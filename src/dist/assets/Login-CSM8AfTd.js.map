{"version":3,"file":"Login-CSM8AfTd.js","sources":["../../node_modules/lucide-react/dist/esm/icons/eye-off.js","../../node_modules/lucide-react/dist/esm/icons/eye.js","../../user/components/Login.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.555.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49\",\n      key: \"ct8e1f\"\n    }\n  ],\n  [\"path\", { d: \"M14.084 14.158a3 3 0 0 1-4.242-4.242\", key: \"151rxh\" }],\n  [\n    \"path\",\n    {\n      d: \"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143\",\n      key: \"13bj9a\"\n    }\n  ],\n  [\"path\", { d: \"m2 2 20 20\", key: \"1ooewy\" }]\n];\nconst EyeOff = createLucideIcon(\"eye-off\", __iconNode);\n\nexport { __iconNode, EyeOff as default };\n//# sourceMappingURL=eye-off.js.map\n","/**\n * @license lucide-react v0.555.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0\",\n      key: \"1nclc0\"\n    }\n  ],\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"3\", key: \"1v7zrd\" }]\n];\nconst Eye = createLucideIcon(\"eye\", __iconNode);\n\nexport { __iconNode, Eye as default };\n//# sourceMappingURL=eye.js.map\n","\nimport React, { useEffect, useRef, useState } from 'react';\nimport { Eye, EyeOff } from 'lucide-react';\nimport { userAuthAPI } from '../api';\n\ninterface LoginProps {\n  onLogin: () => void;\n}\n\nexport const Login: React.FC<LoginProps> = ({ onLogin }) => {\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [showPassword, setShowPassword] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [viewportStyle, setViewportStyle] = useState<{ height: string | number; top: string | number }>({ height: '100%', top: 0 });\n  const containerRef = useRef<HTMLDivElement>(null);\n  const userInputRef = useRef<HTMLInputElement>(null);\n  const passInputRef = useRef<HTMLInputElement>(null);\n\n  useEffect(() => {\n    const handleVisualViewport = () => {\n      if (window.visualViewport) {\n        setViewportStyle({\n          height: `${window.visualViewport.height}px`,\n          top: `${window.visualViewport.offsetTop}px`\n        });\n      }\n    };\n\n    if (window.visualViewport) {\n      window.visualViewport.addEventListener('resize', handleVisualViewport);\n      window.visualViewport.addEventListener('scroll', handleVisualViewport);\n      handleVisualViewport();\n    }\n\n    return () => {\n      if (window.visualViewport) {\n        window.visualViewport.removeEventListener('resize', handleVisualViewport);\n        window.visualViewport.removeEventListener('scroll', handleVisualViewport);\n      }\n    }\n  }, [])\n\n  useEffect(() => {\n    try { userInputRef.current?.focus(); } catch { }\n  }, [])\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError(null);\n    if (!username.trim() || !password.trim()) { setError('请输入账号和密码'); return; }\n    setLoading(true);\n    try {\n      const data = await userAuthAPI.login(username.trim(), password.trim());\n      if (data?.access_token) try { localStorage.setItem('user_access_token', data.access_token) } catch { }\n      if (data?.refresh_token) try { localStorage.setItem('user_refresh_token', data.refresh_token) } catch { }\n      onLogin();\n    } catch {\n      setError('登录失败，请检查账号或密码');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div ref={containerRef} className=\"fixed left-0 w-full bg-primary-50 overflow-y-auto no-scrollbar scroll-smooth font-sans animate-in fade-in duration-700\" style={{ ...viewportStyle, overscrollBehavior: 'none' }}>\n      <div className=\"h-full w-full max-w-md mx-auto bg-white rounded-none md:rounded-3xl shadow-2xl border border-slate-200 overflow-hidden\">\n        <div className=\"min-h-full w-full flex flex-col px-8 py-10\">\n          <div className=\"w-full flex flex-col items-center z-10 max-w-sm m-auto\">\n\n          {/* Title Group */}\n          <div className=\"text-center mb-12\">\n            <h1 className=\"text-[40px] font-extrabold text-[#A855F7] mb-0 tracking-tight font-sans\">\n              YumeCrush\n            </h1>\n          </div>\n\n          {/* Form */}\n          <form onSubmit={handleSubmit} className=\"w-full space-y-5\">\n            {/* Username/Email Input */}\n            <input\n              type=\"text\"\n              placeholder=\"用户名\"\n              value={username}\n              onChange={(e) => setUsername(e.target.value)}\n              ref={userInputRef}\n              className=\"w-full h-[60px] px-6 rounded-2xl bg-white border border-[#F3F4F6] text-[#374151] placeholder:text-[#D1D5DB] outline-none focus:border-[#C084FC] focus:bg白 focus:ring-4 focus:ring-[#F3E8FF] transition-all text-[15px] font-medium shadow-sm\"\n            />\n\n            {/* Password */}\n            <div className=\"relative\">\n              <input\n                type={showPassword ? \"text\" : \"password\"}\n                placeholder=\"密码\"\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                ref={passInputRef}\n                className=\"w-full h-[60px] px-6 rounded-2xl bg白 border border-[#F3F4F6] text-[#374151] placeholder:text-[#D1D5DB] outline-none focus:border-[#C084FC] focus:bg白 focus:ring-4 focus:ring-[#F3E8FF] transition-all text-[15px] font-medium shadow-sm\"\n              />\n              <button\n                type=\"button\"\n                onClick={() => setShowPassword(!showPassword)}\n                className=\"absolute right-5 top-1/2 -translate-y-1/2 text-[#9CA3AF] hover:text-[#C084FC] transition-colors\"\n              >\n                {showPassword ? <EyeOff size={20} /> : <Eye size={20} />}\n              </button>\n            </div>\n\n            {/* Login Button */}\n            {error && (\n              <div className=\"text-red-500 text-xs font-bold\">{error}</div>\n            )}\n            <button\n              type=\"submit\"\n              disabled={loading}\n              className={`w-full h-[60px] ${loading ? 'bg-[#A855F7]/70' : 'bg-[#A855F7] hover:bg-[#9333EA]'} text-white font-bold text-[16px] rounded-2xl shadow-[0_10px_30px_rgba(168,85,247,0.3)] active:scale-[0.98] transition-all mt-4`}\n            >\n              {loading ? '登录中...' : '登录'}\n            </button>\n          </form>\n        </div>\n      </div>\n      </div>\n    </div>\n  );\n};\n"],"names":["__iconNode","EyeOff","createLucideIcon","Eye","Login","onLogin","username","setUsername","useState","password","setPassword","showPassword","setShowPassword","loading","setLoading","error","setError","viewportStyle","setViewportStyle","containerRef","useRef","userInputRef","passInputRef","useEffect","handleVisualViewport","_a","handleSubmit","e","data","userAuthAPI","jsx","jsxs"],"mappings":"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","x_google_ignoreList":[0,1]}