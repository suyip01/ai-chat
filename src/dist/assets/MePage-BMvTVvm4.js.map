{"version":3,"mappings":"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","names":["__iconNode","Mail","createLucideIcon","PenTool","Pen","MyCharacterAvatar","avatar","name","err","setErr","useState","jsx","MePage","userProfile","myCharacters","myUserCharacters","myStories","onUpdateProfile","onCharacterClick","onLogout","onEditStory","onDeleteStory","onEditCharacter","onDeleteCharacter","onReadStory","onAddStory","onAddCharacter","isEditingName","setIsEditingName","tempName","setTempName","showLogoutModal","setShowLogoutModal","tempAvatar","setTempAvatar","userImgError","setUserImgError","isTouch","localStories","setLocalStories","storyOffsets","setStoryOffsets","confirmStoryId","setConfirmStoryId","storyStartXRef","useRef","storyStartYRef","storyActiveIdRef","storyInitialOffsetRef","localCharacters","setLocalCharacters","charOffsets","setCharOffsets","confirmCharId","setConfirmCharId","charStartXRef","charStartYRef","charActiveIdRef","charInitialOffsetRef","contextMenu","setContextMenu","handleContextMenu","e","id","type","x","menuWidth","fileInputRef","dataUrlToBlob","dataUrl","parts","mime","_a","bstr","n","u8","handleAvatarClick","handleFileChange","file","reader","saveName","nm","authFetch","__vitePreload","useEffect","onStoryTouchStart","onStoryTouchMove","dx","dy","next","prev","onStoryTouchEnd","current","final","closeStorySwipe","onCharTouchStart","onCharTouchMove","onCharTouchEnd","closeCharSwipe","handleEditStory","story","handleConfirmDelete","s","deleteUserStory","handleEditCharacter","char","handleConfirmDeleteChar","c","deleteUserCharacter","jsxs","ImageCropper","cropped","token","avatarUrl","blob","fd","fname","Camera","Edit2","Plus","offset","revealRight","revealLeft","Fragment","t","ChevronRight","LogOut","Trash2"],"ignoreList":[0,1,2],"sources":["../../node_modules/lucide-react/dist/esm/icons/mail.js","../../node_modules/lucide-react/dist/esm/icons/pen-tool.js","../../node_modules/lucide-react/dist/esm/icons/pen.js","../../user/components/MePage.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.555.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7\", key: \"132q7q\" }],\n  [\"rect\", { x: \"2\", y: \"4\", width: \"20\", height: \"16\", rx: \"2\", key: \"izxlao\" }]\n];\nconst Mail = createLucideIcon(\"mail\", __iconNode);\n\nexport { __iconNode, Mail as default };\n//# sourceMappingURL=mail.js.map\n","/**\n * @license lucide-react v0.555.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z\",\n      key: \"nt11vn\"\n    }\n  ],\n  [\n    \"path\",\n    {\n      d: \"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18\",\n      key: \"15qc1e\"\n    }\n  ],\n  [\"path\", { d: \"m2.3 2.3 7.286 7.286\", key: \"1wuzzi\" }],\n  [\"circle\", { cx: \"11\", cy: \"11\", r: \"2\", key: \"xmgehs\" }]\n];\nconst PenTool = createLucideIcon(\"pen-tool\", __iconNode);\n\nexport { __iconNode, PenTool as default };\n//# sourceMappingURL=pen-tool.js.map\n","/**\n * @license lucide-react v0.555.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z\",\n      key: \"1a8usu\"\n    }\n  ]\n];\nconst Pen = createLucideIcon(\"pen\", __iconNode);\n\nexport { __iconNode, Pen as default };\n//# sourceMappingURL=pen.js.map\n","\nimport React, { useState, useRef, useEffect } from 'react';\nimport { ChevronRight, LogOut, Camera, Edit2, Mail, PenTool, Trash2, Plus } from 'lucide-react';\nimport { Character, UserProfile, Story } from '../types';\nimport { deleteUserStory } from '../services/userStoriesService';\nimport { deleteUserCharacter } from '../services/userCharactersService';\nimport { ImageCropper } from './ImageCropper';\n\nconst MyCharacterAvatar: React.FC<{ avatar?: string; name: string }> = ({ avatar, name }) => {\n  const [err, setErr] = useState(false)\n  return (\n    <div className=\"w-14 h-14 rounded-full bg-slate-100 flex-shrink-0 overflow-hidden border border-slate-50 flex items-center justify-center\">\n      {(!err && avatar) ? (\n        <img src={avatar} className=\"w-full h-full object-cover\" alt={name} onError={() => setErr(true)} />\n      ) : (\n        <span className=\"text-base font-bold text-slate-500\">{name?.[0] || '?'}</span>\n      )}\n    </div>\n  )\n}\n\ninterface MePageProps {\n  userProfile: UserProfile;\n  myCharacters: Character[];\n  myUserCharacters: Character[];\n  myStories: Story[];\n  onUpdateProfile: (profile: UserProfile) => void;\n  onCharacterClick: (character: Character) => void;\n  onLogout: () => void;\n  onEditStory?: (story: Story) => void;\n  onDeleteStory?: (story: Story) => void;\n  onEditCharacter?: (character: Character) => void;\n  onDeleteCharacter?: (character: Character) => void;\n  onReadStory?: (story: Story) => void;\n  onAddStory?: () => void;\n  onAddCharacter?: () => void;\n}\n\nexport const MePage: React.FC<MePageProps> = ({\n  userProfile,\n  myCharacters,\n  myUserCharacters,\n  myStories,\n  onUpdateProfile,\n  onCharacterClick,\n  onLogout,\n  onEditStory,\n  onDeleteStory,\n  onEditCharacter,\n  onDeleteCharacter,\n  onReadStory,\n  onAddStory,\n  onAddCharacter\n}) => {\n  const [isEditingName, setIsEditingName] = useState(false);\n  const [tempName, setTempName] = useState(userProfile.nickname);\n  const [showLogoutModal, setShowLogoutModal] = useState(false);\n  const [tempAvatar, setTempAvatar] = useState<string | null>(null);\n  const [userImgError, setUserImgError] = useState(false);\n  const isTouch = (navigator as any)?.maxTouchPoints > 0;\n\n  // Story State\n  const [localStories, setLocalStories] = useState<Story[]>(myStories || []);\n  const [storyOffsets, setStoryOffsets] = useState<Record<string | number, number>>({});\n  const [confirmStoryId, setConfirmStoryId] = useState<string | number | null>(null);\n  const storyStartXRef = useRef<number>(0);\n  const storyStartYRef = useRef<number>(0);\n  const storyActiveIdRef = useRef<string | number | null>(null);\n  const storyInitialOffsetRef = useRef<number>(0);\n\n  // Character State\n  const [localCharacters, setLocalCharacters] = useState<Character[]>(myUserCharacters || []);\n  const [charOffsets, setCharOffsets] = useState<Record<string | number, number>>({});\n  const [confirmCharId, setConfirmCharId] = useState<string | number | null>(null);\n  const charStartXRef = useRef<number>(0);\n  const charStartYRef = useRef<number>(0);\n  const charActiveIdRef = useRef<string | number | null>(null);\n  const charInitialOffsetRef = useRef<number>(0);\n\n  const [contextMenu, setContextMenu] = useState<{ visible: boolean; x: number; y: number; id: string | number | null; type: 'story' | 'character' | null }>({ visible: false, x: 0, y: 0, id: null, type: null });\n\n  const handleContextMenu = (e: React.MouseEvent, id: string | number, type: 'story' | 'character') => {\n    e.preventDefault();\n    if (isTouch) return; // Don't show on touch devices, they use swipe\n\n    let x = e.clientX;\n    const menuWidth = 140; // Approx width\n    if (x + menuWidth > window.innerWidth) {\n      x = window.innerWidth - menuWidth - 10;\n    }\n\n    setContextMenu({\n      visible: true,\n      x,\n      y: e.clientY,\n      id,\n      type\n    });\n  };\n\n\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const dataUrlToBlob = (dataUrl: string) => {\n    const parts = dataUrl.split(',');\n    const mime = parts[0].match(/:(.*?);/)?.[1] || 'image/jpeg';\n    const bstr = atob(parts[1]);\n    let n = bstr.length;\n    const u8 = new Uint8Array(n);\n    while (n--) u8[n] = bstr.charCodeAt(n);\n    return new Blob([u8], { type: mime });\n  };\n\n  const handleAvatarClick = () => {\n    fileInputRef.current?.click();\n  };\n\n  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (file) {\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        setTempAvatar(reader.result as string);\n      };\n      reader.readAsDataURL(file);\n    }\n    if (fileInputRef.current) fileInputRef.current.value = '';\n  };\n\n  const saveName = async () => {\n    const nm = tempName.trim();\n    if (!nm) {\n      setTempName(userProfile.nickname);\n      setIsEditingName(false);\n      return;\n    }\n    try {\n      const { authFetch } = await import('../services/http')\n      await authFetch('/user/profile', { method: 'PUT', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ nickname: nm }) })\n      onUpdateProfile({ ...userProfile, nickname: nm })\n    } catch {\n      setTempName(userProfile.nickname)\n    }\n    setIsEditingName(false);\n  };\n\n  useEffect(() => {\n    setLocalStories(myStories || []);\n  }, [userProfile.usedCount])\n\n  useEffect(() => {\n    setLocalStories(myStories || []);\n  }, [myStories])\n\n  useEffect(() => {\n    setLocalCharacters(myUserCharacters || []);\n  }, [myUserCharacters])\n\n  // Story Swipe Handlers\n  const onStoryTouchStart = (e: React.TouchEvent, id: string | number) => {\n    storyStartXRef.current = e.touches[0].clientX;\n    storyStartYRef.current = e.touches[0].clientY;\n    storyActiveIdRef.current = id;\n    storyInitialOffsetRef.current = storyOffsets[id] || 0;\n  };\n  const onStoryTouchMove = (e: React.TouchEvent, id: string | number) => {\n    if (storyActiveIdRef.current !== id) return;\n    const dx = e.touches[0].clientX - storyStartXRef.current;\n    const dy = e.touches[0].clientY - storyStartYRef.current;\n    if (Math.abs(dy) > Math.abs(dx)) return; // Vertical scroll, ignore swipe\n\n    let next = 0;\n    if (storyInitialOffsetRef.current === 0) {\n      next = Math.max(-96, Math.min(96, dx));\n    } else if (storyInitialOffsetRef.current > 0) {\n      next = Math.max(0, Math.min(96, storyInitialOffsetRef.current + dx));\n    } else {\n      next = Math.min(0, Math.max(-96, storyInitialOffsetRef.current + dx));\n    }\n    setStoryOffsets(prev => ({ ...prev, [id]: next }));\n  };\n  const onStoryTouchEnd = (id: string | number) => {\n    if (storyActiveIdRef.current !== id) return;\n    const current = storyOffsets[id] || 0;\n    let final = 0;\n    if (storyInitialOffsetRef.current === 0) {\n      final = current > 60 ? 96 : current < -60 ? -96 : 0;\n    } else if (storyInitialOffsetRef.current > 0) {\n      final = current > 60 ? 96 : 0;\n    } else {\n      final = current < -60 ? -96 : 0;\n    }\n    setStoryOffsets(prev => ({ ...prev, [id]: final }));\n    storyActiveIdRef.current = null;\n  };\n  const closeStorySwipe = (id: string | number) => setStoryOffsets(prev => ({ ...prev, [id]: 0 }));\n\n  // Character Swipe Handlers\n  const onCharTouchStart = (e: React.TouchEvent, id: string | number) => {\n    charStartXRef.current = e.touches[0].clientX;\n    charStartYRef.current = e.touches[0].clientY;\n    charActiveIdRef.current = id;\n    charInitialOffsetRef.current = charOffsets[id] || 0;\n  };\n  const onCharTouchMove = (e: React.TouchEvent, id: string | number) => {\n    if (charActiveIdRef.current !== id) return;\n    const dx = e.touches[0].clientX - charStartXRef.current;\n    const dy = e.touches[0].clientY - charStartYRef.current;\n    if (Math.abs(dy) > Math.abs(dx)) return; // Vertical scroll, ignore swipe\n\n    let next = 0;\n    if (charInitialOffsetRef.current === 0) {\n      next = Math.max(-96, Math.min(96, dx));\n    } else if (charInitialOffsetRef.current > 0) {\n      next = Math.max(0, Math.min(96, charInitialOffsetRef.current + dx));\n    } else {\n      next = Math.min(0, Math.max(-96, charInitialOffsetRef.current + dx));\n    }\n    setCharOffsets(prev => ({ ...prev, [id]: next }));\n  };\n  const onCharTouchEnd = (id: string | number) => {\n    if (charActiveIdRef.current !== id) return;\n    const current = charOffsets[id] || 0;\n    let final = 0;\n    if (charInitialOffsetRef.current === 0) {\n      final = current > 60 ? 96 : current < -60 ? -96 : 0;\n    } else if (charInitialOffsetRef.current > 0) {\n      final = current > 60 ? 96 : 0;\n    } else {\n      final = current < -60 ? -96 : 0;\n    }\n    setCharOffsets(prev => ({ ...prev, [id]: final }));\n    charActiveIdRef.current = null;\n  };\n  const closeCharSwipe = (id: string | number) => setCharOffsets(prev => ({ ...prev, [id]: 0 }));\n\n  const handleEditStory = (story: Story) => {\n    closeStorySwipe(story.id as any);\n    if (onEditStory) onEditStory(story);\n  };\n  const handleConfirmDelete = async (id: string | number) => {\n    const story = localStories.find(s => s.id === id);\n    setConfirmStoryId(null);\n    if (onDeleteStory && story) {\n      onDeleteStory(story);\n      return;\n    }\n    try {\n      await deleteUserStory(id);\n      setLocalStories(prev => prev.filter(s => s.id !== id));\n    } catch { }\n  };\n\n  const handleEditCharacter = (char: Character) => {\n    closeCharSwipe(char.id);\n    if (onEditCharacter) onEditCharacter(char);\n  };\n\n  const handleConfirmDeleteChar = async (id: string | number) => {\n    const char = localCharacters.find(c => c.id === id);\n    setConfirmCharId(null);\n    if (onDeleteCharacter && char) {\n      onDeleteCharacter(char);\n      // We assume parent updates the list, but we can also update local state optimistically\n      // setLocalCharacters(prev => prev.filter(c => c.id !== id)); \n      // Actually if onDeleteCharacter is provided, we rely on it. But for consistency with story:\n    }\n\n    // If we want to handle it internally like story:\n    try {\n      await deleteUserCharacter(id);\n      setLocalCharacters(prev => prev.filter(c => c.id !== id));\n      if (onDeleteCharacter && char) onDeleteCharacter(char);\n    } catch { }\n  };\n\n\n  return (\n    <div className=\"h-full w-full bg-[#F8F9FB] flex flex-col font-kosugi relative\">\n\n      {/* Cropper Modal */}\n      {tempAvatar && (\n        <ImageCropper\n          imageSrc={tempAvatar}\n          onCancel={() => setTempAvatar(null)}\n          onCrop={async (cropped) => {\n            const token = localStorage.getItem('user_access_token');\n            let avatarUrl: string | undefined = cropped;\n            try {\n              if (cropped && cropped.startsWith('data:image')) {\n                const blob = dataUrlToBlob(cropped);\n                const fd = new FormData();\n                const fname = `${Date.now()}_${Math.random().toString(36).slice(2, 8)}.jpg`;\n                fd.append('avatar', blob, 'avatar.jpg');\n                fd.append('filename', fname);\n                avatarUrl = `/uploads/users/avatars/${fname}`;\n                await fetch('/api/uploads/avatar', { method: 'POST', headers: { Authorization: token ? `Bearer ${token}` : '' }, body: fd }).catch(() => { });\n              }\n            } catch { }\n            try { const { authFetch } = await import('../services/http'); await authFetch('/user/profile', { method: 'PUT', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ avatar: avatarUrl }) }) } catch { }\n            onUpdateProfile({ ...userProfile, avatar: avatarUrl || userProfile.avatar });\n            setTempAvatar(null);\n          }}\n        />\n      )}\n\n      {/* 1. Header Area with Gradient */}\n      <div className=\"relative pb-4\">\n        <div className=\"h-40 bg-gradient-to-br from-pink-200 via-purple-200 to-indigo-200 rounded-b-[40px] relative overflow-hidden\">\n          {/* Decorative circles */}\n          <div className=\"absolute top-[-20px] left-[-20px] w-40 h-40 bg-white/20 rounded-full blur-xl\"></div>\n          <div className=\"absolute bottom-[-10px] right-[-10px] w-32 h-32 bg-purple-400/20 rounded-full blur-xl\"></div>\n        </div>\n\n        {/* Profile Card - Compacted */}\n        <div className=\"absolute top-16 left-4 right-4 bg-white rounded-3xl shadow-lg p-4 flex flex-col items-center animate-in slide-in-from-bottom-4 duration-500\">\n          {/* Avatar - Smaller Size */}\n          <div className=\"relative -mt-12 mb-2 group cursor-pointer\" onClick={handleAvatarClick}>\n            <div className=\"w-20 h-20 rounded-full border-4 border-white shadow-md overflow-hidden bg-slate-100 flex items-center justify-center\">\n              {(!userImgError && (userProfile.avatar || '/uploads/avatars/default_avatar.jpg')) ? (\n                <img src={userProfile.avatar || '/uploads/avatars/default_avatar.jpg'} alt=\"Me\" className=\"w-full h-full object-cover\" onError={() => setUserImgError(true)} />\n              ) : (\n                <span className=\"text-xl font-bold text-slate-500\">{userProfile.nickname?.[0] || '?'}</span>\n              )}\n            </div>\n            <div className=\"absolute bottom-0 right-0 bg-primary-500 p-1.5 rounded-full text-white border-2 border-white shadow-sm\">\n              <Camera size={10} />\n            </div>\n            <input type=\"file\" ref={fileInputRef} className=\"hidden\" accept=\"image/*\" onChange={handleFileChange} />\n          </div>\n\n          {/* Name & Edit */}\n          <div className=\"flex items-center gap-2 mb-1\">\n            {isEditingName ? (\n              <input\n                value={tempName}\n                onChange={(e) => setTempName(e.target.value)}\n                onBlur={saveName}\n                onKeyDown={(e) => e.key === 'Enter' && saveName()}\n                autoFocus\n                className=\"text-lg font-bold text-center text-slate-800 border-b-2 border-primary-300 outline-none bg-transparent min-w-[100px]\"\n              />\n            ) : (\n              <h2 className=\"text-lg font-bold text-slate-800\">{userProfile.nickname}</h2>\n            )}\n            {!isEditingName && (\n              <button onClick={() => setIsEditingName(true)} className=\"text-slate-400 hover:text-primary-500\">\n                <Edit2 size={12} />\n              </button>\n            )}\n          </div>\n\n          {/* Email Only */}\n          <div className=\"flex flex-col items-center gap-1 mb-1\">\n            <div className=\"flex items-center gap-1.5 text-slate-400 text-[10px] font-bold bg-slate-50 px-3 py-0.5 rounded-full\">\n              <Mail size={10} />\n              <span className=\"tracking-wide\">{userProfile.email}</span>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* 2. Scrollable Content - Added margin top to clear the card */}\n      <div className=\"flex-1 overflow-y-auto px-4 pb-24 space-y-6 no-scrollbar mt-8\">\n        <div>\n          <div className=\"flex items-center justify-between mb-3 px-1\">\n            <div className=\"flex items-center gap-2\">\n              <div className=\"w-1 h-4 bg-indigo-400 rounded-full\"></div>\n              <h3 className=\"font-bold text-slate-700\">我的故事</h3>\n            </div>\n            <button\n              onClick={onAddStory}\n              className=\"w-6 h-6 flex items-center justify-center rounded-full bg-white text-purple-500 border border-purple-100 shadow-sm hover:bg-purple-50 active:scale-95\"\n            >\n              <Plus size={14} />\n            </button>\n          </div>\n          {localStories && localStories.length > 0 ? (\n            <div className=\"flex flex-col gap-3\">\n              {localStories.map(story => (\n                <div key={story.id} className=\"relative overflow-hidden rounded-2xl\">\n                  {(() => {\n                    const offset = storyOffsets[story.id] || 0;\n                    const revealRight = Math.min(96, Math.max(0, -offset));\n                    const revealLeft = Math.min(96, Math.max(0, offset));\n                    return (\n                      <>\n                        <div className=\"absolute right-0 top-0 bottom-0 bg-red-500 flex items-center justify-center rounded-r-2xl shadow-sm\" style={{ width: `${revealRight}px`, transition: 'width 120ms ease' }}>\n                          <button onClick={() => setConfirmStoryId(story.id)} className=\"text-white font-bold drop-shadow-sm\">删除</button>\n                        </div>\n                        <div className=\"absolute left-0 top-0 bottom-0 bg-indigo-500 flex items-center justify-center rounded-l-2xl shadow-sm\" style={{ width: `${revealLeft}px`, transition: 'width 120ms ease' }}>\n                          <button onClick={() => handleEditStory(story)} className=\"text-white font-bold drop-shadow-sm\">编辑</button>\n                        </div>\n                      </>\n                    )\n                  })()}\n                  <div\n                    onTouchStart={(e) => onStoryTouchStart(e, story.id)}\n                    onTouchMove={(e) => onStoryTouchMove(e, story.id)}\n                    onTouchEnd={() => onStoryTouchEnd(story.id)}\n                    onContextMenu={(e) => handleContextMenu(e, story.id, 'story')}\n                    onClick={() => { if ((storyOffsets[story.id] || 0) === 0) { onReadStory && onReadStory(story); } }}\n                    style={{ transform: `translateX(${storyOffsets[story.id] || 0}px)`, transition: 'transform 180ms ease' }}\n                    className={`${(storyOffsets[story.id] || 0) < 0 ? 'rounded-l-2xl rounded-r-none' : (storyOffsets[story.id] || 0) > 0 ? 'rounded-l-none rounded-r-2xl' : 'rounded-2xl'} bg-white p-3 shadow-sm flex gap-4 border border-transparent hover:border-indigo-100 group relative overflow-hidden`}\n                  >\n                    <div className=\"w-16 h-20 rounded-xl bg-slate-100 flex-shrink-0 overflow-hidden relative\">\n                      <img src={story.image || '/uploads/covers/default_storyimg.jpg'} className=\"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500\" alt={story.title} />\n                    </div>\n                    <div className=\"flex-1 min-w-0\">\n                      <div className=\"flex justify-between items-start\">\n                        <h4 className=\"font-bold text-slate-800 text-base\">{story.title}</h4>\n                        <div className=\"flex flex-col items-end gap-0.5\">\n                          <span className={`text-[10px] px-1.5 py-0.5 rounded font-bold ${story.status === 'published' ? 'bg-green-100 text-green-600' : 'bg-slate-100 text-slate-400'}`}>\n                            {story.status === 'published' ? '公开' : '草稿'}\n                          </span>\n                        </div>\n                      </div>\n                      <p className=\"text-xs text-slate-400 line-clamp-1\">{story.description}</p>\n                      <div className=\"flex gap-2 mt-2\">\n                        {(story.tags || []).slice(0, 2).map(t => (\n                          <span key={t} className=\"text-[10px] bg-slate-50 text-slate-400 px-1.5 py-0.5 rounded\">{t}</span>\n                        ))}\n                      </div>\n                    </div>\n                    <div className=\"self-center\">\n                      <PenTool size={16} className=\"text-slate-300\" />\n                    </div>\n                  </div>\n                </div>\n              ))}\n            </div>\n          ) : (\n            <div className=\"bg-white rounded-2xl p-6 text-center shadow-sm border border-slate-50 border-dashed\">\n              <p className=\"text-xs text-slate-400\">还没有创作过故事</p>\n            </div>\n          )}\n        </div>\n\n        {/* My Characters */}\n        <div>\n          <div className=\"flex items-center justify-between mb-3 px-1\">\n            <div className=\"flex items-center gap-2\">\n              <div className=\"w-1 h-4 bg-purple-400 rounded-full\"></div>\n              <h3 className=\"font-bold text-slate-700\">我的角色</h3>\n            </div>\n            <button\n              onClick={onAddCharacter}\n              className=\"w-6 h-6 flex items-center justify-center rounded-full bg-white text-purple-500 border border-purple-100 shadow-sm hover:bg-purple-50 active:scale-95\"\n            >\n              <Plus size={14} />\n            </button>\n          </div>\n\n          {localCharacters.length > 0 ? (\n            <div className=\"flex flex-col gap-3\">\n              {localCharacters.map(char => (\n                <div key={char.id} className=\"relative overflow-hidden rounded-2xl\">\n                  {(() => {\n                    const offset = charOffsets[char.id] || 0;\n                    const revealRight = Math.min(96, Math.max(0, -offset));\n                    const revealLeft = Math.min(96, Math.max(0, offset));\n                    return (\n                      <>\n                        <div className=\"absolute right-0 top-0 bottom-0 bg-red-500 flex items-center justify-center rounded-r-2xl shadow-sm\" style={{ width: `${revealRight}px`, transition: 'width 120ms ease' }}>\n                          <button onClick={() => setConfirmCharId(char.id)} className=\"text-white font-bold drop-shadow-sm\">删除</button>\n                        </div>\n                        <div className=\"absolute left-0 top-0 bottom-0 bg-indigo-500 flex items-center justify-center rounded-l-2xl shadow-sm\" style={{ width: `${revealLeft}px`, transition: 'width 120ms ease' }}>\n                          <button onClick={() => handleEditCharacter(char)} className=\"text-white font-bold drop-shadow-sm\">编辑</button>\n                        </div>\n                      </>\n                    )\n                  })()}\n                  <div\n                    onClick={() => onCharacterClick(char)}\n                    onTouchStart={(e) => onCharTouchStart(e, char.id)}\n                    onTouchMove={(e) => onCharTouchMove(e, char.id)}\n                    onTouchEnd={() => onCharTouchEnd(char.id)}\n                    onContextMenu={(e) => handleContextMenu(e, char.id, 'character')}\n                    style={{ transform: `translateX(${charOffsets[char.id] || 0}px)`, transition: 'transform 180ms ease' }}\n                    className={`${(charOffsets[char.id] || 0) < 0 ? 'rounded-l-2xl rounded-r-none' : (charOffsets[char.id] || 0) > 0 ? 'rounded-l-none rounded-r-2xl' : 'rounded-2xl'} bg-white p-3 shadow-sm flex items-center gap-4 active:scale-[0.98] transition-all cursor-pointer border border-transparent hover:border-purple-100 group relative overflow-hidden`}\n                  >\n                    <MyCharacterAvatar avatar={char.avatar} name={char.name} />\n                    <div className=\"flex-1 min-w-0\">\n                      <div className=\"flex justify-between items-start\">\n                        <h4 className=\"font-bold text-slate-800\">{char.name}</h4>\n                        <div className=\"flex flex-col items-end gap-0.5\">\n                          <span className={`text-[10px] px-1.5 py-0.5 rounded font-bold ${((char as any).isPublished ? (char.isPublic ? 'bg-green-100 text-green-600' : 'bg-pink-100 text-pink-600') : 'bg-slate-100 text-slate-400')}`}>\n                            {((char as any).isPublished ? (char.isPublic ? '公开' : '私密') : '草稿')}\n                          </span>\n                        </div>\n                      </div>\n                      <p className=\"text-xs text-slate-400 truncate mt-1\">{char.oneLinePersona || char.bio}</p>\n                    </div>\n                    <ChevronRight size={16} className=\"text-slate-300\" />\n                  </div>\n                </div>\n              ))}\n            </div>\n          ) : (\n            <div className=\"bg-white rounded-2xl p-6 text-center shadow-sm border border-slate-50 border-dashed\">\n              <p className=\"text-xs text-slate-400\">还没有创建过角色</p>\n            </div>\n          )}\n        </div>\n\n\n\n        {/* System Menu - Only Logout */}\n        <div className=\"bg-white rounded-3xl shadow-sm p-2\">\n          <button\n            onClick={() => setShowLogoutModal(true)}\n            className=\"w-full flex items-center justify-center gap-3 p-2 hover:bg-red-50 active:bg-red-100 active:scale-95 rounded-2xl transition-all group\"\n          >\n            <div className=\"w-8 h-8 rounded-full bg-red-50 text-red-400 flex items-center justify-center group-hover:bg-red-100 group-hover:text-red-500 transition-colors\">\n              <LogOut size={16} />\n            </div>\n            <span className=\"text-center font-bold text-slate-700 text-sm group-hover:text-red-500\">退出登录</span>\n          </button>\n        </div>\n\n      </div>\n\n      {/* Logout Modal */}\n      {showLogoutModal && (\n        <div className=\"fixed inset-0 z-[100] flex items-center justify-center bg-black/40 backdrop-blur-sm animate-in fade-in duration-200\">\n          <div className=\"bg-white rounded-[32px] p-6 w-[80%] max-w-xs shadow-2xl scale-100 animate-in zoom-in-95 duration-200 text-center\">\n            <div className=\"w-16 h-16 bg-red-50 text-red-400 rounded-full flex items-center justify-center mx-auto mb-4\">\n              <LogOut size={28} />\n            </div>\n            <h3 className=\"text-lg font-bold text-slate-800 mb-2\">你确定要退出吗？</h3>\n            <p className=\"text-xs text-slate-400 mb-6 px-4 leading-relaxed\">\n            </p>\n            <div className=\"flex gap-3\">\n              <button\n                onClick={() => setShowLogoutModal(false)}\n                className=\"flex-1 py-3 rounded-2xl bg-slate-100 text-slate-600 font-bold hover:bg-slate-200 transition-colors text-sm\"\n              >\n                取消\n              </button>\n              <button\n                onClick={onLogout}\n                className=\"flex-1 py-3 rounded-2xl bg-red-500 text-white font-bold shadow-lg shadow-red-200 hover:bg-red-600 transition-colors text-sm\"\n              >\n                确认退出\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {confirmStoryId && (\n        <>\n          <div className=\"fixed inset-0 z-[80] bg-black/20 animate-[fadeBg_200ms_ease]\"></div>\n          <div className=\"fixed inset-0 z-[90] flex items-center justify-center\">\n            <div className=\"bg-white rounded-2xl shadow-2xl border border-slate-200 w-[85%] max-w-sm animate-[fadeCard_200ms_ease]\">\n              <div className=\"px-6 py-5 text-center text-slate-800 font-bold\">确认删除此故事？</div>\n              <div className=\"h-[1px] bg-slate-100\"></div>\n              <div className=\"flex\">\n                <button className=\"flex-1 py-4 text-slate-600 active:opacity-70\" onClick={() => { if (confirmStoryId != null) closeStorySwipe(confirmStoryId); setConfirmStoryId(null); }}>取消</button>\n                <div className=\"w-[1px] bg-slate-100\"></div>\n                <button className=\"flex-1 py-4 text-red-600 font-bold active:opacity-70\" onClick={() => { const id = confirmStoryId as any; handleConfirmDelete(id); }}>确认删除</button>\n              </div>\n            </div>\n          </div>\n          <style>{`\n            @keyframes fadeCard { from { opacity: 0; transform: translateY(-6px) } to { opacity: 1; transform: translateY(0) } }\n            @keyframes fadeBg { from { opacity: 0 } to { opacity: 1 } }\n          `}</style>\n        </>\n      )}\n\n      {confirmCharId && (\n        <>\n          <div className=\"fixed inset-0 z-[80] bg-black/20 animate-[fadeBg_200ms_ease]\"></div>\n          <div className=\"fixed inset-0 z-[90] flex items-center justify-center\">\n            <div className=\"bg-white rounded-2xl shadow-2xl border border-slate-200 w-[85%] max-w-sm animate-[fadeCard_200ms_ease]\">\n              <div className=\"px-6 py-5 text-center text-slate-800 font-bold\">确认删除此角色？</div>\n              <div className=\"h-[1px] bg-slate-100\"></div>\n              <div className=\"flex\">\n                <button className=\"flex-1 py-4 text-slate-600 active:opacity-70\" onClick={() => { if (confirmCharId != null) closeCharSwipe(confirmCharId); setConfirmCharId(null); }}>取消</button>\n                <div className=\"w-[1px] bg-slate-100\"></div>\n                <button className=\"flex-1 py-4 text-red-600 font-bold active:opacity-70\" onClick={() => { const id = confirmCharId as any; handleConfirmDeleteChar(id); }}>确认删除</button>\n              </div>\n            </div>\n          </div>\n        </>\n      )}\n\n      {/* Context Menu */}\n      {contextMenu.visible && (\n        <>\n          <div\n            className=\"fixed inset-0 z-[99]\"\n            onClick={() => setContextMenu(prev => ({ ...prev, visible: false }))}\n            onContextMenu={(e) => { e.preventDefault(); setContextMenu(prev => ({ ...prev, visible: false })); }}\n          ></div>\n          <div\n            className=\"fixed z-[100] bg-white rounded-xl shadow-xl border border-slate-100 overflow-hidden min-w-[120px] animate-in fade-in zoom-in-95 duration-100\"\n            style={{ top: contextMenu.y, left: contextMenu.x }}\n          >\n            <button\n              onClick={() => {\n                if (contextMenu.type === 'story') {\n                  const story = localStories.find(s => s.id === contextMenu.id);\n                  if (story) handleEditStory(story);\n                } else if (contextMenu.type === 'character') {\n                  const char = localCharacters.find(c => c.id === contextMenu.id);\n                  if (char) handleEditCharacter(char);\n                }\n                setContextMenu(prev => ({ ...prev, visible: false }));\n              }}\n              className=\"w-full text-left px-4 py-3 text-sm font-bold text-slate-700 hover:bg-slate-50 flex items-center gap-2 transition-colors\"\n            >\n              <Edit2 size={16} className=\"text-indigo-500\" />\n              编辑\n            </button>\n            <div className=\"h-[1px] bg-slate-100 w-full\"></div>\n            <button\n              onClick={() => {\n                if (contextMenu.type === 'story') {\n                  setConfirmStoryId(contextMenu.id);\n                } else if (contextMenu.type === 'character') {\n                  setConfirmCharId(contextMenu.id);\n                }\n                setContextMenu(prev => ({ ...prev, visible: false }));\n              }}\n              className=\"w-full text-left px-4 py-3 text-sm font-bold text-red-500 hover:bg-red-50 flex items-center gap-2 transition-colors\"\n            >\n              <Trash2 size={16} />\n              删除\n            </button>\n          </div>\n        </>\n      )}\n\n    </div>\n  );\n};\n"],"file":"assets/MePage-BMvTVvm4.js"}