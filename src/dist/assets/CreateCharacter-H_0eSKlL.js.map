{"version":3,"file":"CreateCharacter-H_0eSKlL.js","sources":["../../node_modules/lucide-react/dist/esm/icons/globe.js","../../node_modules/lucide-react/dist/esm/icons/lock.js","../../user/components/CreateCharacter.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.555.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }],\n  [\"path\", { d: \"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20\", key: \"13o1zl\" }],\n  [\"path\", { d: \"M2 12h20\", key: \"9i4pu4\" }]\n];\nconst Globe = createLucideIcon(\"globe\", __iconNode);\n\nexport { __iconNode, Globe as default };\n//# sourceMappingURL=globe.js.map\n","/**\n * @license lucide-react v0.555.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"rect\", { width: \"18\", height: \"11\", x: \"3\", y: \"11\", rx: \"2\", ry: \"2\", key: \"1w4ew1\" }],\n  [\"path\", { d: \"M7 11V7a5 5 0 0 1 10 0v4\", key: \"fwvmzm\" }]\n];\nconst Lock = createLucideIcon(\"lock\", __iconNode);\n\nexport { __iconNode, Lock as default };\n//# sourceMappingURL=lock.js.map\n","\nimport React, { useState, useRef, useEffect } from 'react';\nimport { ChevronLeft, Camera, Plus, ChevronRight, X, ChevronDown, ChevronUp, Globe, Lock, Info, AlertCircle } from 'lucide-react';\nimport { Character, CharacterStatus } from '../types';\nimport { ImageCropper } from './ImageCropper';\nimport { createCharacter, createUserCharacterDraft, updateUserCharacter, updateUserCharacterDraft, getUserCharacter } from '../services/userCharactersService'\n\ninterface CreateCharacterProps {\n  onBack: () => void;\n  onCreate: (character: Character) => void;\n  isEdit?: boolean;\n  characterId?: number | string;\n  initial?: Partial<Character>;\n  onUpdated?: (character: Character) => void;\n}\n\nexport const CreateCharacter: React.FC<CreateCharacterProps> = ({ onBack, onCreate, isEdit = false, characterId, initial, onUpdated }) => {\n  const [form, setForm] = useState({\n    type: '原创角色',\n    avatar: '',\n    profileImage: '', // Store original image here\n    name: '',\n    gender: '男',\n    age: '',\n    profession: '',\n    tagline: '',\n    personality: '',\n    searchTags: [] as string[],\n    relationship: '陌生人',\n    plotTheme: '',\n    plotSummary: '',\n    openingLine: '',\n    styleExamples: ['', '', ''],\n    hobbies: '',\n    experiences: '',\n    isPublic: true\n  });\n\n  const [isCustomRel, setIsCustomRel] = useState(false);\n  const [showAdvanced, setShowAdvanced] = useState(true);\n  const [showTagModal, setShowTagModal] = useState(false);\n  const [customTagInput, setCustomTagInput] = useState('');\n  const [showDraftModal, setShowDraftModal] = useState(false);\n  \n  // Validation State\n  const [errors, setErrors] = useState<Record<string, boolean>>({});\n  const [showErrorModal, setShowErrorModal] = useState(false);\n  \n  // Cropping State\n  const [tempAvatar, setTempAvatar] = useState<string | null>(null);\n  \n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  const dataUrlToBlob = (dataUrl: string) => {\n    const parts = dataUrl.split(',');\n    const mime = parts[0].match(/:(.*?);/)?.[1] || 'image/jpeg';\n    const bstr = atob(parts[1]);\n    let n = bstr.length;\n    const u8 = new Uint8Array(n);\n    while (n--) u8[n] = bstr.charCodeAt(n);\n    return new Blob([u8], { type: mime });\n  };\n\n  // Load draft on mount\n  useEffect(() => {\n    if (initial) {\n      setForm(prev => ({\n        ...prev,\n        type: initial.roleType || prev.type,\n        avatar: initial.avatar || prev.avatar,\n        profileImage: initial.profileImage || prev.profileImage,\n        name: initial.name || prev.name,\n        gender: (initial.gender as any) || prev.gender,\n        age: (initial.age as any) || prev.age,\n        profession: initial.profession || prev.profession,\n        tagline: initial.oneLinePersona || prev.tagline,\n        personality: initial.personality || prev.personality,\n        relationship: initial.currentRelationship || prev.relationship,\n        plotTheme: initial.plotTheme || prev.plotTheme,\n        plotSummary: initial.plotDescription || prev.plotSummary,\n        openingLine: initial.openingLine || prev.openingLine,\n        styleExamples: Array.isArray(initial.styleExamples) && initial.styleExamples.length ? initial.styleExamples : prev.styleExamples,\n        hobbies: initial.hobbies || prev.hobbies,\n        experiences: initial.experiences || prev.experiences,\n        searchTags: Array.isArray(initial.tags) ? initial.tags : prev.searchTags,\n        isPublic: typeof initial.isPublic === 'boolean' ? initial.isPublic : prev.isPublic\n      }))\n    }\n    const savedDraft = localStorage.getItem('create_character_draft');\n    if (savedDraft && !isEdit) {\n      try {\n        const parsed = JSON.parse(savedDraft);\n        setForm(prev => ({ ...prev, ...parsed }));\n      } catch (e) {\n        console.error(\"Failed to load draft\", e);\n      }\n    }\n  }, [initial, isEdit]);\n\n  useEffect(() => {\n    if (!isEdit || !characterId) return;\n    const needTags = !(initial && Array.isArray(initial.tags) && initial.tags.length);\n    const needStyles = !(initial && Array.isArray(initial.styleExamples) && initial.styleExamples.length);\n    if (!needTags && !needStyles) return;\n    (async () => {\n      try {\n        const data: any = await getUserCharacter(characterId);\n        const se: string[] = Array.isArray(data?.styleExamples) ? data.styleExamples.slice(0, 3) : [];\n        while (se.length < 3) se.push('');\n        setForm(prev => ({\n          ...prev,\n          name: data?.name ?? prev.name,\n          gender: data?.gender ?? prev.gender,\n          avatar: data?.avatar ?? prev.avatar,\n          tagline: data?.tagline ?? prev.tagline,\n          personality: data?.personality ?? prev.personality,\n          relationship: data?.relationship ?? prev.relationship,\n          plotTheme: data?.plot_theme ?? prev.plotTheme,\n          plotSummary: data?.plot_summary ?? prev.plotSummary,\n          openingLine: data?.opening_line ?? prev.openingLine,\n          hobbies: data?.hobbies ?? prev.hobbies,\n          experiences: data?.experiences ?? prev.experiences,\n          age: (data?.age != null ? String(data.age) : prev.age),\n          profession: data?.occupation ?? prev.profession,\n          searchTags: Array.isArray(data?.tags) ? data.tags : prev.searchTags,\n          styleExamples: se,\n          isPublic: data?.visibility ? data.visibility === 'public' : prev.isPublic\n        }))\n      } catch {}\n    })();\n  }, [isEdit, characterId, initial]);\n\n  const roleTypes = ['原创角色', '二次创作', '其他'];\n  const relationships = ['陌生人', '暧昧', '恋爱中', '冷战', '分手'];\n  const availableTags = [\n    'M/M', 'M/F', 'BL', 'BG', '耽美',\n    '百合', '责任感', '偶像', '占有欲', '霸道',\n    '调戏', '腹黑', '温柔', '年下', '年上',\n    '感性', '体贴', '理性', '反差', '激情',\n    '校园', '贴心', '偏执', '疯批', '傲娇',\n    '职场', '冷漠', '忧郁', '人夫', '养胃',\n    '控制欲', '黏人', '可爱', '成熟', '性感', '四爱'\n  ];\n\n  const handleAvatarClick = () => {\n    fileInputRef.current?.click();\n  };\n\n  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (file) {\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        // Set tempAvatar to trigger Cropper\n        setTempAvatar(reader.result as string);\n      };\n      reader.readAsDataURL(file);\n    }\n    // Reset input so same file can be selected again if needed\n    if (fileInputRef.current) fileInputRef.current.value = '';\n  };\n\n  const toggleTag = (tag: string) => {\n    if (form.searchTags.includes(tag)) {\n      setForm(prev => ({ ...prev, searchTags: prev.searchTags.filter(t => t !== tag) }));\n    } else {\n      setForm(prev => ({ ...prev, searchTags: [...prev.searchTags, tag] }));\n    }\n  };\n\n  const addCustomTag = () => {\n    const val = customTagInput.trim();\n    if (val && !form.searchTags.includes(val)) {\n      setForm(prev => ({ ...prev, searchTags: [...prev.searchTags, val] }));\n      setCustomTagInput('');\n    }\n  };\n\n  const handleDraftAction = async (save: boolean) => {\n      if (save) {\n          try {\n            const token = localStorage.getItem('user_access_token');\n            let avatarUrl = form.avatar || null as string | null;\n            if (avatarUrl && avatarUrl.startsWith('data:image')) {\n              const blob = dataUrlToBlob(avatarUrl);\n              const fd = new FormData();\n              const fname = `${Date.now()}_${Math.random().toString(36).slice(2,8)}.jpg`;\n              fd.append('avatar', blob, 'avatar.jpg');\n              fd.append('filename', fname);\n              avatarUrl = `/uploads/users/avatars/${fname}`;\n              try { await fetch('/api/uploads/avatar', { method: 'POST', headers: { Authorization: token ? `Bearer ${token}` : '' }, body: fd }); } catch {}\n            }\n            const payload: any = {\n              name: form.name || '未命名',\n              gender: form.gender,\n              avatar: avatarUrl,\n              identity: null,\n              tagline: form.tagline,\n              personality: form.personality,\n              relationship: form.relationship,\n              plotTheme: form.plotTheme,\n              plotSummary: form.plotSummary,\n              openingLine: form.openingLine,\n              hobbies: form.hobbies,\n              experiences: form.experiences,\n              age: form.age ? parseInt(form.age, 10) || null : null,\n              occupation: form.profession,\n              character_type: form.type,\n              visibility: form.isPublic ? 'public' : 'private',\n              tags: form.searchTags,\n              styleExamples: form.styleExamples.filter(Boolean)\n            }\n            if (isEdit && characterId) {\n              await updateUserCharacterDraft(characterId, payload)\n            } else {\n              await createUserCharacterDraft(payload)\n            }\n          } catch {}\n          // Optional local backup\n          localStorage.setItem('create_character_draft', JSON.stringify(form));\n      } else {\n          localStorage.removeItem('create_character_draft');\n          setForm({\n            type: '原创角色',\n            avatar: '',\n            profileImage: '',\n            name: '',\n            gender: '男',\n            age: '',\n            profession: '',\n            tagline: '',\n            personality: '',\n            searchTags: [],\n            relationship: '陌生人',\n            plotTheme: '',\n            plotSummary: '',\n            openingLine: '',\n            styleExamples: ['', '', ''],\n            hobbies: '',\n            experiences: '',\n            isPublic: true\n          });\n      }\n      setShowDraftModal(false);\n  };\n\n  const validate = () => {\n    const newErrors: Record<string, boolean> = {};\n    if (!form.name.trim()) newErrors.name = true;\n    if (!form.age.trim()) newErrors.age = true;\n    if (!form.profession.trim()) newErrors.profession = true;\n    if (!form.tagline.trim()) newErrors.tagline = true;\n    if (!form.personality.trim()) newErrors.personality = true;\n    if (form.searchTags.length === 0) newErrors.searchTags = true;\n    if (!form.relationship.trim()) newErrors.relationship = true;\n    if (!form.plotTheme.trim()) newErrors.plotTheme = true;\n    if (!form.plotSummary.trim()) newErrors.plotSummary = true;\n    if (!form.openingLine.trim()) newErrors.openingLine = true;\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async () => {\n    if (!validate()) {\n        setShowErrorModal(true);\n        return;\n    }\n\n    // Create on server\n    let backendId: number | null = null\n    try {\n      const token = localStorage.getItem('user_access_token');\n      let avatarUrl = form.avatar || null as string | null;\n      if (avatarUrl && avatarUrl.startsWith('data:image')) {\n        const blob = dataUrlToBlob(avatarUrl);\n        const fd = new FormData();\n        const fname = `${Date.now()}_${Math.random().toString(36).slice(2,8)}.jpg`;\n        fd.append('avatar', blob, 'avatar.jpg');\n        fd.append('filename', fname);\n        avatarUrl = `/uploads/users/avatars/${fname}`;\n        try { await fetch('/api/uploads/avatar', { method: 'POST', headers: { Authorization: token ? `Bearer ${token}` : '' }, body: fd }); } catch {}\n      }\n      const payload: any = {\n        name: form.name,\n        gender: form.gender,\n        avatar: avatarUrl,\n        identity: null,\n        tagline: form.tagline,\n        personality: form.personality,\n        relationship: form.relationship,\n        plotTheme: form.plotTheme,\n        plotSummary: form.plotSummary,\n        openingLine: form.openingLine,\n        hobbies: form.hobbies,\n        experiences: form.experiences,\n        age: form.age ? parseInt(form.age, 10) || null : null,\n        occupation: form.profession,\n        character_type: form.type,\n        visibility: form.isPublic ? 'public' : 'private',\n        tags: form.searchTags,\n        styleExamples: form.styleExamples.filter(Boolean)\n      }\n      if (isEdit && characterId) {\n        await updateUserCharacter(characterId, payload)\n        backendId = typeof characterId === 'number' ? characterId : parseInt(String(characterId)) || null\n      } else {\n        backendId = await createCharacter(payload)\n      }\n    } catch {}\n\n    // Create new Character Object (for local UI)\n    const newCharacter: Character = {\n        id: backendId ? String(backendId) : `c_${Date.now()}`,\n        name: form.name,\n        // Use cropped avatar for thumbnail\n        avatar: form.avatar || 'https://image.pollinations.ai/prompt/anime%20silhouette%20purple?width=400&height=400&nologo=true', \n        // Use original image for profile background (fallback to avatar if missing)\n        profileImage: form.profileImage || form.avatar,\n        status: CharacterStatus.ONLINE,\n        bio: `${form.age} ${form.profession}`,\n        tags: form.searchTags,\n        isPinned: false,\n        relationshipLevel: 0,\n        creator: '我',\n        playCount: '0',\n        \n        // Detailed fields\n        age: form.age || '未知', \n        profession: form.profession || '未知', \n        gender: form.gender,\n        roleType: form.type,\n        isOriginal: form.type === '原创角色',\n        oneLinePersona: form.tagline,\n        personality: form.personality,\n        currentRelationship: form.relationship,\n        plotTheme: form.plotTheme,\n        plotDescription: form.plotSummary,\n        openingLine: form.openingLine,\n        \n        styleExamples: form.styleExamples.filter(s => s),\n        hobbies: form.hobbies,\n        experiences: form.experiences,\n        isPublic: form.isPublic\n    };\n\n    // Remove draft on successful creation\n    localStorage.removeItem('create_character_draft');\n    if (isEdit) {\n      onUpdated ? onUpdated(newCharacter) : onCreate(newCharacter)\n    } else {\n      onCreate(newCharacter);\n    }\n  };\n\n  const getStylePlaceholder = (idx: number) => {\n      const arr = [\n          \"例：哼，别以为我会感谢你。\",\n          \"例：今晚月色真美，不一起走走吗？\",\n          \"例：再靠近一步，我就不客气了。\"\n      ];\n      return arr[idx];\n  };\n\n  const labelClass = \"field-label font-kosugi mb-3 text-slate-700 font-bold text-sm block\";\n\n  return (\n    <div className=\"fixed inset-0 bg-white z-[60]\">\n      <div className=\"mx-auto w-full max-w-md h-full relative flex flex-col overflow-hidden rounded-3xl shadow-2xl bg白 font-kosugi\">\n        \n        {/* Render Cropper if tempAvatar is present */}\n        {tempAvatar && (\n            <ImageCropper \n                imageSrc={tempAvatar}\n                aspectRatio={1}\n                outputWidth={800}\n                outputHeight={800}\n                onCancel={() => {\n                    setTempAvatar(null);\n                    if (fileInputRef.current) fileInputRef.current.value = '';\n                }}\n                onCrop={(croppedImage) => {\n                    setForm(prev => ({ \n                        ...prev, \n                        avatar: croppedImage,\n                        // SAVE THE ORIGINAL IMAGE HERE for the profile background\n                        profileImage: tempAvatar \n                    }));\n                    setTempAvatar(null);\n                }}\n            />\n        )}\n\n        {/* Background Elements */}\n        <div className=\"ambient-bg hidden\"></div>\n        <div className=\"hidden\">\n            <div className=\"star\" style={{left: '10%', width: '4px', height: '4px'}}></div>\n            <div className=\"star\" style={{left: '80%', animationDelay: '2s', width: '6px', height: '6px'}}></div>\n        </div>\n\n        {/* Header */}\n        <div className=\"sticky top-0 z-50 bg-white px-4 py-3 flex items-center border-b border-slate-100 rounded-t-3xl relative\">\n            <button onClick={onBack} className=\"w-8 h-8 flex items-center justify-center text-purple-800 hover:bg-purple-100 rounded-full transition\">\n                <ChevronLeft size={20} />\n            </button>\n            <h1 className=\"absolute left-1/2 -translate-x-1/2 text-xl font-bold text-purple-900 font-kosugi\">{isEdit ? '编辑角色' : '创建角色'}</h1>\n            {!isEdit && (\n              <button onClick={() => setShowDraftModal(true)} className=\"ml-auto text-sm font-bold text-purple-600 font-kosugi\">存草稿</button>\n            )}\n        </div>\n\n        <div className=\"flex-1 overflow-y-auto no-scrollbar pb-28 px-4 space-y-6\">\n            \n            {/* 1. Role Type */}\n            <section className=\"mt-4\">\n                <div className=\"text-[#2E1065] font-bold text-[0.9rem] mb-2 ml-1 font-kosugi\">角色类型设置</div>\n                <div className=\"flex gap-2 overflow-x-auto no-scrollbar pb-1 mt-2\">\n                    {roleTypes.map(type => (\n                        <button\n                            key={type}\n                            onClick={() => setForm(prev => ({ ...prev, type }))}\n                            className={`\n                                flex-shrink-0 px-5 py-2.5 rounded-2xl text-sm font-bold transition-all whitespace-nowrap tracking-wide font-kosugi\n                                ${form.type === type ? 'bg-purple-500 text-white shadow-purple-200 shadow-md' : 'bg-white/70 text-slate-500 border-transparent'}\n                            `}\n                        >\n                            {type}\n                        </button>\n                    ))}\n                </div>\n            </section>\n\n            {/* 2. Avatar */}\n            <section className=\"flex flex-col items-center py-2\">\n                <div \n                    onClick={handleAvatarClick}\n                    className=\"relative group cursor-pointer active:scale-95 transition-transform\"\n                >\n                    <div className=\"w-24 h-24 rounded-full bg-white border-[3px] border-white shadow-xl flex items-center justify-center overflow-hidden relative\">\n                        {form.avatar ? (\n                            <img src={form.avatar} className=\"w-full h-full object-cover\" alt=\"avatar\" />\n                        ) : (\n                            <div className=\"text-purple-200 text-3xl\">\n                                <Camera size={32} />\n                            </div>\n                        )}\n                    </div>\n                    <div className=\"absolute bottom-0 right-0 bg-purple-500 text-white w-8 h-8 rounded-full flex items-center justify-center border-[3px] border-white shadow-md\">\n                        <Plus size={14} />\n                    </div>\n                </div>\n                <input type=\"file\" ref={fileInputRef} className=\"hidden\" accept=\"image/*\" onChange={handleFileChange} />\n                <p className=\"mt-2 text-xs text-purple-400 font-bold tracking-wide font-kosugi\">上传头像</p>\n            </section>\n\n            {/* 3. Basic Settings */}\n            <section className=\"glass-card p-6 space-y-6\">\n                <div className=\"section-title !font-kosugi !text-purple-900 mb-2\">基础设定</div>\n\n                {/* Name */}\n                <div>\n                    <label className={`${labelClass} flex items-center gap-1`}>\n                        姓名\n                        {errors.name && <span className=\"text-red-500 text-[10px] font-normal ml-1\">必填</span>}\n                    </label>\n                    <div className=\"relative\">\n                        <input \n                            value={form.name}\n                            onChange={e => setForm(prev => ({ ...prev, name: e.target.value }))}\n                            type=\"text\" \n                            placeholder=\"例：祁云\" \n                            className={`dream-input w-full px-4 py-3 text-sm font-bold ${errors.name ? 'border-red-300 bg-red-50' : ''}`}\n                        />\n                    </div>\n                </div>\n\n                {/* Gender */}\n                <div>\n                    <label className={labelClass}>性别</label>\n                    <div className=\"flex gap-3\">\n                        {['男', '女', '其他'].map(g => (\n                            <button \n                                key={g}\n                                onClick={() => setForm(prev => ({ ...prev, gender: g }))}\n                                className={`flex-1 py-2.5 rounded-2xl text-sm font-bold transition font-kosugi ${\n                                    form.gender === g \n                                    ? (g === '男' ? 'bg-blue-100 text-blue-600 ring-2 ring-blue-200' : g === '女' ? 'bg-pink-100 text-pink-600 ring-2 ring-pink-200' : 'bg-purple-100 text-purple-600 ring-2 ring-purple-200')\n                                    : 'bg-white/50 text-slate-400'\n                                }`}\n                            >\n                                {g}\n                            </button>\n                        ))}\n                    </div>\n                </div>\n\n                {/* Age & Profession Bubble Inputs - Vertical Stack */}\n                <div className=\"space-y-4\">\n                    <div className=\"w-full\">\n                        <label className={`${labelClass} flex items-center gap-1`}>\n                            年龄\n                            {errors.age && <span className=\"text-red-500 text-[10px] font-normal ml-1\">必填</span>}\n                        </label>\n                        <input \n                            value={form.age}\n                            onChange={e => setForm(prev => ({ ...prev, age: e.target.value }))}\n                            type=\"text\" \n                            placeholder=\"例：28岁\" \n                            className={`dream-input w-full px-4 py-3 text-sm font-bold rounded-2xl ${errors.age ? 'border-red-300 bg-red-50' : ''}`}\n                        />\n                    </div>\n                    <div className=\"w-full\">\n                        <label className={`${labelClass} flex items-center gap-1`}>\n                            职业\n                            {errors.profession && <span className=\"text-red-500 text-[10px] font-normal ml-1\">必填</span>}\n                        </label>\n                         <input \n                            value={form.profession}\n                            onChange={e => setForm(prev => ({ ...prev, profession: e.target.value }))}\n                            type=\"text\" \n                            placeholder=\"例：骨科医生\" \n                            className={`dream-input w-full px-4 py-3 text-sm font-bold rounded-2xl ${errors.profession ? 'border-red-300 bg-red-50' : ''}`}\n                        />\n                    </div>\n                </div>\n\n                {/* Tagline */}\n                <div>\n                    <label className={`${labelClass} flex items-center gap-1`}>\n                        一句话人设\n                        {errors.tagline && <span className=\"text-red-500 text-[10px] font-normal ml-1\">必填</span>}\n                    </label>\n                    <input \n                        value={form.tagline}\n                        onChange={e => setForm(prev => ({ ...prev, tagline: e.target.value }))}\n                        type=\"text\" \n                        placeholder=\"例：表面温柔克己实则腹黑\" \n                        className={`dream-input w-full px-4 py-3 text-sm ${errors.tagline ? 'border-red-300 bg-red-50' : ''}`}\n                    />\n                </div>\n\n                {/* Personality */}\n                <div>\n                    <label className={`${labelClass} flex items-center gap-1`}>\n                        性格\n                        {errors.personality && <span className=\"text-red-500 text-[10px] font-normal ml-1\">必填</span>}\n                    </label>\n                    <textarea \n                        value={form.personality}\n                        onChange={e => setForm(prev => ({ ...prev, personality: e.target.value }))}\n                        rows={3} \n                        placeholder=\"例：占有欲强，容易吃醋...\" \n                        className={`dream-input w-full px-4 py-3 text-sm resize-none ${errors.personality ? 'border-red-300 bg-red-50' : ''}`}\n                    ></textarea>\n                </div>\n\n                {/* Tags */}\n                <div>\n                    <label className={`${labelClass} flex items-center gap-1`}>\n                        角色标签\n                        {errors.searchTags && <span className=\"text-red-500 text-[10px] font-normal ml-1\">必填</span>}\n                    </label>\n                    <div onClick={() => setShowTagModal(true)} className={`dream-input w-full px-3 py-2 min-h-[46px] flex flex-wrap gap-2 items-center bg-white/60 cursor-pointer hover:bg-white/80 transition ${errors.searchTags ? 'border-red-300 bg-red-50' : ''}`}>\n                        {form.searchTags.length === 0 && (\n                            <span className=\"text-xs text-[#B3A4C8] ml-1\">\n                                点击添加标签 (#傲娇 #高冷...)\n                            </span>\n                        )}\n                        {form.searchTags.map(tag => (\n                            <span key={tag} className=\"tag-pill px-2 py-1 flex items-center shadow-sm\">\n                                #{tag}\n                                <X size={12} className=\"ml-1 opacity-60 hover:opacity-100 cursor-pointer\" onClick={(e) => { e.stopPropagation(); toggleTag(tag); }} />\n                            </span>\n                        ))}\n                        <ChevronRight className=\"ml-auto text-purple-300\" size={16} />\n                    </div>\n                </div>\n\n                {/* Relationship */}\n                <div>\n                    <label className={`${labelClass} flex items-center gap-1`}>\n                        当下的关系\n                        {errors.relationship && <span className=\"text-red-500 text-[10px] font-normal ml-1\">必填</span>}\n                    </label>\n                    <div className=\"flex flex-wrap gap-2 mb-2\">\n                        <button \n                            onClick={() => { setIsCustomRel(true); setForm(prev => ({...prev, relationship: ''})); }}\n                            className={`px-4 py-2 rounded-xl text-xs font-bold transition-all font-kosugi ${isCustomRel ? 'bg-purple-500 text-white shadow-md' : 'bg-white text-slate-500 border border-purple-100'}`}\n                        >\n                            自定义\n                        </button>\n                        {relationships.map(rel => (\n                            <button \n                                key={rel}\n                                onClick={() => { setIsCustomRel(false); setForm(prev => ({...prev, relationship: rel})); }}\n                                className={`px-4 py-2 rounded-xl text-xs font-bold transition-all font-kosugi ${form.relationship === rel && !isCustomRel ? 'bg-purple-500 text-white shadow-md' : 'bg-white text-slate-500 border border-purple-100'}`}\n                            >\n                                {rel}\n                            </button>\n                        ))}\n                    </div>\n                    {isCustomRel && (\n                        <div className=\"relative animate-in fade-in\">\n                            <input \n                                value={form.relationship}\n                                onChange={e => setForm(prev => ({ ...prev, relationship: e.target.value }))}\n                                type=\"text\" \n                                placeholder=\"请输入自定义关系\" \n                                className={`dream-input w-full px-4 py-2 text-sm ${errors.relationship ? 'border-red-300 bg-red-50' : ''}`}\n                            />\n                        </div>\n                    )}\n                </div>\n            </section>\n\n            {/* 4. Plot */}\n            <section className=\"glass-card p-6 space-y-5\">\n                <div className=\"section-title !font-kosugi !text-purple-900 mb-4\">第一情节</div>\n                <p className=\"text-xs text-slate-500 leading-relaxed bg-purple-50/50 p-3 rounded-xl border border-purple-100 flex gap-1\">\n                    <Info size={14} className=\"text-purple-400 mt-0.5 flex-shrink-0\" />\n                    <span>第一情节的内容将被应用于和角色的第一次聊天。此外，设定第一情节并选择公开角色后，情节内容将显示在角色资料页上。</span>\n                </p>\n                <div className=\"bg-white/40 p-4 rounded-3xl border border-purple-100/50 space-y-4\">\n                    <div className=\"relative group/input\">\n                        <label className=\"text-xs font-bold text-slate-600 mb-2 flex items-center gap-1 font-kosugi\">\n                            主题\n                            {errors.plotTheme && <span className=\"text-red-500 text-[10px] font-normal\">必填</span>}\n                        </label>\n                        <input \n                            value={form.plotTheme}\n                            onChange={e => setForm(prev => ({ ...prev, plotTheme: e.target.value }))}\n                            type=\"text\" \n                            placeholder=\"例：当温柔人夫终于爆发腹黑属性\" \n                            className={`dream-input w-full px-3 py-2.5 rounded-xl text-sm bg-white/80 ${errors.plotTheme ? 'border-red-300 bg-red-50' : ''}`}\n                        />\n                    </div>\n                    <div className=\"relative group/input\">\n                        <label className=\"text-xs font-bold text-slate-600 mb-2 flex items-center gap-1 font-kosugi\">\n                            情节梗概\n                            {errors.plotSummary && <span className=\"text-red-500 text-[10px] font-normal\">必填</span>}\n                        </label>\n                        <textarea \n                            value={form.plotSummary}\n                            onChange={e => setForm(prev => ({ ...prev, plotSummary: e.target.value }))}\n                            rows={5} \n                            placeholder=\"例：在一起这么久了，他还是一如既往的温柔体贴，从来不干涉你的个人生活。今天晚上你去酒吧玩，故意装作喝醉和他打电话，却在他应了一声后开始软声叫着别人的名字......\" \n                            className={`dream-input w-full px-3 py-2.5 rounded-xl text-sm bg-white/80 resize-none leading-relaxed ${errors.plotSummary ? 'border-red-300 bg-red-50' : ''}`}\n                        ></textarea>\n                    </div>\n                    <div className=\"relative group/input\">\n                        <label className=\"text-xs font-bold text-slate-600 mb-2 flex items-center gap-1 font-kosugi\">\n                            开场白\n                            {errors.openingLine && <span className=\"text-red-500 text-[10px] font-normal\">必填</span>}\n                        </label>\n                        <textarea \n                            value={form.openingLine}\n                            onChange={e => setForm(prev => ({ ...prev, openingLine: e.target.value }))}\n                            rows={2} \n                            placeholder=\"例：“出来，我在酒吧门口”\" \n                            className={`dream-input w-full px-3 py-2.5 rounded-xl text-sm bg-white/80 resize-none ${errors.openingLine ? 'border-red-300 bg-red-50' : ''}`}\n                        ></textarea>\n                    </div>\n                </div>\n            </section>\n\n            {/* 5. Advanced */}\n            <section className=\"glass-card p-0 overflow-hidden transition-all\">\n                 <button onClick={() => setShowAdvanced(!showAdvanced)} className=\"w-full flex items-center justify-between p-6 bg-transparent transition\">\n                    <div className=\"flex items-center gap-2\">\n                        <div className=\"section-title !font-kosugi !text-purple-900 mb-0\">进阶设定</div>\n                        <span className=\"text-[10px] bg-purple-100 text-purple-500 px-1.5 py-0.5 rounded font-bold border border-purple-200 self-center font-kosugi\">可选</span>\n                    </div>\n                    {showAdvanced ? <ChevronUp className=\"text-purple-400\" /> : <ChevronDown className=\"text-purple-400\" />}\n                </button>\n\n                {showAdvanced && (\n                    <div className=\"p-6 pt-0 space-y-5 animate-in slide-in-from-top-2\">\n                        {/* Style Examples */}\n                        <div>\n                            <label className={labelClass}>说话风格示例</label>\n                            <div className=\"space-y-3\">\n                                {[0, 1, 2].map(idx => (\n                                    <div key={idx} className=\"flex items-center gap-2\">\n                                        <span className=\"text-xs font-bold text-purple-300 w-4 font-mono\">0{idx+1}</span>\n                                        <input \n                                            value={form.styleExamples[idx]}\n                                            onChange={e => {\n                                                const newEx = [...form.styleExamples];\n                                                newEx[idx] = e.target.value;\n                                                setForm(prev => ({...prev, styleExamples: newEx}));\n                                            }}\n                                            type=\"text\" \n                                            placeholder={getStylePlaceholder(idx)} \n                                            className=\"dream-input flex-1 px-3 py-2.5 rounded-xl text-sm\" \n                                        />\n                                    </div>\n                                ))}\n                            </div>\n                        </div>\n\n                        {/* Hobbies */}\n                        <div>\n                            <label className={labelClass}>爱好</label>\n                            <textarea \n                                value={form.hobbies}\n                                onChange={e => setForm(prev => ({ ...prev, hobbies: e.target.value }))}\n                                rows={2} \n                                placeholder=\"例：喜欢看书、收集古董怀表...\" \n                                className=\"dream-input w-full px-4 py-3 text-sm resize-none\"\n                            ></textarea>\n                        </div>\n\n                        {/* Experiences */}\n                         <div>\n                            <label className={labelClass}>经历</label>\n                            <textarea \n                                value={form.experiences}\n                                onChange={e => setForm(prev => ({ ...prev, experiences: e.target.value }))}\n                                rows={2} \n                                placeholder=\"请填写角色个人经历或你们的共同经历\" \n                                className=\"dream-input w-full px-4 py-3 text-sm resize-none\"\n                            ></textarea>\n                        </div>\n\n                        {/* Public Toggle */}\n                        <div className=\"pt-2 border-t border-purple-100\">\n                             <label className={`${labelClass} mb-1`}>是否公开</label>\n                             <p className=\"text-[10px] text-slate-500 leading-tight mb-3\">\n                                选择公开，角色将被发布到广场供其他用户选择和使用。不公开角色则仅供个人使用。\n                            </p>\n                            <div className=\"flex gap-3\">\n                                <button \n                                    onClick={() => setForm(prev => ({...prev, isPublic: true}))}\n                                    className={`flex-1 py-2.5 rounded-2xl text-sm font-bold transition flex items-center justify-center gap-1 font-kosugi ${form.isPublic ? 'bg-purple-500 text-white shadow-md' : 'bg-white text-slate-500 border border-purple-100'}`}\n                                >\n                                    <Globe size={14} /> 公开\n                                </button>\n                                <button \n                                    onClick={() => setForm(prev => ({...prev, isPublic: false}))}\n                                    className={`flex-1 py-2.5 rounded-2xl text-sm font-bold transition flex items-center justify-center gap-1 font-kosugi ${!form.isPublic ? 'bg-purple-500 text-white shadow-md' : 'bg-white text-slate-500 border border-purple-100'}`}\n                                >\n                                    <Lock size={14} /> 不公开\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                )}\n            </section>\n        </div>\n\n        {/* Footer Button */}\n        <div className=\"absolute bottom-0 inset-x-0 mx-auto w-full max-w-md bg-white/90 backdrop-blur-md p-4 z-50 border-t border-purple-50 rounded-b-3xl shadow-2xl\">\n            <button \n                onClick={handleSubmit}\n                className=\"w-full bg-gradient-to-r from-purple-500 to-indigo-500 text-white font-bold py-3.5 rounded-2xl shadow-lg shadow-purple-300 active:scale-95 transition-transform flex items-center justify-center tracking-widest text-lg font-kosugi\"\n            >\n                {isEdit ? '更新角色卡' : '生成角色卡'}\n            </button>\n        </div>\n\n        {/* Tag Modal */}\n        {showTagModal && (\n            <>\n                <div className=\"fixed inset-0 bg-black/30 backdrop-blur-[2px] z-[61]\" onClick={() => setShowTagModal(false)}></div>\n                <div className=\"fixed bottom-0 left-0 w-full bg-white rounded-t-[30px] z-[62] shadow-[0_-10px_40px_rgba(0,0,0,0.1)] flex flex-col h-[80vh] animate-in slide-in-from-bottom duration-300\">\n                     <div className=\"px-5 py-4 flex justify-between items-center border-b border-purple-50 bg-white rounded-t-[30px]\">\n                        <button onClick={() => setShowTagModal(false)} className=\"w-8 h-8 rounded-full bg-purple-50 text-purple-800 flex items-center justify-center\">\n                            <ChevronDown size={20} />\n                        </button>\n                        <h3 className=\"text-lg font-bold text-purple-900 font-kosugi\">添加 #标签</h3>\n                        <button onClick={() => setShowTagModal(false)} className=\"text-sm font-bold text-purple-600 bg-purple-50 px-3 py-1 rounded-full font-kosugi\">完成</button>\n                    </div>\n\n                    <div className=\"flex-1 overflow-y-auto p-5 pb-10\">\n                        <div className=\"mb-4\">\n                            <div className=\"text-xs font-bold text-slate-400 mb-2 ml-1 font-kosugi\">选定的标签</div>\n                            <div className=\"flex flex-wrap gap-2 min-h-[46px] bg-purple-50/50 p-3 rounded-xl border border-purple-100 border-dashed\">\n                                {form.searchTags.length === 0 && <span className=\"text-xs text-slate-400 self-center\">暂无标签</span>}\n                                {form.searchTags.map(tag => (\n                                    <button key={tag} onClick={() => toggleTag(tag)} className=\"bg-purple-500 text-white px-3 py-1.5 rounded-xl text-xs font-bold shadow-sm flex items-center gap-1 font-kosugi\">\n                                        #{tag} <X size={10} className=\"opacity-80\" />\n                                    </button>\n                                ))}\n                            </div>\n                        </div>\n\n                         <div className=\"mb-6\">\n                            <div className=\"text-xs font-bold text-slate-400 mb-2 ml-1 font-kosugi\">直接添加 (自定义)</div>\n                            <div className=\"flex gap-2\">\n                                <input \n                                    value={customTagInput}\n                                    onChange={e => setCustomTagInput(e.target.value)}\n                                    onKeyDown={e => e.key === 'Enter' && addCustomTag()}\n                                    type=\"text\" \n                                    placeholder=\"输入标签，不用加#\" \n                                    className=\"dream-input flex-1 px-4 py-2 text-sm bg-white\" \n                                />\n                                <button onClick={addCustomTag} className=\"bg-gradient-to-r from-purple-400 to-purple-500 text-white px-4 rounded-xl font-bold text-sm shadow-md active:scale-95 transition font-kosugi\">\n                                    添加\n                                </button>\n                            </div>\n                        </div>\n\n                         <div>\n                            <div className=\"text-xs font-bold text-slate-400 mb-2 ml-1 font-kosugi\">标签选择</div>\n                            <div className=\"grid grid-cols-4 gap-2\">\n                                {availableTags.map(tag => (\n                                    <button \n                                        key={tag} \n                                        onClick={() => toggleTag(tag)}\n                                        className={`\n                                            rounded-2xl font-bold text-[0.85rem] px-2 py-2 transition-all whitespace-nowrap overflow-hidden text-ellipsis font-kosugi\n                                            ${form.searchTags.includes(tag) \n                                                ? 'bg-[#8B5CF6] text-white shadow-md' \n                                                : 'bg-[#F3E8FF] text-[#6B21A8]'\n                                            }\n                                        `}\n                                    >\n                                        #{tag}\n                                    </button>\n                                ))}\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </>\n        )}\n\n        {/* Draft Confirmation Modal */}\n        {showDraftModal && (\n            <div className=\"fixed inset-0 z-[70] flex items-center justify-center bg-black/40 backdrop-blur-sm animate-in fade-in duration-200\">\n                <div className=\"bg-white rounded-3xl p-6 w-[80%] max-w-xs shadow-2xl scale-100 animate-in zoom-in-95 duration-200\">\n                    <h3 className=\"text-lg font-bold text-slate-800 text-center mb-4 font-kosugi\">{isEdit ? '是否只更新内容？' : '是否保存草稿？'}</h3>\n                    <div className=\"flex gap-3\">\n                        <button \n                            onClick={() => handleDraftAction(false)}\n                            className=\"flex-1 py-2.5 rounded-xl border border-slate-200 text-slate-600 font-bold hover:bg-slate-50 transition-colors font-kosugi\"\n                        >\n                            {isEdit ? '取消' : '否'}\n                        </button>\n                        <button \n                            onClick={() => handleDraftAction(true)}\n                            className=\"flex-1 py-2.5 rounded-xl bg-purple-500 text-white font-bold shadow-lg shadow-purple-200 hover:bg-purple-600 transition-colors font-kosugi\"\n                        >\n                            {isEdit ? '确认更新' : '是'}\n                        </button>\n                    </div>\n                </div>\n            </div>\n        )}\n\n        {/* Error / Incomplete Content Modal */}\n        {showErrorModal && (\n            <div className=\"fixed inset-0 z-[70] flex items-center justify-center bg-black/40 backdrop-blur-sm animate-in fade-in duration-200\">\n                <div className=\"bg-white rounded-3xl p-6 w-[80%] max-w-xs shadow-2xl scale-100 animate-in zoom-in-95 duration-200 flex flex-col items-center\">\n                    <div className=\"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center text-red-500 mb-3\">\n                        <AlertCircle size={28} />\n                    </div>\n                    <h3 className=\"text-lg font-bold text-slate-800 text-center mb-1 font-kosugi\">有内容没填写完哦～</h3>\n                    <p className=\"text-xs text-slate-400 text-center mb-5 font-kosugi\">请完善所有必填项后继续</p>\n                    <button \n                        onClick={() => setShowErrorModal(false)}\n                        className=\"w-full py-2.5 rounded-xl bg-purple-500 text-white font-bold shadow-lg shadow-purple-200 hover:bg-purple-600 transition-colors font-kosugi\"\n                    >\n                        我知道了\n                    </button>\n                </div>\n            </div>\n        )}\n      </div>\n    </div>\n  );\n};\n"],"names":["__iconNode","Globe","createLucideIcon","Lock","CreateCharacter","onBack","onCreate","isEdit","characterId","initial","onUpdated","form","setForm","useState","isCustomRel","setIsCustomRel","showAdvanced","setShowAdvanced","showTagModal","setShowTagModal","customTagInput","setCustomTagInput","showDraftModal","setShowDraftModal","errors","setErrors","showErrorModal","setShowErrorModal","tempAvatar","setTempAvatar","fileInputRef","useRef","dataUrlToBlob","dataUrl","parts","mime","_a","bstr","n","u8","useEffect","prev","savedDraft","parsed","e","needTags","needStyles","data","getUserCharacter","se","roleTypes","relationships","availableTags","handleAvatarClick","handleFileChange","file","reader","toggleTag","tag","t","addCustomTag","val","handleDraftAction","save","token","avatarUrl","blob","fd","fname","payload","updateUserCharacterDraft","createUserCharacterDraft","validate","newErrors","handleSubmit","backendId","updateUserCharacter","createCharacter","newCharacter","CharacterStatus","s","getStylePlaceholder","idx","labelClass","jsxs","jsx","ImageCropper","croppedImage","ChevronLeft","type","Camera","Plus","g","X","ChevronRight","rel","Info","ChevronUp","ChevronDown","newEx","Fragment","AlertCircle"],"mappings":"iqBAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAMA,GAAa,CACjB,CAAC,SAAU,CAAE,GAAI,KAAM,GAAI,KAAM,EAAG,KAAM,IAAK,SAAU,EACzD,CAAC,OAAQ,CAAE,EAAG,kDAAmD,IAAK,QAAQ,CAAE,EAChF,CAAC,OAAQ,CAAE,EAAG,WAAY,IAAK,QAAQ,CAAE,CAC3C,EACMC,GAAQC,EAAiB,QAASF,EAAU,ECdlD;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAMA,GAAa,CACjB,CAAC,OAAQ,CAAE,MAAO,KAAM,OAAQ,KAAM,EAAG,IAAK,EAAG,KAAM,GAAI,IAAK,GAAI,IAAK,IAAK,SAAU,EACxF,CAAC,OAAQ,CAAE,EAAG,2BAA4B,IAAK,QAAQ,CAAE,CAC3D,EACMG,GAAOD,EAAiB,OAAQF,EAAU,ECGnCI,GAAkD,CAAC,CAAE,OAAAC,EAAQ,SAAAC,EAAU,OAAAC,EAAS,GAAO,YAAAC,EAAa,QAAAC,EAAS,UAAAC,KAAgB,CACxI,KAAM,CAACC,EAAMC,CAAO,EAAIC,WAAS,CAC/B,KAAM,OACN,OAAQ,GACR,aAAc,GACd,KAAM,GACN,OAAQ,IACR,IAAK,GACL,WAAY,GACZ,QAAS,GACT,YAAa,GACb,WAAY,CAAA,EACZ,aAAc,MACd,UAAW,GACX,YAAa,GACb,YAAa,GACb,cAAe,CAAC,GAAI,GAAI,EAAE,EAC1B,QAAS,GACT,YAAa,GACb,SAAU,EAAA,CACX,EAEK,CAACC,EAAaC,CAAc,EAAIF,EAAAA,SAAS,EAAK,EAC9C,CAACG,EAAcC,CAAe,EAAIJ,EAAAA,SAAS,EAAI,EAC/C,CAACK,EAAcC,CAAe,EAAIN,EAAAA,SAAS,EAAK,EAChD,CAACO,EAAgBC,CAAiB,EAAIR,EAAAA,SAAS,EAAE,EACjD,CAACS,EAAgBC,CAAiB,EAAIV,EAAAA,SAAS,EAAK,EAGpD,CAACW,EAAQC,CAAS,EAAIZ,EAAAA,SAAkC,CAAA,CAAE,EAC1D,CAACa,EAAgBC,CAAiB,EAAId,EAAAA,SAAS,EAAK,EAGpD,CAACe,EAAYC,CAAa,EAAIhB,EAAAA,SAAwB,IAAI,EAE1DiB,EAAeC,EAAAA,OAAyB,IAAI,EAE5CC,EAAiBC,GAAoB,OACzC,MAAMC,EAAQD,EAAQ,MAAM,GAAG,EACzBE,IAAOC,EAAAF,EAAM,CAAC,EAAE,MAAM,SAAS,IAAxB,YAAAE,EAA4B,KAAM,aACzCC,EAAO,KAAKH,EAAM,CAAC,CAAC,EAC1B,IAAII,EAAID,EAAK,OACb,MAAME,EAAK,IAAI,WAAWD,CAAC,EAC3B,KAAOA,KAAKC,EAAGD,CAAC,EAAID,EAAK,WAAWC,CAAC,EACrC,OAAO,IAAI,KAAK,CAACC,CAAE,EAAG,CAAE,KAAMJ,EAAM,CACtC,EAGAK,EAAAA,UAAU,IAAM,CACV/B,GACFG,EAAQ6B,IAAS,CACf,GAAGA,EACH,KAAMhC,EAAQ,UAAYgC,EAAK,KAC/B,OAAQhC,EAAQ,QAAUgC,EAAK,OAC/B,aAAchC,EAAQ,cAAgBgC,EAAK,aAC3C,KAAMhC,EAAQ,MAAQgC,EAAK,KAC3B,OAAShC,EAAQ,QAAkBgC,EAAK,OACxC,IAAMhC,EAAQ,KAAegC,EAAK,IAClC,WAAYhC,EAAQ,YAAcgC,EAAK,WACvC,QAAShC,EAAQ,gBAAkBgC,EAAK,QACxC,YAAahC,EAAQ,aAAegC,EAAK,YACzC,aAAchC,EAAQ,qBAAuBgC,EAAK,aAClD,UAAWhC,EAAQ,WAAagC,EAAK,UACrC,YAAahC,EAAQ,iBAAmBgC,EAAK,YAC7C,YAAahC,EAAQ,aAAegC,EAAK,YACzC,cAAe,MAAM,QAAQhC,EAAQ,aAAa,GAAKA,EAAQ,cAAc,OAASA,EAAQ,cAAgBgC,EAAK,cACnH,QAAShC,EAAQ,SAAWgC,EAAK,QACjC,YAAahC,EAAQ,aAAegC,EAAK,YACzC,WAAY,MAAM,QAAQhC,EAAQ,IAAI,EAAIA,EAAQ,KAAOgC,EAAK,WAC9D,SAAU,OAAOhC,EAAQ,UAAa,UAAYA,EAAQ,SAAWgC,EAAK,QAAA,EAC1E,EAEJ,MAAMC,EAAa,aAAa,QAAQ,wBAAwB,EAChE,GAAIA,GAAc,CAACnC,EACjB,GAAI,CACF,MAAMoC,EAAS,KAAK,MAAMD,CAAU,EACpC9B,MAAiB,CAAE,GAAG6B,EAAM,GAAGE,GAAS,CAC1C,OAASC,EAAG,CACV,QAAQ,MAAM,uBAAwBA,CAAC,CACzC,CAEJ,EAAG,CAACnC,EAASF,CAAM,CAAC,EAEpBiC,EAAAA,UAAU,IAAM,CACd,GAAI,CAACjC,GAAU,CAACC,EAAa,OAC7B,MAAMqC,EAAW,EAAEpC,GAAW,MAAM,QAAQA,EAAQ,IAAI,GAAKA,EAAQ,KAAK,QACpEqC,EAAa,EAAErC,GAAW,MAAM,QAAQA,EAAQ,aAAa,GAAKA,EAAQ,cAAc,QAC1F,CAACoC,GAAY,CAACC,IACjB,SAAY,CACX,GAAI,CACF,MAAMC,EAAY,MAAMC,EAAiBxC,CAAW,EAC9CyC,EAAe,MAAM,QAAQF,GAAA,YAAAA,EAAM,aAAa,EAAIA,EAAK,cAAc,MAAM,EAAG,CAAC,EAAI,CAAA,EAC3F,KAAOE,EAAG,OAAS,GAAGA,EAAG,KAAK,EAAE,EAChCrC,EAAQ6B,IAAS,CACf,GAAGA,EACH,MAAMM,GAAA,YAAAA,EAAM,OAAQN,EAAK,KACzB,QAAQM,GAAA,YAAAA,EAAM,SAAUN,EAAK,OAC7B,QAAQM,GAAA,YAAAA,EAAM,SAAUN,EAAK,OAC7B,SAASM,GAAA,YAAAA,EAAM,UAAWN,EAAK,QAC/B,aAAaM,GAAA,YAAAA,EAAM,cAAeN,EAAK,YACvC,cAAcM,GAAA,YAAAA,EAAM,eAAgBN,EAAK,aACzC,WAAWM,GAAA,YAAAA,EAAM,aAAcN,EAAK,UACpC,aAAaM,GAAA,YAAAA,EAAM,eAAgBN,EAAK,YACxC,aAAaM,GAAA,YAAAA,EAAM,eAAgBN,EAAK,YACxC,SAASM,GAAA,YAAAA,EAAM,UAAWN,EAAK,QAC/B,aAAaM,GAAA,YAAAA,EAAM,cAAeN,EAAK,YACvC,KAAMM,GAAA,YAAAA,EAAM,MAAO,KAAO,OAAOA,EAAK,GAAG,EAAIN,EAAK,IAClD,YAAYM,GAAA,YAAAA,EAAM,aAAcN,EAAK,WACrC,WAAY,MAAM,QAAQM,GAAA,YAAAA,EAAM,IAAI,EAAIA,EAAK,KAAON,EAAK,WACzD,cAAeQ,EACf,SAAUF,GAAA,MAAAA,EAAM,WAAaA,EAAK,aAAe,SAAWN,EAAK,QAAA,EACjE,CACJ,MAAQ,CAAC,CACX,GAAA,CACF,EAAG,CAAClC,EAAQC,EAAaC,CAAO,CAAC,EAEjC,MAAMyC,EAAY,CAAC,OAAQ,OAAQ,IAAI,EACjCC,EAAgB,CAAC,MAAO,KAAM,MAAO,KAAM,IAAI,EAC/CC,EAAgB,CACpB,MAAO,MAAO,KAAM,KAAM,KAC1B,KAAM,MAAO,KAAM,MAAO,KAC1B,KAAM,KAAM,KAAM,KAAM,KACxB,KAAM,KAAM,KAAM,KAAM,KACxB,KAAM,KAAM,KAAM,KAAM,KACxB,KAAM,KAAM,KAAM,KAAM,KACxB,MAAO,KAAM,KAAM,KAAM,KAAM,IAAA,EAG3BC,EAAoB,IAAM,QAC9BjB,EAAAN,EAAa,UAAb,MAAAM,EAAsB,OACxB,EAEMkB,EAAoBV,GAA2C,OACnE,MAAMW,GAAOnB,EAAAQ,EAAE,OAAO,QAAT,YAAAR,EAAiB,GAC9B,GAAImB,EAAM,CACR,MAAMC,EAAS,IAAI,WACnBA,EAAO,UAAY,IAAM,CAEvB3B,EAAc2B,EAAO,MAAgB,CACvC,EACAA,EAAO,cAAcD,CAAI,CAC3B,CAEIzB,EAAa,UAASA,EAAa,QAAQ,MAAQ,GACzD,EAEM2B,EAAaC,GAAgB,CAC7B/C,EAAK,WAAW,SAAS+C,CAAG,EAC9B9C,EAAQ6B,IAAS,CAAE,GAAGA,EAAM,WAAYA,EAAK,WAAW,OAAOkB,GAAKA,IAAMD,CAAG,CAAA,EAAI,EAEjF9C,EAAQ6B,IAAS,CAAE,GAAGA,EAAM,WAAY,CAAC,GAAGA,EAAK,WAAYiB,CAAG,CAAA,EAAI,CAExE,EAEME,EAAe,IAAM,CACzB,MAAMC,EAAMzC,EAAe,KAAA,EACvByC,GAAO,CAAClD,EAAK,WAAW,SAASkD,CAAG,IACtCjD,EAAQ6B,IAAS,CAAE,GAAGA,EAAM,WAAY,CAAC,GAAGA,EAAK,WAAYoB,CAAG,CAAA,EAAI,EACpExC,EAAkB,EAAE,EAExB,EAEMyC,EAAoB,MAAOC,GAAkB,CAC/C,GAAIA,EAAM,CACN,GAAI,CACF,MAAMC,EAAQ,aAAa,QAAQ,mBAAmB,EACtD,IAAIC,EAAYtD,EAAK,QAAU,KAC/B,GAAIsD,GAAaA,EAAU,WAAW,YAAY,EAAG,CACnD,MAAMC,EAAOlC,EAAciC,CAAS,EAC9BE,EAAK,IAAI,SACTC,EAAQ,GAAG,KAAK,IAAA,CAAK,IAAI,KAAK,OAAA,EAAS,SAAS,EAAE,EAAE,MAAM,EAAE,CAAC,CAAC,OACpED,EAAG,OAAO,SAAUD,EAAM,YAAY,EACtCC,EAAG,OAAO,WAAYC,CAAK,EAC3BH,EAAY,0BAA0BG,CAAK,GAC3C,GAAI,CAAE,MAAM,MAAM,sBAAuB,CAAE,OAAQ,OAAQ,QAAS,CAAE,cAAeJ,EAAQ,UAAUA,CAAK,GAAK,EAAA,EAAM,KAAMG,EAAI,CAAG,MAAQ,CAAC,CAC/I,CACA,MAAME,EAAe,CACnB,KAAM1D,EAAK,MAAQ,MACnB,OAAQA,EAAK,OACb,OAAQsD,EACR,SAAU,KACV,QAAStD,EAAK,QACd,YAAaA,EAAK,YAClB,aAAcA,EAAK,aACnB,UAAWA,EAAK,UAChB,YAAaA,EAAK,YAClB,YAAaA,EAAK,YAClB,QAASA,EAAK,QACd,YAAaA,EAAK,YAClB,IAAKA,EAAK,KAAM,SAASA,EAAK,IAAK,EAAE,GAAK,KAC1C,WAAYA,EAAK,WACjB,eAAgBA,EAAK,KACrB,WAAYA,EAAK,SAAW,SAAW,UACvC,KAAMA,EAAK,WACX,cAAeA,EAAK,cAAc,OAAO,OAAO,CAAA,EAE9CJ,GAAUC,EACZ,MAAM8D,GAAyB9D,EAAa6D,CAAO,EAEnD,MAAME,GAAyBF,CAAO,CAE1C,MAAQ,CAAC,CAET,aAAa,QAAQ,yBAA0B,KAAK,UAAU1D,CAAI,CAAC,CACvE,MACI,aAAa,WAAW,wBAAwB,EAChDC,EAAQ,CACN,KAAM,OACN,OAAQ,GACR,aAAc,GACd,KAAM,GACN,OAAQ,IACR,IAAK,GACL,WAAY,GACZ,QAAS,GACT,YAAa,GACb,WAAY,CAAA,EACZ,aAAc,MACd,UAAW,GACX,YAAa,GACb,YAAa,GACb,cAAe,CAAC,GAAI,GAAI,EAAE,EAC1B,QAAS,GACT,YAAa,GACb,SAAU,EAAA,CACX,EAELW,EAAkB,EAAK,CAC3B,EAEMiD,EAAW,IAAM,CACrB,MAAMC,EAAqC,CAAA,EAC3C,OAAK9D,EAAK,KAAK,KAAA,MAAkB,KAAO,IACnCA,EAAK,IAAI,KAAA,MAAkB,IAAM,IACjCA,EAAK,WAAW,KAAA,MAAkB,WAAa,IAC/CA,EAAK,QAAQ,KAAA,MAAkB,QAAU,IACzCA,EAAK,YAAY,KAAA,MAAkB,YAAc,IAClDA,EAAK,WAAW,SAAW,MAAa,WAAa,IACpDA,EAAK,aAAa,KAAA,MAAkB,aAAe,IACnDA,EAAK,UAAU,KAAA,MAAkB,UAAY,IAC7CA,EAAK,YAAY,KAAA,MAAkB,YAAc,IACjDA,EAAK,YAAY,KAAA,MAAkB,YAAc,IAEtDc,EAAUgD,CAAS,EACZ,OAAO,KAAKA,CAAS,EAAE,SAAW,CAC3C,EAEMC,EAAe,SAAY,CAC/B,GAAI,CAACF,IAAY,CACb7C,EAAkB,EAAI,EACtB,MACJ,CAGA,IAAIgD,EAA2B,KAC/B,GAAI,CACF,MAAMX,EAAQ,aAAa,QAAQ,mBAAmB,EACtD,IAAIC,EAAYtD,EAAK,QAAU,KAC/B,GAAIsD,GAAaA,EAAU,WAAW,YAAY,EAAG,CACnD,MAAMC,EAAOlC,EAAciC,CAAS,EAC9BE,EAAK,IAAI,SACTC,EAAQ,GAAG,KAAK,IAAA,CAAK,IAAI,KAAK,OAAA,EAAS,SAAS,EAAE,EAAE,MAAM,EAAE,CAAC,CAAC,OACpED,EAAG,OAAO,SAAUD,EAAM,YAAY,EACtCC,EAAG,OAAO,WAAYC,CAAK,EAC3BH,EAAY,0BAA0BG,CAAK,GAC3C,GAAI,CAAE,MAAM,MAAM,sBAAuB,CAAE,OAAQ,OAAQ,QAAS,CAAE,cAAeJ,EAAQ,UAAUA,CAAK,GAAK,EAAA,EAAM,KAAMG,EAAI,CAAG,MAAQ,CAAC,CAC/I,CACA,MAAME,EAAe,CACnB,KAAM1D,EAAK,KACX,OAAQA,EAAK,OACb,OAAQsD,EACR,SAAU,KACV,QAAStD,EAAK,QACd,YAAaA,EAAK,YAClB,aAAcA,EAAK,aACnB,UAAWA,EAAK,UAChB,YAAaA,EAAK,YAClB,YAAaA,EAAK,YAClB,QAASA,EAAK,QACd,YAAaA,EAAK,YAClB,IAAKA,EAAK,KAAM,SAASA,EAAK,IAAK,EAAE,GAAK,KAC1C,WAAYA,EAAK,WACjB,eAAgBA,EAAK,KACrB,WAAYA,EAAK,SAAW,SAAW,UACvC,KAAMA,EAAK,WACX,cAAeA,EAAK,cAAc,OAAO,OAAO,CAAA,EAE9CJ,GAAUC,GACZ,MAAMoE,EAAoBpE,EAAa6D,CAAO,EAC9CM,EAAY,OAAOnE,GAAgB,SAAWA,EAAc,SAAS,OAAOA,CAAW,CAAC,GAAK,MAE7FmE,EAAY,MAAME,EAAgBR,CAAO,CAE7C,MAAQ,CAAC,CAGT,MAAMS,EAA0B,CAC5B,GAAIH,EAAY,OAAOA,CAAS,EAAI,KAAK,KAAK,KAAK,GACnD,KAAMhE,EAAK,KAEX,OAAQA,EAAK,QAAU,oGAEvB,aAAcA,EAAK,cAAgBA,EAAK,OACxC,OAAQoE,GAAgB,OACxB,IAAK,GAAGpE,EAAK,GAAG,IAAIA,EAAK,UAAU,GACnC,KAAMA,EAAK,WACX,SAAU,GACV,kBAAmB,EACnB,QAAS,IACT,UAAW,IAGX,IAAKA,EAAK,KAAO,KACjB,WAAYA,EAAK,YAAc,KAC/B,OAAQA,EAAK,OACb,SAAUA,EAAK,KACf,WAAYA,EAAK,OAAS,OAC1B,eAAgBA,EAAK,QACrB,YAAaA,EAAK,YAClB,oBAAqBA,EAAK,aAC1B,UAAWA,EAAK,UAChB,gBAAiBA,EAAK,YACtB,YAAaA,EAAK,YAElB,cAAeA,EAAK,cAAc,UAAYqE,CAAC,EAC/C,QAASrE,EAAK,QACd,YAAaA,EAAK,YAClB,SAAUA,EAAK,QAAA,EAInB,aAAa,WAAW,wBAAwB,EAC5CJ,GACFG,EAAYA,EAAUoE,CAAY,EAElCxE,EAASwE,CAAY,CAEzB,EAEMG,EAAuBC,GACb,CACR,gBACA,mBACA,iBAAA,EAEOA,CAAG,EAGZC,EAAa,sEAEnB,aACG,MAAA,CAAI,UAAU,gCACb,SAAAC,EAAAA,KAAC,MAAA,CAAI,UAAU,+GAGZ,SAAA,CAAAxD,GACGyD,EAAAA,IAACC,GAAA,CACG,SAAU1D,EACV,YAAa,EACb,YAAa,IACb,aAAc,IACd,SAAU,IAAM,CACZC,EAAc,IAAI,EACdC,EAAa,UAASA,EAAa,QAAQ,MAAQ,GAC3D,EACA,OAASyD,GAAiB,CACtB3E,EAAQ6B,IAAS,CACb,GAAGA,EACH,OAAQ8C,EAER,aAAc3D,CAAA,EAChB,EACFC,EAAc,IAAI,CACtB,CAAA,CAAA,EAKRwD,EAAAA,IAAC,MAAA,CAAI,UAAU,mBAAA,CAAoB,EACnCD,EAAAA,KAAC,MAAA,CAAI,UAAU,SACX,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,OAAO,MAAO,CAAC,KAAM,MAAO,MAAO,MAAO,OAAQ,KAAA,CAAK,CAAG,EACzEA,EAAAA,IAAC,MAAA,CAAI,UAAU,OAAO,MAAO,CAAC,KAAM,MAAO,eAAgB,KAAM,MAAO,MAAO,OAAQ,MAAK,CAAG,CAAA,EACnG,EAGAD,EAAAA,KAAC,MAAA,CAAI,UAAU,0GACX,SAAA,CAAAC,EAAAA,IAAC,SAAA,CAAO,QAAShF,EAAQ,UAAU,uGAC/B,SAAAgF,EAAAA,IAACG,GAAA,CAAY,KAAM,EAAA,CAAI,CAAA,CAC3B,QACC,KAAA,CAAG,UAAU,mFAAoF,SAAAjF,EAAS,OAAS,OAAO,EAC1H,CAACA,GACA8E,EAAAA,IAAC,SAAA,CAAO,QAAS,IAAM9D,EAAkB,EAAI,EAAG,UAAU,wDAAwD,SAAA,KAAA,CAAG,CAAA,EAE3H,EAEA6D,EAAAA,KAAC,MAAA,CAAI,UAAU,2DAGX,SAAA,CAAAA,EAAAA,KAAC,UAAA,CAAQ,UAAU,OACf,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,+DAA+D,SAAA,SAAM,QACnF,MAAA,CAAI,UAAU,oDACV,SAAAnC,EAAU,IAAIuC,GACXJ,EAAAA,IAAC,SAAA,CAEG,QAAS,IAAMzE,EAAQ6B,IAAS,CAAE,GAAGA,EAAM,KAAAgD,GAAO,EAClD,UAAW;AAAA;AAAA,kCAEL9E,EAAK,OAAS8E,EAAO,uDAAyD,+CAA+C;AAAA,8BAGlI,SAAAA,CAAA,EAPIA,CAAA,CASZ,CAAA,CACL,CAAA,EACJ,EAGAL,EAAAA,KAAC,UAAA,CAAQ,UAAU,kCACf,SAAA,CAAAA,EAAAA,KAAC,MAAA,CACG,QAAS/B,EACT,UAAU,qEAEV,SAAA,CAAAgC,EAAAA,IAAC,MAAA,CAAI,UAAU,gIACV,SAAA1E,EAAK,aACD,MAAA,CAAI,IAAKA,EAAK,OAAQ,UAAU,6BAA6B,IAAI,QAAA,CAAS,EAE3E0E,EAAAA,IAAC,MAAA,CAAI,UAAU,2BACX,eAACK,GAAA,CAAO,KAAM,EAAA,CAAI,CAAA,CACtB,CAAA,CAER,EACAL,EAAAA,IAAC,OAAI,UAAU,+IACX,eAACM,GAAA,CAAK,KAAM,GAAI,CAAA,CACpB,CAAA,CAAA,CAAA,EAEJN,EAAAA,IAAC,QAAA,CAAM,KAAK,OAAO,IAAKvD,EAAc,UAAU,SAAS,OAAO,UAAU,SAAUwB,CAAA,CAAkB,EACtG+B,EAAAA,IAAC,IAAA,CAAE,UAAU,mEAAmE,SAAA,MAAA,CAAI,CAAA,EACxF,EAGAD,EAAAA,KAAC,UAAA,CAAQ,UAAU,2BACf,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,mDAAmD,SAAA,OAAI,SAGrE,MAAA,CACG,SAAA,CAAAD,EAAAA,KAAC,QAAA,CAAM,UAAW,GAAGD,CAAU,2BAA4B,SAAA,CAAA,KAEtD3D,EAAO,MAAQ6D,EAAAA,IAAC,OAAA,CAAK,UAAU,4CAA4C,SAAA,IAAA,CAAE,CAAA,EAClF,EACAA,EAAAA,IAAC,MAAA,CAAI,UAAU,WACX,SAAAA,EAAAA,IAAC,QAAA,CACG,MAAO1E,EAAK,KACZ,SAAUiC,GAAKhC,EAAQ6B,IAAS,CAAE,GAAGA,EAAM,KAAMG,EAAE,OAAO,KAAA,EAAQ,EAClE,KAAK,OACL,YAAY,OACZ,UAAW,kDAAkDpB,EAAO,KAAO,2BAA6B,EAAE,EAAA,CAAA,CAC9G,CACJ,CAAA,EACJ,SAGC,MAAA,CACG,SAAA,CAAA6D,EAAAA,IAAC,QAAA,CAAM,UAAWF,EAAY,SAAA,KAAE,EAChCE,EAAAA,IAAC,MAAA,CAAI,UAAU,aACV,SAAA,CAAC,IAAK,IAAK,IAAI,EAAE,IAAIO,GAClBP,EAAAA,IAAC,SAAA,CAEG,QAAS,IAAMzE,EAAQ6B,IAAS,CAAE,GAAGA,EAAM,OAAQmD,CAAA,EAAI,EACvD,UAAW,sEACPjF,EAAK,SAAWiF,EACbA,IAAM,IAAM,iDAAmDA,IAAM,IAAM,iDAAmD,uDAC/H,4BACN,GAEC,SAAAA,CAAA,EARIA,CAAA,CAUZ,CAAA,CACL,CAAA,EACJ,EAGAR,EAAAA,KAAC,MAAA,CAAI,UAAU,YACX,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,SACX,SAAA,CAAAA,EAAAA,KAAC,QAAA,CAAM,UAAW,GAAGD,CAAU,2BAA4B,SAAA,CAAA,KAEtD3D,EAAO,KAAO6D,EAAAA,IAAC,OAAA,CAAK,UAAU,4CAA4C,SAAA,IAAA,CAAE,CAAA,EACjF,EACAA,EAAAA,IAAC,QAAA,CACG,MAAO1E,EAAK,IACZ,SAAUiC,GAAKhC,EAAQ6B,IAAS,CAAE,GAAGA,EAAM,IAAKG,EAAE,OAAO,KAAA,EAAQ,EACjE,KAAK,OACL,YAAY,QACZ,UAAW,8DAA8DpB,EAAO,IAAM,2BAA6B,EAAE,EAAA,CAAA,CACzH,EACJ,EACA4D,EAAAA,KAAC,MAAA,CAAI,UAAU,SACX,SAAA,CAAAA,EAAAA,KAAC,QAAA,CAAM,UAAW,GAAGD,CAAU,2BAA4B,SAAA,CAAA,KAEtD3D,EAAO,YAAc6D,EAAAA,IAAC,OAAA,CAAK,UAAU,4CAA4C,SAAA,IAAA,CAAE,CAAA,EACxF,EACCA,EAAAA,IAAC,QAAA,CACE,MAAO1E,EAAK,WACZ,SAAUiC,GAAKhC,EAAQ6B,IAAS,CAAE,GAAGA,EAAM,WAAYG,EAAE,OAAO,KAAA,EAAQ,EACxE,KAAK,OACL,YAAY,SACZ,UAAW,8DAA8DpB,EAAO,WAAa,2BAA6B,EAAE,EAAA,CAAA,CAChI,CAAA,CACJ,CAAA,EACJ,SAGC,MAAA,CACG,SAAA,CAAA4D,EAAAA,KAAC,QAAA,CAAM,UAAW,GAAGD,CAAU,2BAA4B,SAAA,CAAA,QAEtD3D,EAAO,SAAW6D,EAAAA,IAAC,OAAA,CAAK,UAAU,4CAA4C,SAAA,IAAA,CAAE,CAAA,EACrF,EACAA,EAAAA,IAAC,QAAA,CACG,MAAO1E,EAAK,QACZ,SAAUiC,GAAKhC,EAAQ6B,IAAS,CAAE,GAAGA,EAAM,QAASG,EAAE,OAAO,KAAA,EAAQ,EACrE,KAAK,OACL,YAAY,eACZ,UAAW,wCAAwCpB,EAAO,QAAU,2BAA6B,EAAE,EAAA,CAAA,CACvG,EACJ,SAGC,MAAA,CACG,SAAA,CAAA4D,EAAAA,KAAC,QAAA,CAAM,UAAW,GAAGD,CAAU,2BAA4B,SAAA,CAAA,KAEtD3D,EAAO,aAAe6D,EAAAA,IAAC,OAAA,CAAK,UAAU,4CAA4C,SAAA,IAAA,CAAE,CAAA,EACzF,EACAA,EAAAA,IAAC,WAAA,CACG,MAAO1E,EAAK,YACZ,SAAUiC,GAAKhC,EAAQ6B,IAAS,CAAE,GAAGA,EAAM,YAAaG,EAAE,OAAO,KAAA,EAAQ,EACzE,KAAM,EACN,YAAY,iBACZ,UAAW,oDAAoDpB,EAAO,YAAc,2BAA6B,EAAE,EAAA,CAAA,CACtH,EACL,SAGC,MAAA,CACG,SAAA,CAAA4D,EAAAA,KAAC,QAAA,CAAM,UAAW,GAAGD,CAAU,2BAA4B,SAAA,CAAA,OAEtD3D,EAAO,YAAc6D,EAAAA,IAAC,OAAA,CAAK,UAAU,4CAA4C,SAAA,IAAA,CAAE,CAAA,EACxF,EACAD,EAAAA,KAAC,MAAA,CAAI,QAAS,IAAMjE,EAAgB,EAAI,EAAG,UAAW,uIAAuIK,EAAO,WAAa,2BAA6B,EAAE,GAC3O,SAAA,CAAAb,EAAK,WAAW,SAAW,SACvB,OAAA,CAAK,UAAU,8BAA8B,SAAA,qBAAA,CAE9C,EAEHA,EAAK,WAAW,OACbyE,OAAC,OAAA,CAAe,UAAU,iDAAiD,SAAA,CAAA,IACrE1B,EACF2B,MAACQ,GAAE,KAAM,GAAI,UAAU,mDAAmD,QAAUjD,GAAM,CAAEA,EAAE,gBAAA,EAAmBa,EAAUC,CAAG,CAAG,CAAA,CAAG,CAAA,CAAA,EAF7HA,CAGX,CACH,EACD2B,EAAAA,IAACS,GAAA,CAAa,UAAU,0BAA0B,KAAM,EAAA,CAAI,CAAA,CAAA,CAChE,CAAA,EACJ,SAGC,MAAA,CACG,SAAA,CAAAV,EAAAA,KAAC,QAAA,CAAM,UAAW,GAAGD,CAAU,2BAA4B,SAAA,CAAA,QAEtD3D,EAAO,cAAgB6D,EAAAA,IAAC,OAAA,CAAK,UAAU,4CAA4C,SAAA,IAAA,CAAE,CAAA,EAC1F,EACAD,EAAAA,KAAC,MAAA,CAAI,UAAU,4BACX,SAAA,CAAAC,EAAAA,IAAC,SAAA,CACG,QAAS,IAAM,CAAEtE,EAAe,EAAI,EAAGH,MAAiB,CAAC,GAAG6B,EAAM,aAAc,IAAI,CAAG,EACvF,UAAW,qEAAqE3B,EAAc,qCAAuC,kDAAkD,GAC1L,SAAA,KAAA,CAAA,EAGAqC,EAAc,IAAI4C,GACfV,EAAAA,IAAC,SAAA,CAEG,QAAS,IAAM,CAAEtE,EAAe,EAAK,EAAGH,MAAiB,CAAC,GAAG6B,EAAM,aAAcsD,GAAK,CAAG,EACzF,UAAW,qEAAqEpF,EAAK,eAAiBoF,GAAO,CAACjF,EAAc,qCAAuC,kDAAkD,GAEpN,SAAAiF,CAAA,EAJIA,CAAA,CAMZ,CAAA,EACL,EACCjF,GACGuE,EAAAA,IAAC,MAAA,CAAI,UAAU,8BACX,SAAAA,EAAAA,IAAC,QAAA,CACG,MAAO1E,EAAK,aACZ,SAAUiC,GAAKhC,EAAQ6B,IAAS,CAAE,GAAGA,EAAM,aAAcG,EAAE,OAAO,KAAA,EAAQ,EAC1E,KAAK,OACL,YAAY,WACZ,UAAW,wCAAwCpB,EAAO,aAAe,2BAA6B,EAAE,EAAA,CAAA,CAC5G,CACJ,CAAA,CAAA,CAER,CAAA,EACJ,EAGA4D,EAAAA,KAAC,UAAA,CAAQ,UAAU,2BACf,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,mDAAmD,SAAA,OAAI,EACtED,EAAAA,KAAC,IAAA,CAAE,UAAU,4GACT,SAAA,CAAAC,EAAAA,IAACW,GAAA,CAAK,KAAM,GAAI,UAAU,uCAAuC,EACjEX,EAAAA,IAAC,QAAK,SAAA,yDAAA,CAAuD,CAAA,EACjE,EACAD,EAAAA,KAAC,MAAA,CAAI,UAAU,oEACX,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,uBACX,SAAA,CAAAA,EAAAA,KAAC,QAAA,CAAM,UAAU,4EAA4E,SAAA,CAAA,KAExF5D,EAAO,WAAa6D,EAAAA,IAAC,OAAA,CAAK,UAAU,uCAAuC,SAAA,IAAA,CAAE,CAAA,EAClF,EACAA,EAAAA,IAAC,QAAA,CACG,MAAO1E,EAAK,UACZ,SAAUiC,GAAKhC,EAAQ6B,IAAS,CAAE,GAAGA,EAAM,UAAWG,EAAE,OAAO,KAAA,EAAQ,EACvE,KAAK,OACL,YAAY,kBACZ,UAAW,iEAAiEpB,EAAO,UAAY,2BAA6B,EAAE,EAAA,CAAA,CAClI,EACJ,EACA4D,EAAAA,KAAC,MAAA,CAAI,UAAU,uBACX,SAAA,CAAAA,EAAAA,KAAC,QAAA,CAAM,UAAU,4EAA4E,SAAA,CAAA,OAExF5D,EAAO,aAAe6D,EAAAA,IAAC,OAAA,CAAK,UAAU,uCAAuC,SAAA,IAAA,CAAE,CAAA,EACpF,EACAA,EAAAA,IAAC,WAAA,CACG,MAAO1E,EAAK,YACZ,SAAUiC,GAAKhC,EAAQ6B,IAAS,CAAE,GAAGA,EAAM,YAAaG,EAAE,OAAO,KAAA,EAAQ,EACzE,KAAM,EACN,YAAY,qFACZ,UAAW,6FAA6FpB,EAAO,YAAc,2BAA6B,EAAE,EAAA,CAAA,CAC/J,EACL,EACA4D,EAAAA,KAAC,MAAA,CAAI,UAAU,uBACX,SAAA,CAAAA,EAAAA,KAAC,QAAA,CAAM,UAAU,4EAA4E,SAAA,CAAA,MAExF5D,EAAO,aAAe6D,EAAAA,IAAC,OAAA,CAAK,UAAU,uCAAuC,SAAA,IAAA,CAAE,CAAA,EACpF,EACAA,EAAAA,IAAC,WAAA,CACG,MAAO1E,EAAK,YACZ,SAAUiC,GAAKhC,EAAQ6B,IAAS,CAAE,GAAGA,EAAM,YAAaG,EAAE,OAAO,KAAA,EAAQ,EACzE,KAAM,EACN,YAAY,gBACZ,UAAW,6EAA6EpB,EAAO,YAAc,2BAA6B,EAAE,EAAA,CAAA,CAC/I,CAAA,CACL,CAAA,CAAA,CACJ,CAAA,EACJ,EAGA4D,EAAAA,KAAC,UAAA,CAAQ,UAAU,gDACd,SAAA,CAAAA,OAAC,SAAA,CAAO,QAAS,IAAMnE,EAAgB,CAACD,CAAY,EAAG,UAAU,yEAC9D,SAAA,CAAAoE,EAAAA,KAAC,MAAA,CAAI,UAAU,0BACX,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,mDAAmD,SAAA,OAAI,EACtEA,EAAAA,IAAC,OAAA,CAAK,UAAU,6HAA6H,SAAA,IAAA,CAAE,CAAA,EACnJ,EACCrE,QAAgBiF,GAAA,CAAU,UAAU,kBAAkB,EAAKZ,MAACa,EAAA,CAAY,UAAU,iBAAA,CAAkB,CAAA,EACzG,EAEClF,GACGoE,EAAAA,KAAC,MAAA,CAAI,UAAU,oDAEX,SAAA,CAAAA,OAAC,MAAA,CACG,SAAA,CAAAC,EAAAA,IAAC,QAAA,CAAM,UAAWF,EAAY,SAAA,SAAM,EACpCE,EAAAA,IAAC,MAAA,CAAI,UAAU,YACV,UAAC,EAAG,EAAG,CAAC,EAAE,IAAIH,GACXE,EAAAA,KAAC,MAAA,CAAc,UAAU,0BACrB,SAAA,CAAAA,EAAAA,KAAC,OAAA,CAAK,UAAU,kDAAkD,SAAA,CAAA,IAAEF,EAAI,CAAA,EAAE,EAC1EG,EAAAA,IAAC,QAAA,CACG,MAAO1E,EAAK,cAAcuE,CAAG,EAC7B,SAAUtC,GAAK,CACX,MAAMuD,EAAQ,CAAC,GAAGxF,EAAK,aAAa,EACpCwF,EAAMjB,CAAG,EAAItC,EAAE,OAAO,MACtBhC,MAAiB,CAAC,GAAG6B,EAAM,cAAe0D,GAAO,CACrD,EACA,KAAK,OACL,YAAalB,EAAoBC,CAAG,EACpC,UAAU,mDAAA,CAAA,CACd,CAAA,EAZMA,CAaV,CACH,CAAA,CACL,CAAA,EACJ,SAGC,MAAA,CACG,SAAA,CAAAG,EAAAA,IAAC,QAAA,CAAM,UAAWF,EAAY,SAAA,KAAE,EAChCE,EAAAA,IAAC,WAAA,CACG,MAAO1E,EAAK,QACZ,SAAUiC,GAAKhC,EAAQ6B,IAAS,CAAE,GAAGA,EAAM,QAASG,EAAE,OAAO,KAAA,EAAQ,EACrE,KAAM,EACN,YAAY,mBACZ,UAAU,kDAAA,CAAA,CACb,EACL,SAGE,MAAA,CACE,SAAA,CAAAyC,EAAAA,IAAC,QAAA,CAAM,UAAWF,EAAY,SAAA,KAAE,EAChCE,EAAAA,IAAC,WAAA,CACG,MAAO1E,EAAK,YACZ,SAAUiC,GAAKhC,EAAQ6B,IAAS,CAAE,GAAGA,EAAM,YAAaG,EAAE,OAAO,KAAA,EAAQ,EACzE,KAAM,EACN,YAAY,oBACZ,UAAU,kDAAA,CAAA,CACb,EACL,EAGAwC,EAAAA,KAAC,MAAA,CAAI,UAAU,kCACV,SAAA,CAAAC,MAAC,QAAA,CAAM,UAAW,GAAGF,CAAU,QAAS,SAAA,OAAI,EAC5CE,EAAAA,IAAC,IAAA,CAAE,UAAU,gDAAgD,SAAA,yCAE9D,EACAD,EAAAA,KAAC,MAAA,CAAI,UAAU,aACX,SAAA,CAAAA,EAAAA,KAAC,SAAA,CACG,QAAS,IAAMxE,EAAQ6B,IAAS,CAAC,GAAGA,EAAM,SAAU,EAAA,EAAM,EAC1D,UAAW,6GAA6G9B,EAAK,SAAW,qCAAuC,kDAAkD,GAEjO,SAAA,CAAA0E,EAAAA,IAACpF,GAAA,CAAM,KAAM,EAAA,CAAI,EAAE,KAAA,CAAA,CAAA,EAEvBmF,EAAAA,KAAC,SAAA,CACG,QAAS,IAAMxE,EAAQ6B,IAAS,CAAC,GAAGA,EAAM,SAAU,EAAA,EAAO,EAC3D,UAAW,6GAA8G9B,EAAK,SAAkD,mDAAvC,oCAAyF,GAElO,SAAA,CAAA0E,EAAAA,IAAClF,GAAA,CAAK,KAAM,EAAA,CAAI,EAAE,MAAA,CAAA,CAAA,CACtB,CAAA,CACJ,CAAA,CAAA,CACJ,CAAA,CAAA,CACJ,CAAA,CAAA,CAER,CAAA,EACJ,EAGAkF,EAAAA,IAAC,MAAA,CAAI,UAAU,+IACX,SAAAA,EAAAA,IAAC,SAAA,CACG,QAASX,EACT,UAAU,sOAET,WAAS,QAAU,OAAA,CAAA,EAE5B,EAGCxD,GACGkE,EAAAA,KAAAgB,WAAA,CACI,SAAA,CAAAf,MAAC,OAAI,UAAU,uDAAuD,QAAS,IAAMlE,EAAgB,EAAK,EAAG,EAC7GiE,EAAAA,KAAC,MAAA,CAAI,UAAU,0KACV,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,kGACZ,SAAA,CAAAC,EAAAA,IAAC,SAAA,CAAO,QAAS,IAAMlE,EAAgB,EAAK,EAAG,UAAU,qFACrD,SAAAkE,EAAAA,IAACa,EAAA,CAAY,KAAM,EAAA,CAAI,EAC3B,EACAb,EAAAA,IAAC,KAAA,CAAG,UAAU,gDAAgD,SAAA,SAAM,EACpEA,EAAAA,IAAC,UAAO,QAAS,IAAMlE,EAAgB,EAAK,EAAG,UAAU,oFAAoF,SAAA,IAAA,CAAE,CAAA,EACnJ,EAEAiE,EAAAA,KAAC,MAAA,CAAI,UAAU,mCACX,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,OACX,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,yDAAyD,SAAA,QAAK,EAC7ED,EAAAA,KAAC,MAAA,CAAI,UAAU,0GACV,SAAA,CAAAzE,EAAK,WAAW,SAAW,SAAM,OAAA,CAAK,UAAU,qCAAqC,SAAA,MAAA,CAAI,EACzFA,EAAK,WAAW,IAAI+C,GACjB0B,EAAAA,KAAC,SAAA,CAAiB,QAAS,IAAM3B,EAAUC,CAAG,EAAG,UAAU,kHAAkH,SAAA,CAAA,IACvKA,EAAI,IAAC2B,EAAAA,IAACQ,EAAA,CAAE,KAAM,GAAI,UAAU,YAAA,CAAa,CAAA,CAAA,EADlCnC,CAEb,CACH,CAAA,CAAA,CACL,CAAA,EACJ,EAEC0B,EAAAA,KAAC,MAAA,CAAI,UAAU,OACZ,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,yDAAyD,SAAA,aAAU,EAClFD,EAAAA,KAAC,MAAA,CAAI,UAAU,aACX,SAAA,CAAAC,EAAAA,IAAC,QAAA,CACG,MAAOjE,EACP,SAAUwB,GAAKvB,EAAkBuB,EAAE,OAAO,KAAK,EAC/C,UAAWA,GAAKA,EAAE,MAAQ,SAAWgB,EAAA,EACrC,KAAK,OACL,YAAY,YACZ,UAAU,+CAAA,CAAA,QAEb,SAAA,CAAO,QAASA,EAAc,UAAU,+IAA+I,SAAA,IAAA,CAExL,CAAA,CAAA,CACJ,CAAA,EACJ,SAEE,MAAA,CACE,SAAA,CAAAyB,EAAAA,IAAC,MAAA,CAAI,UAAU,yDAAyD,SAAA,OAAI,QAC3E,MAAA,CAAI,UAAU,yBACV,SAAAjC,EAAc,IAAIM,GACf0B,EAAAA,KAAC,SAAA,CAEG,QAAS,IAAM3B,EAAUC,CAAG,EAC5B,UAAW;AAAA;AAAA,8CAEL/C,EAAK,WAAW,SAAS+C,CAAG,EACxB,oCACA,6BACN;AAAA,0CAEP,SAAA,CAAA,IACKA,CAAA,CAAA,EAVGA,CAAA,CAYZ,CAAA,CACL,CAAA,CAAA,CACJ,CAAA,CAAA,CACJ,CAAA,CAAA,CACJ,CAAA,EACJ,EAIHpC,SACI,MAAA,CAAI,UAAU,qHACX,SAAA8D,EAAAA,KAAC,MAAA,CAAI,UAAU,oGACX,SAAA,CAAAC,MAAC,KAAA,CAAG,UAAU,gEAAiE,SAAA9E,EAAS,WAAa,UAAU,EAC/G6E,EAAAA,KAAC,MAAA,CAAI,UAAU,aACX,SAAA,CAAAC,EAAAA,IAAC,SAAA,CACG,QAAS,IAAMvB,EAAkB,EAAK,EACtC,UAAU,4HAET,WAAS,KAAO,GAAA,CAAA,EAErBuB,EAAAA,IAAC,SAAA,CACG,QAAS,IAAMvB,EAAkB,EAAI,EACrC,UAAU,4IAET,WAAS,OAAS,GAAA,CAAA,CACvB,CAAA,CACJ,CAAA,CAAA,CACJ,CAAA,CACJ,EAIHpC,SACI,MAAA,CAAI,UAAU,qHACX,SAAA0D,EAAAA,KAAC,MAAA,CAAI,UAAU,+HACX,SAAA,CAAAC,EAAAA,IAAC,OAAI,UAAU,uFACX,eAACgB,GAAA,CAAY,KAAM,GAAI,CAAA,CAC3B,EACAhB,EAAAA,IAAC,KAAA,CAAG,UAAU,gEAAgE,SAAA,YAAS,EACvFA,EAAAA,IAAC,IAAA,CAAE,UAAU,sDAAsD,SAAA,cAAW,EAC9EA,EAAAA,IAAC,SAAA,CACG,QAAS,IAAM1D,EAAkB,EAAK,EACtC,UAAU,4IACb,SAAA,MAAA,CAAA,CAED,CAAA,CACJ,CAAA,CACJ,CAAA,CAAA,CAEN,CAAA,CACF,CAEJ","x_google_ignoreList":[0,1]}