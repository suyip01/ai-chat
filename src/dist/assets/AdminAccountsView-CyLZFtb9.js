import{j as e,r as n}from"./index-DiMvcmcb.js";import{T as k,u as C,a as i}from"./AdminDashboard-D62DCIkd.js";import{P as g}from"./plus-Bz3dnY0B.js";import{X as A}from"./x-CKT7hpuC.js";import"./createLucideIcon-CiU7U1is.js";const P=()=>{const{showToast:t}=C(),[p,d]=n.useState([]),[b,c]=n.useState("list"),[a,o]=n.useState({username:"",email:"",password:""}),[u,r]=n.useState(null),[x,j]=n.useState(""),w=async()=>{try{const s=await i.list();d(s)}catch{t("加载失败","error")}};n.useEffect(()=>{w()},[]);const f=async()=>{if(!a.username||!a.password){t("请填写必填项","error");return}try{const{id:s}=await i.create(a);d(l=>[...l,{id:s,username:a.username,email:a.email||"",isActive:1}]),c("list"),o({username:"",email:"",password:""}),t("管理员添加成功")}catch{t("添加失败","error")}},N=async(s,l)=>{try{await i.update(s,{isActive:l}),d(m=>m.map(h=>h.id===s?{...h,isActive:l}:h)),t(l?"已启用":"已禁用")}catch{t("更新失败","error")}},y=async s=>{try{await i.remove(s),d(l=>l.filter(m=>m.id!==s)),t("删除成功")}catch{t("删除失败","error")}},v=async()=>{if(!x){t("请输入新密码","error");return}try{await i.changePassword(u.id,x),r(null),j(""),t("密码已更新")}catch{t("更新失败","error")}};return b==="create"?e.jsxs("div",{className:"animate-fade-in pb-10",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("button",{onClick:()=>c("list"),className:"px-5 py-2.5 rounded-xl bg-white text-gray-600 font-bold text-sm shadow-sm hover:bg-gray-50",children:"返回"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-cute text-pink-900",children:"添加管理员"}),e.jsx("p",{className:"text-gray-400 text-xs",children:"创建新的后台管理员账号"})]}),e.jsxs("div",{className:"ml-auto flex gap-3",children:[e.jsx("button",{onClick:()=>c("list"),className:"px-6 py-2.5 rounded-xl bg-white text-gray-500 font-bold text-sm shadow-sm hover:bg-gray-50",children:"取消"}),e.jsxs("button",{onClick:f,className:"px-6 py-2.5 rounded-xl bg-gradient-to-r from-pink-500 to-pink-600 text-white font-bold text-sm shadow-lg shadow-pink-200 flex items-center gap-2",children:[e.jsx(g,{size:16})," 创建管理员"]})]})]}),e.jsxs("div",{className:"solid-card p-8 rounded-3xl space-y-6 max-w-2xl mx-auto",children:[e.jsxs("h3",{className:"font-cute text-lg text-pink-900 flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"w-1.5 h-4 bg-yellow-400 rounded-full"})," 管理员信息"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-pink-800 mb-2",children:"用户名"}),e.jsx("input",{type:"text",value:a.username,onChange:s=>o({...a,username:s.target.value}),className:"dream-input w-full px-4 py-2.5 rounded-xl text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-pink-800 mb-2",children:"邮箱"}),e.jsx("input",{type:"email",value:a.email,onChange:s=>o({...a,email:s.target.value}),className:"dream-input w-full px-4 py-2.5 rounded-xl text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-pink-800 mb-2",children:"初始密码"}),e.jsx("input",{type:"password",value:a.password,onChange:s=>o({...a,password:s.target.value}),className:"dream-input w-full px-4 py-2.5 rounded-xl text-sm"})]})]})]}):e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-cute text-pink-900 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-yellow-400 rounded-full inline-block"}),"管理员账号"]}),e.jsx("p",{className:"text-gray-400 text-xs mt-1 ml-4",children:"管理后台管理员列表、禁用与密码修改"})]}),e.jsxs("button",{onClick:()=>c("create"),className:"bg-pink-500 text-white px-4 py-2 rounded-xl font-bold shadow-lg shadow-pink-200 hover:bg-pink-600 transition-colors flex items-center gap-2 text-xs",children:[e.jsx(g,{size:14})," 添加管理员"]})]}),e.jsx("div",{className:"glass-card rounded-2xl overflow-hidden border border-pink-100",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{className:"bg-pink-100 text-pink-900 font-cute text-sm",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 pl-6 w-20",children:"头像"}),e.jsx("th",{className:"p-3 w-20",children:"ID"}),e.jsx("th",{className:"p-3",children:"用户名"}),e.jsx("th",{className:"p-3",children:"昵称"}),e.jsx("th",{className:"p-3",children:"邮箱"}),e.jsx("th",{className:"p-3",children:"状态"}),e.jsx("th",{className:"p-3 text-right pr-6",children:"操作"})]})}),e.jsxs("tbody",{className:"text-sm divide-y divide-pink-100",children:[p.map(s=>e.jsxs("tr",{className:"hover:bg-pink-50/30 transition-colors",children:[e.jsx("td",{className:"p-3 pl-6",children:e.jsx("img",{src:s.avatar||"/uploads/avatars/default_admin.jpg",alt:s.username,className:"w-8 h-8 rounded-full object-cover shadow-sm"})}),e.jsx("td",{className:"p-3 text-gray-500 font-mono",children:s.id.toString().padStart(4,"0")}),e.jsx("td",{className:"p-3 font-bold text-pink-700",children:s.username}),e.jsx("td",{className:"p-3 text-gray-700",children:s.nickname||"-"}),e.jsx("td",{className:"p-3 text-gray-600",children:s.email||"-"}),e.jsx("td",{className:"p-3",children:s.isActive===1?"启用":"禁用"}),e.jsx("td",{className:"p-3 text-right pr-6",children:e.jsxs("div",{className:"flex items-center gap-2 justify-end",children:[e.jsx("button",{onClick:()=>r(s),className:"px-3 py-1 rounded bg-white border border-gray-200 text-gray-600 text-xs hover:bg-gray-50",children:"改密"}),e.jsx("button",{onClick:()=>N(s.id,s.isActive===1?0:1),className:`px-3 py-1 rounded text-xs font-bold ${s.isActive===1?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:s.isActive===1?"禁用":"启用"}),e.jsx("button",{onClick:()=>y(s.id),className:"px-3 py-1 rounded bg-red-500 text-white text-xs hover:bg-red-600",children:"删除"})]})})]},s.id)),p.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"p-8 text-center text-gray-400 text-sm",children:"暂无管理员"})})]})]})}),u&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/30 z-50",onClick:()=>r(null)}),e.jsx("div",{className:"fixed top-0 right-0 bottom-0 left-0 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-3xl border border-pink-100 p-6 w-full max-w-md shadow-2xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"font-cute text-lg text-pink-900",children:"修改密码"}),e.jsx("button",{onClick:()=>r(null),className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(A,{size:20})})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-pink-800 mb-1.5",children:"新密码"}),e.jsx("input",{type:"password",value:x,onChange:s=>j(s.target.value),className:"dream-input w-full px-4 py-2.5 rounded-xl text-sm"})]})}),e.jsxs("div",{className:"flex justify-end gap-3 mt-8",children:[e.jsx("button",{onClick:()=>r(null),className:"px-5 py-2.5 rounded-xl bg-gray-50 text-gray-600 font-bold text-sm hover:bg-gray-100 transition-colors",children:"取消"}),e.jsx("button",{onClick:v,className:"px-6 py-2.5 rounded-xl bg-pink-500 text-white font-bold text-sm shadow-lg shadow-pink-200 hover:bg-pink-600 transition-all",children:"确认修改"})]})]})})]})]})},I=()=>e.jsx(k,{children:e.jsx(P,{})});export{I as default};
//# sourceMappingURL=AdminAccountsView-CyLZFtb9.js.map
